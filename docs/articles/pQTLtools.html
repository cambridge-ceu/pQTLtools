<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pQTLtools">
<title>An Overview of pQTLtools â€¢ pQTLtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Overview of pQTLtools">
<meta property="og:description" content="pQTLtools">
<meta property="og:image" content="https://jinghuazhao.github.io/pQTLtools/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pQTLtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Vignettes:</h6>
    <a class="dropdown-item" href="../articles/pQTLtools.html">An overview of pQTLtools</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Articles:</h6>
    <a class="dropdown-item" href="../articles/bioconductor.html">Bioconductor notes</a>
    <a class="dropdown-item" href="../articles/es.html">ExpressionSet usage</a>
    <a class="dropdown-item" href="../articles/snakemake.html">A snakemake showcase</a>
    <a class="dropdown-item" href="../articles/SCALLOP-INF.html">SCALLOP-INF scripts</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://alphafold.ebi.ac.uk/">
    <span class="fas fa fas fa-fast-backward"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-sites">Sites</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-sites">
    <a class="external-link dropdown-item" href="https://alphafold.ebi.ac.uk/">AlphaFold</a>
    <a class="external-link dropdown-item" href="https://github.com/Bioconductor">Bioconductor</a>
    <a class="external-link dropdown-item" href="https://biorender.com/">BioRender</a>
    <a class="external-link dropdown-item" href="https://cran.r-project.org/">CRAN</a>
    <a class="external-link dropdown-item" href="https://cytoscape.org/">Cytoscape</a>
    <a class="external-link dropdown-item" href="https://www.ensembl.org/">Ensembl</a>
    <a class="external-link dropdown-item" href="https://www.ebi.ac.uk/eqtl/">eQTL catalog</a>
    <a class="external-link dropdown-item" href="https://www.ebi.ac.uk/gwas/">GWAS catalog</a>
    <a class="external-link dropdown-item" href="https://metascape.org/">metascape</a>
    <a class="external-link dropdown-item" href="https://www.mrbase.org/">MRBase</a>
    <a class="external-link dropdown-item" href="https://pubmed.ncbi.nlm.nih.gov/">PubMed</a>
    <a class="external-link dropdown-item" href="https://string-db.org/">STRING</a>
    <a class="external-link dropdown-item" href="https://www.proteinatlas.org/">The Human Protein Atlas</a>
    <a class="external-link dropdown-item" href="https://www.uniprot.org/">UniProt</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.uniprot.org/">
    <span class="fas fa fas fa-fast-forward"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://jinghuazhao.github.io/R/">
    <span class="fab fa fab fa-r-project"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jinghuazhao/pQTLtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>An Overview of pQTLtools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jinghuazhao/pQTLtools/blob/HEAD/vignettes/pQTLtools.Rmd" class="external-link"><code>vignettes/pQTLtools.Rmd</code></a></small>
      <div class="d-none name"><code>pQTLtools.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GenomicRanges"</span>, <span class="st">"TwoSampleMR"</span>, <span class="st">"biomaRt"</span>, <span class="st">"coloc"</span>, <span class="st">"dplyr"</span>, <span class="st">"gap"</span>, <span class="st">"ggplot2"</span>, <span class="st">"httr"</span>,</span>
<span>          <span class="st">"karyoploteR"</span>, <span class="st">"knitr"</span>, <span class="st">"plotly"</span>, <span class="st">"pQTLtools"</span>, <span class="st">"rGREAT"</span>, <span class="st">"readr"</span>, <span class="st">"regioneR"</span>, <span class="st">"seqminer"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="va">pkgs</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"^package:"</span>, <span class="va">p</span>, <span class="st">"$"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/search.html" class="external-link">search</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"This vignette needs package `"</span>, <span class="va">p</span>, <span class="st">"'; please install"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">require</span>, character.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2" number="1">
<h2 id="cistrans-classification">
<span class="header-section-number">1</span> cis/trans classification<a class="anchor" aria-label="anchor" href="#cistrans-classification"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"INF1.merge"</span><span class="op">)</span></span>
<span><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">f</span>,as.is<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">hits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">merged</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CHR"</span>,<span class="st">"POS"</span>,<span class="st">"MarkerName"</span>,<span class="st">"prot"</span>,<span class="st">"log10p"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>              <span class="va">inf1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"uniprot"</span><span class="op">)</span><span class="op">]</span>,by<span class="op">=</span><span class="st">"prot"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">mutate</span><span class="op">(</span>log10p<span class="op">=</span><span class="op">-</span><span class="va">log10p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hits</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"Chr"</span>,<span class="st">"bp"</span>,<span class="st">"SNP"</span>,<span class="st">"log10p"</span>,<span class="st">"uniprot"</span><span class="op">)</span></span>
<span><span class="va">cistrans</span> <span class="op">&lt;-</span> <span class="fu">cis.vs.trans.classification</span><span class="op">(</span><span class="va">hits</span>,<span class="va">inf1</span>,<span class="st">"uniprot"</span><span class="op">)</span></span>
<span><span class="va">cis.vs.trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cistrans</span>,<span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cistrans</span>,<span class="va">table</span><span class="op">)</span>,caption<span class="op">=</span><span class="st">"cis/trans classification"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:cistrans">Table 1.1: </span>cis/trans classification</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">cis</th>
<th align="right">trans</th>
<th align="right">total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ADA</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">CASP8</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">CCL11</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">CCL13</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">CCL19</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">CCL2</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">CCL20</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">CCL23</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">CCL25</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">CCL3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">CCL4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">CCL7</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">CCL8</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">CD244</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">CD274</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">CD40</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">CD5</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">CD6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">CDCP1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">CSF1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">CST5</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">CX3CL1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">CXCL1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">CXCL10</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">CXCL11</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">CXCL5</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">CXCL6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">CXCL9</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">DNER</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">EIF4EBP1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">FGF19</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">FGF21</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">FGF23</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">FGF5</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">FLT3LG</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">GDNF</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">HGF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">IL10</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">IL10RB</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">IL12B</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">IL15RA</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">IL17C</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">IL18</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">IL18R1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">IL1A</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">IL6</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">IL7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">IL8</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">KITLG</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">LIFR</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">LTA</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">MMP1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">MMP10</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">NGF</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">NTF3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">OSM</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">PLAU</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">S100A12</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">SIRT2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">SLAMF1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">SULT1A1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">TGFA</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">TGFB1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">TNFRSF11B</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">TNFRSF9</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">TNFSF10</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">TNFSF11</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">TNFSF12</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">TNFSF14</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">VEGFA</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">total</td>
<td align="right">59</td>
<td align="right">121</td>
<td align="right">180</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cistrans</span>,<span class="va">total</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 180</span></span>
<span><span class="fu">circos.cis.vs.trans.plot</span><span class="op">(</span>hits<span class="op">=</span><span class="va">f</span>,<span class="va">inf1</span>,<span class="st">"uniprot"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:cistrans"></span>
<img src="pQTLtools/cistrans-1.png" alt="cis/trans classification" width="672" style="display:block; margin: auto"><p class="caption">
Figure 1.1: cis/trans classification
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"INF1.merge"</span><span class="op">)</span></span>
<span><span class="va">INF1_merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chrom"</span>,<span class="st">"Start"</span>,<span class="st">"End"</span>,<span class="st">"prot"</span>,<span class="st">"MarkerName"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">INF1_merge_cvt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">INF1_merge</span>,<span class="va">cis.vs.trans</span>,by.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"MarkerName"</span><span class="op">)</span>,by.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"SNP"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">INF1_merge_cvt</span>,<span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">Chr</span>,<span class="va">bp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">INF1_merge_cvt</span> <span class="op">&lt;-</span> <span class="va">INF1_merge_cvt</span><span class="op">[</span><span class="va">ord</span>,<span class="op">]</span></span></code></pre></div>
<p>The <code>INF1_merge_cvt</code> object is obtained for later use. A more recent implementation is the <code>qtlClassifier</code> function. For this example we have,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">geneSNP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">merged</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"MarkerName"</span><span class="op">)</span><span class="op">]</span>,<span class="va">inf1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"gene"</span><span class="op">)</span><span class="op">]</span>,by<span class="op">=</span><span class="st">"prot"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>,<span class="st">"MarkerName"</span>,<span class="st">"prot"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SNPPos</span> <span class="op">&lt;-</span> <span class="va">merged</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MarkerName"</span>,<span class="st">"CHR"</span>,<span class="st">"POS"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">genePos</span> <span class="op">&lt;-</span> <span class="va">inf1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>,<span class="st">"chr"</span>,<span class="st">"start"</span>,<span class="st">"end"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">cvt</span> <span class="op">&lt;-</span> <span class="fu">qtlClassifier</span><span class="op">(</span><span class="va">geneSNP</span>,<span class="va">SNPPos</span>,<span class="va">genePos</span>,<span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cvt</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="9%">
<col width="20%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="9%">
<col width="10%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">gene</th>
<th align="left">MarkerName</th>
<th align="left">prot</th>
<th align="right">geneChrom</th>
<th align="right">geneStart</th>
<th align="right">geneEnd</th>
<th align="right">SNPChrom</th>
<th align="right">SNPPos</th>
<th align="left">Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">EIF4EBP1</td>
<td align="left">chr4:187158034_A_G</td>
<td align="left">4E.BP1</td>
<td align="right">8</td>
<td align="right">37887859</td>
<td align="right">37917883</td>
<td align="right">4</td>
<td align="right">187158034</td>
<td align="left">trans</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">ADA</td>
<td align="left">chr20:43255220_C_T</td>
<td align="left">ADA</td>
<td align="right">20</td>
<td align="right">43248163</td>
<td align="right">43280874</td>
<td align="right">20</td>
<td align="right">43255220</td>
<td align="left">cis</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">NGF</td>
<td align="left">chr1:115829943_A_C</td>
<td align="left">Beta.NGF</td>
<td align="right">1</td>
<td align="right">115828539</td>
<td align="right">115880857</td>
<td align="right">1</td>
<td align="right">115829943</td>
<td align="left">cis</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">NGF</td>
<td align="left">chr9:90362040_C_T</td>
<td align="left">Beta.NGF</td>
<td align="right">1</td>
<td align="right">115828539</td>
<td align="right">115880857</td>
<td align="right">9</td>
<td align="right">90362040</td>
<td align="left">trans</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">CASP8</td>
<td align="left">chr2:202164805_C_G</td>
<td align="left">CASP.8</td>
<td align="right">2</td>
<td align="right">202098166</td>
<td align="right">202152434</td>
<td align="right">2</td>
<td align="right">202164805</td>
<td align="left">cis</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">CCL11</td>
<td align="left">chr1:159175354_A_G</td>
<td align="left">CCL11</td>
<td align="right">17</td>
<td align="right">32612687</td>
<td align="right">32615353</td>
<td align="right">1</td>
<td align="right">159175354</td>
<td align="left">trans</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cistrans.check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">cvt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>,<span class="st">"MarkerName"</span>,<span class="st">"Type"</span><span class="op">)</span><span class="op">]</span>,<span class="va">cis.vs.trans</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.gene"</span>,<span class="st">"SNP"</span>,<span class="st">"cis.trans"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                        by.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>,<span class="st">"MarkerName"</span><span class="op">)</span>,by.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.gene"</span>,<span class="st">"SNP"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cistrans.check</span>,<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Type</span>,<span class="va">cis.trans</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        cis.trans</span></span>
<span><span class="co">#&gt; Type    cis trans</span></span>
<span><span class="co">#&gt;   cis    59     0</span></span>
<span><span class="co">#&gt;   trans   0   121</span></span></code></pre></div>
<p>This is used to generate 2d-pQTL plot</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t2d</span> <span class="op">&lt;-</span> <span class="fu">qtl2dplot</span><span class="op">(</span><span class="va">cis.vs.trans</span>,xlab<span class="op">=</span><span class="st">"pQTL position"</span>,ylab<span class="op">=</span><span class="st">"Gene position"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:qtl2dplot"></span>
<img src="pQTLtools/qtl2dplot-1.png" alt="2d pQTL plot" width="672" style="display:block; margin: auto"><p class="caption">
Figure 1.2: 2d pQTL plot
</p>
</div>
<p>whose result can be also viewed in a 2-d plotly style,</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qtl2dplotly</span><span class="op">(</span><span class="va">cis.vs.trans</span>,xlab<span class="op">=</span><span class="st">"pQTL position"</span>,ylab<span class="op">=</span><span class="st">"Gene position"</span><span class="op">)</span></span>
<span><span class="co"># fig2d &lt;- qtl2dplotly(...)</span></span>
<span><span class="co"># htmlwidgets::saveWidget(fig2d,file="fig2d.html")</span></span></code></pre></div>
<p>and 3-d counterpart</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qtl3dplotly</span><span class="op">(</span><span class="va">cis.vs.trans</span>,zmax<span class="op">=</span><span class="fl">300</span>,qtl.prefix<span class="op">=</span><span class="st">"pQTL:"</span>,xlab<span class="op">=</span><span class="st">"pQTL position"</span>,ylab<span class="op">=</span><span class="st">"Gene position"</span><span class="op">)</span></span>
<span><span class="co"># fig3d &lt;- qtl3dplotly(...)</span></span>
<span><span class="co"># htmlwidgets::saveWidget(fig3d,file="fig3d.html")</span></span></code></pre></div>
<p>and ideogram (biomaRt is not always on so we keep a copy of hgnc)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set_config</span><span class="op">(</span><span class="fu">config</span><span class="op">(</span>ssl_verifypeer <span class="op">=</span> <span class="fl">0L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mart</span> <span class="op">&lt;-</span> <span class="fu">useMart</span><span class="op">(</span>biomart <span class="op">=</span> <span class="st">"ensembl"</span>, dataset <span class="op">=</span> <span class="st">"hsapiens_gene_ensembl"</span><span class="op">)</span></span>
<span><span class="va">attrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hgnc_symbol"</span>, <span class="st">"chromosome_name"</span>, <span class="st">"start_position"</span>, <span class="st">"end_position"</span>, <span class="st">"band"</span><span class="op">)</span></span>
<span><span class="va">hgnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"character"</span>,<span class="fl">180</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">180</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">INF1_merge_cvt</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Chr</span>,<span class="st">":"</span>,<span class="va">bp</span>,<span class="st">":"</span>,<span class="va">bp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">getBM</span><span class="op">(</span>attributes <span class="op">=</span> <span class="va">attrs</span>, filters<span class="op">=</span><span class="st">"chromosomal_region"</span>, values<span class="op">=</span><span class="va">v</span>, mart<span class="op">=</span><span class="va">mart</span><span class="op">)</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">hgnc_symbol</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">hgnc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">g</span><span class="op">[[</span><span class="st">"hgnc_symbol"</span><span class="op">]</span><span class="op">]</span>,collapse<span class="op">=</span><span class="st">";"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">g</span><span class="op">[[</span><span class="st">"hgnc_symbol"</span><span class="op">]</span><span class="op">]</span>,<span class="va">hgnc</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">hgnc</span>,file<span class="op">=</span><span class="st">"~/pQTLtools/tests/hgnc.rda"</span>,compress<span class="op">=</span><span class="st">"xz"</span><span class="op">)</span></span></code></pre></div>
<p>We now proceed with</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"~/pQTLtools/tests/hgnc.rda"</span><span class="op">)</span></span>
<span><span class="va">INF1_merge_cvt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">INF1_merge_cvt</span>,<span class="op">{</span></span>
<span>  <span class="va">hgnc</span> <span class="op">&lt;-</span> <span class="va">hgnc</span></span>
<span>  <span class="va">hgnc</span><span class="op">[</span><span class="va">cis</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p.gene</span><span class="op">[</span><span class="va">cis</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">INF1_merge_cvt</span>, <span class="op">{</span></span>
<span>  <span class="va">sentinels</span> <span class="op">&lt;-</span> <span class="fu">toGRanges</span><span class="op">(</span><span class="va">Chr</span>,<span class="va">bp</span><span class="op">-</span><span class="fl">1</span>,<span class="va">bp</span>,labels<span class="op">=</span><span class="va">hgnc</span><span class="op">)</span></span>
<span>  <span class="va">cis.regions</span> <span class="op">&lt;-</span> <span class="fu">toGRanges</span><span class="op">(</span><span class="va">Chr</span>,<span class="va">cis.start</span>,<span class="va">cis.end</span><span class="op">)</span></span>
<span>  <span class="va">loci</span> <span class="op">&lt;-</span> <span class="fu">toGRanges</span><span class="op">(</span><span class="va">Chr</span>,<span class="va">Start</span>,<span class="va">End</span><span class="op">)</span></span>
<span>  <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span></span>
<span>  <span class="fu">seqlevelsStyle</span><span class="op">(</span><span class="va">sentinels</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"UCSC"</span></span>
<span>  <span class="va">kp</span> <span class="op">&lt;-</span> <span class="fu">plotKaryotype</span><span class="op">(</span>genome<span class="op">=</span><span class="st">"hg19"</span>,chromosomes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">sentinels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">kpAddBaseNumbers</span><span class="op">(</span><span class="va">kp</span><span class="op">)</span></span>
<span>  <span class="fu">kpPlotRegions</span><span class="op">(</span><span class="va">kp</span>, data<span class="op">=</span><span class="va">loci</span>,r0<span class="op">=</span><span class="fl">0.05</span>,r1<span class="op">=</span><span class="fl">0.15</span>,border<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="fu">kpPlotMarkers</span><span class="op">(</span><span class="va">kp</span>, data<span class="op">=</span><span class="va">sentinels</span>, labels<span class="op">=</span><span class="va">hgnc</span>, text.orientation<span class="op">=</span><span class="st">"vertical"</span>,</span>
<span>                cex<span class="op">=</span><span class="fl">0.5</span>, y<span class="op">=</span><span class="fl">0.3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">hgnc</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hgnc</span><span class="op">)</span>, srt<span class="op">=</span><span class="fl">30</span>,</span>
<span>                ignore.chromosome.ends<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                adjust.label.position<span class="op">=</span><span class="cn">TRUE</span>, label.color<span class="op">=</span><span class="va">colors</span><span class="op">[</span><span class="fl">2</span><span class="op">-</span><span class="va">cis</span><span class="op">]</span>, label.dist<span class="op">=</span><span class="fl">0.002</span>,</span>
<span>                cex.axis<span class="op">=</span><span class="fl">3</span>, cex.lab<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, bty<span class="op">=</span><span class="st">"n"</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>,<span class="fl">19</span><span class="op">)</span>, col<span class="op">=</span><span class="va">colors</span>, pt.cex<span class="op">=</span><span class="fl">0.4</span>,</span>
<span>         legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cis"</span>, <span class="st">"trans"</span><span class="op">)</span>, text.col<span class="op">=</span><span class="va">colors</span>, cex<span class="op">=</span><span class="fl">0.8</span>, horiz<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># panel &lt;- toGRanges(p.chr,p.start,p.end,labels=p.gene)</span></span>
<span><span class="co"># kpPlotLinks(kp, data=loci, data2=panel, col=colors[2-cis])</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:karyoplot"></span>
<img src="pQTLtools/karyoplot-1.png" alt="Karyoplot of cis/trans pQTLs" width="672" style="display:block; margin: auto"><p class="caption">
Figure 1.3: Karyoplot of cis/trans pQTLs
</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="genomic-regions-enrichment-analysis">
<span class="header-section-number">2</span> Genomic regions enrichment analysis<a class="anchor" aria-label="anchor" href="#genomic-regions-enrichment-analysis"></a>
</h2>
<p>It is now considerably easier with Genomic Regions Enrichment of Annotations Tool (GREAT).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">job</span> <span class="op">&lt;-</span> <span class="fu">submitGreatJob</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span>, species<span class="op">=</span><span class="st">"hg19"</span>, version<span class="op">=</span><span class="st">"3.0.0"</span><span class="op">)</span></span>
<span>  <span class="va">et</span> <span class="op">&lt;-</span> <span class="fu">getEnrichmentTables</span><span class="op">(</span><span class="va">job</span>,download_by <span class="op">=</span> <span class="st">'tsv'</span><span class="op">)</span></span>
<span>  <span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">'rbind'</span>,<span class="va">et</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">tb</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">regions</span>,<span class="st">".tsv"</span><span class="op">)</span>,quote<span class="op">=</span><span class="cn">FALSE</span>,row.names<span class="op">=</span><span class="cn">FALSE</span>,sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>job<span class="op">=</span><span class="va">job</span>,tb<span class="op">=</span><span class="va">tb</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">1e+6</span></span>
<span><span class="va">INF1_merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"INF1.merge"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>chr<span class="op">=</span><span class="va">Chrom</span>, start<span class="op">=</span><span class="va">POS</span><span class="op">-</span><span class="va">M</span>, end<span class="op">=</span><span class="va">POS</span><span class="op">+</span><span class="va">M</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu">if_else</span><span class="op">(</span><span class="va">start</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="va">start</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>              <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">prot</span>,<span class="va">MarkerName</span>,<span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span></span>
<span><span class="va">cistrans</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">INF1_merge</span>, <span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># All regions</span></span>
<span><span class="va">cistrans.post</span> <span class="op">&lt;-</span> <span class="fu">post</span><span class="op">(</span><span class="st">"cistrans"</span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">cistrans.post</span>,<span class="va">job</span><span class="op">)</span></span>
<span><span class="fu">plotRegionGeneAssociationGraphs</span><span class="op">(</span><span class="va">job</span>,type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GREAT-1"></span>
<img src="pQTLtools/GREAT-1.png" alt="GREAT plots" width="768" style="display:block; margin: auto"><p class="caption">
Figure 2.1: GREAT plots
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">availableOntologies</span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span>
<span><span class="co"># plot of the top term</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plotRegionGeneAssociationGraphs</span><span class="op">(</span><span class="va">job</span>, ontology<span class="op">=</span><span class="st">"GO Molecular Function"</span>,</span>
<span>                                termID<span class="op">=</span><span class="st">"GO:0005126"</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GREAT-2"></span>
<img src="pQTLtools/GREAT-2.png" alt="GREAT plots" width="768" style="display:block; margin: auto"><p class="caption">
Figure 2.2: GREAT plots
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotRegionGeneAssociationGraphs</span><span class="op">(</span><span class="va">job</span>, ontology<span class="op">=</span><span class="st">"GO Biological Process"</span>,</span>
<span>                                termID<span class="op">=</span><span class="st">"GO:0009611"</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GREAT-3"></span>
<img src="pQTLtools/GREAT-3.png" alt="GREAT plots" width="768" style="display:block; margin: auto"><p class="caption">
Figure 2.3: GREAT plots
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotRegionGeneAssociationGraphs</span><span class="op">(</span><span class="va">job</span>, ontology<span class="op">=</span><span class="st">"GO Cellular Component"</span>,</span>
<span>                                termID<span class="op">=</span><span class="st">"GO:0005615"</span>, type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GREAT-4"></span>
<img src="pQTLtools/GREAT-4.png" alt="GREAT plots" width="768" style="display:block; margin: auto"><p class="caption">
Figure 2.4: GREAT plots
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specific regions</span></span>
<span><span class="va">IL12B</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">INF1_merge</span>,<span class="va">prot</span><span class="op">==</span><span class="st">"IL.12B"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span></span>
<span><span class="va">KITLG</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">INF1_merge</span>,<span class="va">prot</span><span class="op">==</span><span class="st">"SCF"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span></span>
<span><span class="va">TNFSF10</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">INF1_merge</span>,<span class="va">prot</span><span class="op">==</span><span class="st">"TRAIL"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">chr</span>,<span class="va">start</span>,<span class="va">end</span><span class="op">)</span></span>
<span><span class="va">tb_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL12B"</span>,<span class="st">"KITLG"</span>,<span class="st">"TNFSF10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">r.post</span> <span class="op">&lt;-</span> <span class="fu">post</span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">tb_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tb_all</span>,<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>gene<span class="op">=</span><span class="va">r</span>,<span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">r.post</span>,<span class="va">tb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Don't make too frequent requests. The time break is 60s.</span></span>
<span><span class="co">#&gt; Please wait for 53s for the next request.</span></span>
<span><span class="co">#&gt; The time break can be set by `request_interval` argument.</span></span>
<span><span class="co">#&gt; Don't make too frequent requests. The time break is 60s.</span></span>
<span><span class="co">#&gt; Please wait for 57s for the next request.</span></span>
<span><span class="co">#&gt; The time break can be set by `request_interval` argument.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Don't make too frequent requests. The time break is 60s.</span></span>
<span><span class="co">#&gt; Please wait for 57s for the next request.</span></span>
<span><span class="co">#&gt; The time break can be set by `request_interval` argument.</span></span></code></pre></div>
<p>The top terms at Binomial p=1e-5 could be extracted as follows,</p>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-2">Table 2.1: </span>GREAT IL12B-KITLG-TNFSF10 results</caption>
<colgroup>
<col width="5%">
<col width="1%">
<col width="4%">
<col width="2%">
<col width="7%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="3%">
<col width="2%">
<col width="2%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="2%">
<col width="1%">
<col width="1%">
<col width="2%">
<col width="2%">
<col width="1%">
<col width="28%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">gene</th>
<th align="left">Ontology</th>
<th align="left">ID</th>
<th align="left">Desc</th>
<th align="right">BinomRank</th>
<th align="right">BinomP</th>
<th align="right">BinomBonfP</th>
<th align="right">BinomFdrQ</th>
<th align="right">RegionFoldEnrich</th>
<th align="right">ExpRegions</th>
<th align="right">ObsRegions</th>
<th align="right">GenomeFrac</th>
<th align="right">SetCov</th>
<th align="right">HyperRank</th>
<th align="right">HyperP</th>
<th align="right">HyperBonfP</th>
<th align="right">HyperFdrQ</th>
<th align="right">GeneFoldEnrich</th>
<th align="right">ExpGenes</th>
<th align="right">ObsGenes</th>
<th align="right">TotalGenes</th>
<th align="right">GeneSetCov</th>
<th align="right">TermCov</th>
<th align="left">Regions</th>
<th align="left">Genes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GO Biological Process.1100</td>
<td align="left">KITLG</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0010874</td>
<td align="left">regulation of cholesterol efflux</td>
<td align="right">1</td>
<td align="right">1.0e-07</td>
<td align="right">0.0014154</td>
<td align="right">0.0014154</td>
<td align="right">272.459900</td>
<td align="right">0.0110108</td>
<td align="right">3</td>
<td align="right">0.0015730</td>
<td align="right">0.4285714</td>
<td align="right">1</td>
<td align="right">2.00e-07</td>
<td align="right">0.0015878</td>
<td align="right">0.0015878</td>
<td align="right">265.30880</td>
<td align="right">0.0113076</td>
<td align="right">3</td>
<td align="right">17</td>
<td align="right">0.2500000</td>
<td align="right">0.1764706</td>
<td align="left">chr16:55993161-57993161,chr7:93953895-95953895,chr9:106661742-108661742</td>
<td align="left">ABCA1,CETP,PON1</td>
</tr>
<tr class="even">
<td align="left">GO Biological Process.2100</td>
<td align="left">KITLG</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0032374</td>
<td align="left">regulation of cholesterol transport</td>
<td align="right">2</td>
<td align="right">4.0e-07</td>
<td align="right">0.0044976</td>
<td align="right">0.0022488</td>
<td align="right">185.188600</td>
<td align="right">0.0161997</td>
<td align="right">3</td>
<td align="right">0.0023142</td>
<td align="right">0.4285714</td>
<td align="right">2</td>
<td align="right">1.10e-06</td>
<td align="right">0.0115168</td>
<td align="right">0.0057584</td>
<td align="right">140.94530</td>
<td align="right">0.0212849</td>
<td align="right">3</td>
<td align="right">32</td>
<td align="right">0.2500000</td>
<td align="right">0.0937500</td>
<td align="left">chr16:55993161-57993161,chr7:93953895-95953895,chr9:106661742-108661742</td>
<td align="left">ABCA1,CETP,PON1</td>
</tr>
<tr class="odd">
<td align="left">GO Biological Process.3100</td>
<td align="left">KITLG</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0032368</td>
<td align="left">regulation of lipid transport</td>
<td align="right">3</td>
<td align="right">9.0e-06</td>
<td align="right">0.0936233</td>
<td align="right">0.0312078</td>
<td align="right">67.045540</td>
<td align="right">0.0447457</td>
<td align="right">3</td>
<td align="right">0.0063922</td>
<td align="right">0.4285714</td>
<td align="right">3</td>
<td align="right">1.10e-05</td>
<td align="right">0.1148072</td>
<td align="right">0.0382691</td>
<td align="right">66.32721</td>
<td align="right">0.0452303</td>
<td align="right">3</td>
<td align="right">68</td>
<td align="right">0.2500000</td>
<td align="right">0.0441176</td>
<td align="left">chr16:55993161-57993161,chr7:93953895-95953895,chr9:106661742-108661742</td>
<td align="left">ABCA1,CETP,PON1</td>
</tr>
<tr class="even">
<td align="left">GO Biological Process.1102</td>
<td align="left">TNFSF10</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0030195</td>
<td align="left">negative regulation of blood coagulation</td>
<td align="right">1</td>
<td align="right">6.0e-07</td>
<td align="right">0.0061689</td>
<td align="right">0.0061689</td>
<td align="right">170.502500</td>
<td align="right">0.0175951</td>
<td align="right">3</td>
<td align="right">0.0021994</td>
<td align="right">0.3750000</td>
<td align="right">1</td>
<td align="right">3.30e-06</td>
<td align="right">0.0340956</td>
<td align="right">0.0340956</td>
<td align="right">100.22780</td>
<td align="right">0.0299318</td>
<td align="right">3</td>
<td align="right">36</td>
<td align="right">0.2000000</td>
<td align="right">0.0833333</td>
<td align="left">chr17:63224775-65224775,chr19:43153100-45153100,chr3:185449122-187449122</td>
<td align="left">APOH,KNG1,PLAUR</td>
</tr>
<tr class="odd">
<td align="left">GO Biological Process.2102</td>
<td align="left">TNFSF10</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0050819</td>
<td align="left">negative regulation of coagulation</td>
<td align="right">2</td>
<td align="right">1.3e-06</td>
<td align="right">0.0140303</td>
<td align="right">0.0070151</td>
<td align="right">129.538500</td>
<td align="right">0.0231591</td>
<td align="right">3</td>
<td align="right">0.0028949</td>
<td align="right">0.3750000</td>
<td align="right">2</td>
<td align="right">4.50e-06</td>
<td align="right">0.0470857</td>
<td align="right">0.0235429</td>
<td align="right">90.20500</td>
<td align="right">0.0332576</td>
<td align="right">3</td>
<td align="right">40</td>
<td align="right">0.2000000</td>
<td align="right">0.0750000</td>
<td align="left">chr17:63224775-65224775,chr19:43153100-45153100,chr3:185449122-187449122</td>
<td align="left">APOH,KNG1,PLAUR</td>
</tr>
<tr class="even">
<td align="left">GO Biological Process.3102</td>
<td align="left">TNFSF10</td>
<td align="left">GO Biological Process</td>
<td align="left">GO: 0072376</td>
<td align="left">protein activation cascade</td>
<td align="right">3</td>
<td align="right">4.4e-06</td>
<td align="right">0.0457415</td>
<td align="right">0.0152472</td>
<td align="right">87.207410</td>
<td align="right">0.0344008</td>
<td align="right">3</td>
<td align="right">0.0043001</td>
<td align="right">0.3750000</td>
<td align="right">3</td>
<td align="right">1.88e-05</td>
<td align="right">0.1961954</td>
<td align="right">0.0653985</td>
<td align="right">56.37813</td>
<td align="right">0.0532121</td>
<td align="right">3</td>
<td align="right">64</td>
<td align="right">0.2000000</td>
<td align="right">0.0468750</td>
<td align="left">chr17:63224775-65224775,chr1:195710916-197710916,chr3:185449122-187449122</td>
<td align="left">APOH,CFH,KNG1</td>
</tr>
<tr class="odd">
<td align="left">GO Cellular Component.119</td>
<td align="left">TNFSF10</td>
<td align="left">GO Cellular Component</td>
<td align="left">GO: 0005615</td>
<td align="left">extracellular space</td>
<td align="right">1</td>
<td align="right">6.5e-06</td>
<td align="right">0.0082242</td>
<td align="right">0.0082242</td>
<td align="right">9.342017</td>
<td align="right">0.6422596</td>
<td align="right">6</td>
<td align="right">0.0802824</td>
<td align="right">0.7500000</td>
<td align="right">1</td>
<td align="right">1.00e-07</td>
<td align="right">0.0001862</td>
<td align="right">0.0001862</td>
<td align="right">10.93394</td>
<td align="right">0.7316668</td>
<td align="right">8</td>
<td align="right">880</td>
<td align="right">0.5333333</td>
<td align="right">0.0090909</td>
<td align="left">chr14:93844947-95844947,chr17:63224775-65224775,chr18:28804863-30804863,chr1:195710916-197710916,chr3:171274232-173274232,chr3:185449122-187449122</td>
<td align="left">APOH,CFH,CFHR3,KNG1,MEP1B,SERPINA1,SERPINA6,TNFSF10</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2" number="3">
<h2 id="eqtl-catalog-for-colocalization-analysis">
<span class="header-section-number">3</span> eQTL Catalog for colocalization analysis<a class="anchor" aria-label="anchor" href="#eqtl-catalog-for-colocalization-analysis"></a>
</h2>
<p>See example associated with <code>import_eQTLCatalogue</code>. A related function is <code>import_OpenGWAS</code> used to fetch data from OpenGWAS. The cis-pQTLs and 1e+6
flanking regions were considered and data are actually fetched from files stored locally. Only the first sentinel was used, and the code is not executed.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">INF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"INF"</span><span class="op">)</span></span>
<span><span class="va">HPC_WORK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"HPC_WORK"</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"eQTL-Catalogue"</span>,<span class="st">"hg19ToHg38.over.chain"</span><span class="op">)</span></span>
<span><span class="va">chain</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/Chain-class.html" class="external-link">import.chain</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="fu">gwasvcf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gwasvcf/man/set_bcftools.html" class="external-link">set_bcftools</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">HPC_WORK</span>,<span class="st">"bin"</span>,<span class="st">"bcftools"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"eQTL-Catalogue"</span>,<span class="st">"tabix_ftp_paths_gtex.tsv"</span><span class="op">)</span></span>
<span><span class="va">tabix_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">f</span>, sep <span class="op">=</span> <span class="st">"\t"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>               <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"eQTL-Catalogue"</span>,</span>
<span>               <span class="st">"tabix_ftp_paths_gtex.tsv"</span><span class="op">)</span></span>
<span><span class="va">imported_tabix_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">f</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="op">{</span><span class="va">ftp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"ftp://ftp.ebi.ac.uk/pub/databases/spot/eQTL/csv/GTEx_V8/ge"</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"/rds/public_databases/GTEx/csv"</span><span class="op">)</span>,<span class="va">ftp_path</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">1e6</span></span>
<span><span class="va">sentinels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">cis.vs.trans</span>,<span class="va">cis</span><span class="op">)</span></span>
<span></span>
<span><span class="va">liftRegion</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">chain</span>,<span class="va">flanking</span><span class="op">=</span><span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">x</span>,<span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span>seqnames<span class="op">=</span><span class="va">chr</span>,<span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="va">start</span>,<span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="va">flanking</span><span class="op">)</span></span>
<span>  <span class="fu">seqlevelsStyle</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"UCSC"</span></span>
<span>  <span class="va">gr38</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/liftOver.html" class="external-link">liftOver</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">chain</span><span class="op">)</span></span>
<span>  <span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">gr38</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="st">""</span>,<span class="va">chr</span><span class="op">)</span></span>
<span>  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">gr38</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">gr38</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>chr<span class="op">=</span><span class="va">chr</span>,start<span class="op">=</span><span class="va">start</span>,end<span class="op">=</span><span class="va">end</span>,region<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">chr</span>,<span class="st">":"</span>,<span class="va">start</span>,<span class="st">"-"</span>,<span class="va">end</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sumstats</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">prot</span>,<span class="va">chr</span>,<span class="va">region37</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GWAS sumstats\n"</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">INF</span>,<span class="st">"METAL/gwas2vcf"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prot</span>,<span class="st">".vcf.gz"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">gwas_stats</span> <span class="op">&lt;-</span> <span class="fu">gwasvcf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gwasvcf/man/query_gwas.html" class="external-link">query_gwas</a></span><span class="op">(</span><span class="va">f</span>, chrompos <span class="op">=</span> <span class="va">region37</span><span class="op">)</span></span>
<span>  <span class="va">gwas_stats</span> <span class="op">&lt;-</span> <span class="fu">gwasvcf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gwasvcf/man/vcf_to_granges.html" class="external-link">vcf_to_granges</a></span><span class="op">(</span><span class="va">gwas_stats</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                <span class="fu">keepSeqlevels</span><span class="op">(</span><span class="va">chr</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                <span class="fu">renameSeqlevels</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="va">chr</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">gwas_stats_hg38</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/liftOver.html" class="external-link">liftOver</a></span><span class="op">(</span><span class="va">gwas_stats</span>, <span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">renameSeqlevels</span><span class="op">(</span><span class="va">chr</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute</a></span><span class="op">(</span>chromosome <span class="op">=</span> <span class="va">seqnames</span>,</span>
<span>                                      position <span class="op">=</span> <span class="va">start</span>, <span class="va">REF</span>, <span class="va">ALT</span>, <span class="va">AF</span>, <span class="va">ES</span>, <span class="va">SE</span>, <span class="va">LP</span>, <span class="va">SS</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">chromosome</span>, <span class="va">position</span>, sep <span class="op">=</span> <span class="st">":"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>MAF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">AF</span>, <span class="fl">1</span><span class="op">-</span><span class="va">AF</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>row_count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">row_count</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">coloc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gwas_stats_hg38</span>,<span class="va">ensGene</span>,<span class="va">region38</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"c. GTEx_v8 imported eQTL datasets\n"</span><span class="op">)</span></span>
<span>  <span class="va">rnaseq_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">imported_tabix_paths</span>, <span class="va">quant_method</span> <span class="op">==</span> <span class="st">"ge"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>               <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>qtl_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">qtl_group</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ftp_path_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">rnaseq_df</span><span class="op">$</span><span class="va">ftp_path</span><span class="op">)</span>, <span class="va">rnaseq_df</span><span class="op">$</span><span class="va">qtl_id</span><span class="op">)</span></span>
<span>  <span class="va">hdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"eQTL-Catalogue"</span>,<span class="st">"column_names.GTEx"</span><span class="op">)</span></span>
<span>  <span class="va">column_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">hdr</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">safe_import</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/safely.html" class="external-link">safely</a></span><span class="op">(</span><span class="va">import_eQTLCatalogue</span><span class="op">)</span></span>
<span>  <span class="va">summary_list</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">ftp_path_list</span>, <span class="op">~</span><span class="fu">safe_import</span><span class="op">(</span><span class="va">.</span>, <span class="va">region38</span>,</span>
<span>                             selected_gene_id <span class="op">=</span> <span class="va">ensGene</span>, <span class="va">column_names</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">summary_list</span>, <span class="op">~</span><span class="va">.</span><span class="op">$</span><span class="va">result</span><span class="op">)</span></span>
<span>  <span class="va">result_list</span> <span class="op">&lt;-</span> <span class="va">result_list</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result_list</span>, <span class="va">is.null</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">result_filtered</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result_list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">result_list</span>,<span class="va">nrow</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                                <span class="op">~</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">result_filtered</span>, <span class="op">~</span><span class="fu"><a href="../reference/run_coloc.html">run_coloc</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">gwas_stats_hg38</span><span class="op">)</span>, .id <span class="op">=</span> <span class="st">"qtl_id"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sentinel</span> <span class="op">&lt;-</span> <span class="va">sentinels</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">isnpid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="fu">gap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gap/man/inv_chr_pos_a1_a2.html" class="external-link">inv_chr_pos_a1_a2</a></span><span class="op">(</span><span class="va">sentinel</span><span class="op">[[</span><span class="st">"SNP"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span><span class="op">{</span></span>
<span>    <span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="st">""</span>,<span class="va">chr</span><span class="op">)</span></span>
<span>    <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span></span>
<span>    <span class="va">start</span> <span class="op">&lt;-</span> <span class="va">pos</span><span class="op">-</span><span class="va">M</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">start</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span> <span class="va">start</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">end</span> <span class="op">&lt;-</span> <span class="va">pos</span><span class="op">+</span><span class="va">M</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">chr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">isnpid</span>,<span class="va">chr</span><span class="op">)</span></span>
<span><span class="va">region37</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">isnpid</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">chr</span>,<span class="st">":"</span>,<span class="va">start</span>,<span class="st">"-"</span>,<span class="va">end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensRegion37</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">inf1</span>,<span class="va">prot</span><span class="op">==</span><span class="va">sentinel</span><span class="op">[[</span><span class="st">"prot"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">chr</span>,<span class="st">":"</span>,<span class="va">start</span>,<span class="st">"-"</span>,<span class="va">end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">region38</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu">liftRegion</span><span class="op">(</span><span class="va">isnpid</span>,<span class="va">chain</span><span class="op">)</span>,<span class="va">region</span><span class="op">)</span></span>
<span><span class="va">ensGene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">inf1</span>,<span class="va">prot</span><span class="op">==</span><span class="va">sentinel</span><span class="op">[[</span><span class="st">"prot"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"ensembl_gene_id"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ensRegion38</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu">liftRegion</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">inf1</span>,<span class="va">prot</span><span class="op">==</span><span class="va">sentinel</span><span class="op">[[</span><span class="st">"prot"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,<span class="va">chain</span><span class="op">)</span>,<span class="va">region</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sentinel</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prot</span>,<span class="st">"-"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">":"</span>,<span class="st">"_"</span>,<span class="va">SNP</span><span class="op">)</span>,<span class="st">".rda"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gwas_stats_hg38</span> <span class="op">&lt;-</span> <span class="fu">sumstats</span><span class="op">(</span><span class="va">sentinel</span><span class="op">[[</span><span class="st">"prot"</span><span class="op">]</span><span class="op">]</span>,<span class="va">chr</span>,<span class="va">region37</span><span class="op">)</span></span>
<span><span class="va">coloc_df_imported</span> <span class="op">&lt;-</span> <span class="fu">coloc</span><span class="op">(</span><span class="va">gwas_stats_hg38</span>,<span class="va">ensGene</span>,<span class="va">region38</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">gwas_stats_hg38</span>,<span class="va">sentinel</span>,<span class="va">coloc_df_imported</span>,file<span class="op">=</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
<p>We load the data obtained from the code above,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"OPG-chr8_120081031_C_T.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">gwas_stats_hg38</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">position</span>, y <span class="op">=</span> <span class="va">LP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sentinel</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prot</span>,<span class="st">"-"</span>,<span class="va">SNP</span>,<span class="st">" association plot"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:coloc-1"></span>
<img src="pQTLtools/coloc-1.png" alt="Association plot" width="768" style="display:block; margin: auto"><p class="caption">
Figure 3.1: Association plot
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coloc_df_imported</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">coloc_df_imported</span>, <span class="op">-</span><span class="va">PP.H4.abf</span><span class="op">)</span></span>
<span>   <span class="fu">ggplot</span><span class="op">(</span><span class="va">coloc_df_imported</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">PP.H4.abf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggtitle</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sentinel</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prot</span>,<span class="st">"-"</span>,<span class="va">SNP</span>,<span class="st">" PP4 histogram"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">xlab</span><span class="op">(</span><span class="st">"PP4"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:coloc-2"></span>
<img src="pQTLtools/coloc-2.png" alt="Association plot" width="768" style="display:block; margin: auto"><p class="caption">
Figure 3.2: Association plot
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ktitle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sentinel</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Colocalization results for "</span>,<span class="va">prot</span>,<span class="st">"-"</span>,<span class="va">SNP</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">coloc_df_imported</span>, caption<span class="op">=</span><span class="va">ktitle</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>
<span id="tab:coloc">Table 3.1: </span>Colocalization results for OPG-chr8:120081031_C_T</caption>
<colgroup>
<col width="45%">
<col width="5%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left">qtl_id</th>
<th align="right">nsnps</th>
<th align="right">PP.H0.abf</th>
<th align="right">PP.H1.abf</th>
<th align="right">PP.H2.abf</th>
<th align="right">PP.H3.abf</th>
<th align="right">PP.H4.abf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">GTEx_V8_Adipose_Subcutaneous</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0000037</td>
<td align="right">0.9999961</td>
<td align="right">0.0000002</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Adipose_Visceral_Omentum</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0877730</td>
<td align="right">0.9085846</td>
<td align="right">0.0036424</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Adrenal_Gland</td>
<td align="right">6490</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4593515</td>
<td align="right">0.3617935</td>
<td align="right">0.1788549</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Artery_Aorta</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5953200</td>
<td align="right">0.3790719</td>
<td align="right">0.0256082</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Artery_Coronary</td>
<td align="right">6489</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4847137</td>
<td align="right">0.4779834</td>
<td align="right">0.0373029</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Artery_Tibial</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5945402</td>
<td align="right">0.3336653</td>
<td align="right">0.0717945</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Amygdala</td>
<td align="right">6450</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5612204</td>
<td align="right">0.3595461</td>
<td align="right">0.0792336</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Anterior_cingulate_cortex_BA24</td>
<td align="right">6479</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5297845</td>
<td align="right">0.4326513</td>
<td align="right">0.0375642</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Caudate_basal_ganglia</td>
<td align="right">6490</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5623609</td>
<td align="right">0.4050108</td>
<td align="right">0.0326282</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Cerebellar_Hemisphere</td>
<td align="right">6487</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5448030</td>
<td align="right">0.4129728</td>
<td align="right">0.0422242</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Cerebellum</td>
<td align="right">6487</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5455953</td>
<td align="right">0.3764554</td>
<td align="right">0.0779493</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Cortex</td>
<td align="right">6490</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4788122</td>
<td align="right">0.4670250</td>
<td align="right">0.0541628</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Frontal_Cortex_BA9</td>
<td align="right">6485</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4769094</td>
<td align="right">0.4745536</td>
<td align="right">0.0485370</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Hippocampus</td>
<td align="right">6482</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5508764</td>
<td align="right">0.3445222</td>
<td align="right">0.1046014</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Hypothalamus</td>
<td align="right">6486</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5031980</td>
<td align="right">0.4493794</td>
<td align="right">0.0474226</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Nucleus_accumbens_basal_ganglia</td>
<td align="right">6490</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5637913</td>
<td align="right">0.3754152</td>
<td align="right">0.0607935</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Putamen_basal_ganglia</td>
<td align="right">6481</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5773902</td>
<td align="right">0.3803744</td>
<td align="right">0.0422354</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Brain_Spinal_cord_cervical_c-1</td>
<td align="right">6476</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5674380</td>
<td align="right">0.3856918</td>
<td align="right">0.0468702</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Brain_Substantia_nigra</td>
<td align="right">6455</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5801170</td>
<td align="right">0.3810887</td>
<td align="right">0.0387944</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Breast_Mammary_Tissue</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5517909</td>
<td align="right">0.4207544</td>
<td align="right">0.0274547</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Cells_Cultured_fibroblasts</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Cells_EBV-transformed_lymphocytes</td>
<td align="right">6479</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4846865</td>
<td align="right">0.4841672</td>
<td align="right">0.0311463</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Colon_Sigmoid</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5263532</td>
<td align="right">0.4351477</td>
<td align="right">0.0384991</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Colon_Transverse</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0075211</td>
<td align="right">0.9921292</td>
<td align="right">0.0003497</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Esophagus_Gastroesophageal_Junction</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5779762</td>
<td align="right">0.3947891</td>
<td align="right">0.0272347</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Esophagus_Mucosa</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.3668237</td>
<td align="right">0.6161141</td>
<td align="right">0.0170622</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Esophagus_Muscularis</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0107519</td>
<td align="right">0.9787420</td>
<td align="right">0.0105062</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Heart_Atrial_Appendage</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0005064</td>
<td align="right">0.9994704</td>
<td align="right">0.0000233</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Heart_Left_Ventricle</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0246851</td>
<td align="right">0.9741237</td>
<td align="right">0.0011912</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Kidney_Cortex</td>
<td align="right">6382</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5348624</td>
<td align="right">0.4201667</td>
<td align="right">0.0449709</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Liver</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4685926</td>
<td align="right">0.4736155</td>
<td align="right">0.0577919</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Lung</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0104079</td>
<td align="right">0.9885490</td>
<td align="right">0.0010430</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Minor_Salivary_Gland</td>
<td align="right">6471</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5749675</td>
<td align="right">0.3674231</td>
<td align="right">0.0576094</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Muscle_Skeletal</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.6122075</td>
<td align="right">0.3654167</td>
<td align="right">0.0223758</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Nerve_Tibial</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.1864732</td>
<td align="right">0.8056029</td>
<td align="right">0.0079240</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Ovary</td>
<td align="right">6489</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5503041</td>
<td align="right">0.4127715</td>
<td align="right">0.0369244</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Pancreas</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.0189411</td>
<td align="right">0.9801002</td>
<td align="right">0.0009587</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Pituitary</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.6120249</td>
<td align="right">0.3519956</td>
<td align="right">0.0359795</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Prostate</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5131930</td>
<td align="right">0.4522440</td>
<td align="right">0.0345630</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Skin_Not_Sun_Exposed_Suprapubic</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5513830</td>
<td align="right">0.4267627</td>
<td align="right">0.0218543</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Skin_Sun_Exposed_Lower_leg</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.4278374</td>
<td align="right">0.5543397</td>
<td align="right">0.0178229</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Small_Intestine_Terminal_Ileum</td>
<td align="right">6487</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5695417</td>
<td align="right">0.3523800</td>
<td align="right">0.0780782</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Spleen</td>
<td align="right">6489</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5456173</td>
<td align="right">0.4073894</td>
<td align="right">0.0469934</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Stomach</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5807760</td>
<td align="right">0.3769347</td>
<td align="right">0.0422893</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Testis</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.6158313</td>
<td align="right">0.3520954</td>
<td align="right">0.0320733</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Thyroid</td>
<td align="right">6491</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.1501267</td>
<td align="right">0.8433101</td>
<td align="right">0.0065632</td>
</tr>
<tr class="odd">
<td align="left">GTEx_V8_Uterus</td>
<td align="right">6484</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5720926</td>
<td align="right">0.3891594</td>
<td align="right">0.0387480</td>
</tr>
<tr class="even">
<td align="left">GTEx_V8_Vagina</td>
<td align="right">6470</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.5955160</td>
<td align="right">0.3630831</td>
<td align="right">0.0414009</td>
</tr>
</tbody>
</table>
<p>The function <code>sumstats()</code> obtained meta-analysis summary statistics (in build 37 and therefore lifted over to build 38) to be used in colocalization
analysis. The output are saved in the <code>.RDS</code> files. Note that <code>ftp_path</code> changes from eQTL Catalog to local files.</p>
<div class="section level3" number="3.1">
<h3 id="pqtl-based-mendelian-randomisation-mr">
<span class="header-section-number">3.1</span> pQTL-based Mendelian Randomisation (MR)<a class="anchor" aria-label="anchor" href="#pqtl-based-mendelian-randomisation-mr"></a>
</h3>
<p>The function <code>pqtlMR</code> is derived from<span class="citation"><sup>1</sup></span>. It has an attractive feature that multiple pQTLs
can be used together for conducting MR with a list of outcomes from MR-Base. For generic applications
the <code><a href="../reference/run_TwoSampleMR.html">run_TwoSampleMR()</a></code> function can be used.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"tests"</span>,<span class="st">"Ins.csv"</span><span class="op">)</span></span>
<span><span class="va">ivs</span> <span class="op">&lt;-</span> <span class="fu">format_data</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">caption4</span> <span class="op">&lt;-</span> <span class="st">"ABO/LIFR variants and CHD/FEV1"</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">ivs</span>, caption<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">caption4</span>,<span class="st">"(instruments)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-3">Table 3.2: </span>ABO/LIFR variants and CHD/FEV1 (instruments)</caption>
<colgroup>
<col width="5%">
<col width="13%">
<col width="13%">
<col width="7%">
<col width="8%">
<col width="7%">
<col width="8%">
<col width="5%">
<col width="10%">
<col width="12%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">SNP</th>
<th align="left">effect_allele.exposure</th>
<th align="left">other_allele.exposure</th>
<th align="right">eaf.exposure</th>
<th align="right">beta.exposure</th>
<th align="right">se.exposure</th>
<th align="right">pval.exposure</th>
<th align="left">exposure</th>
<th align="left">mr_keep.exposure</th>
<th align="left">pval_origin.exposure</th>
<th align="left">id.exposure</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">rs505922</td>
<td align="left">C</td>
<td align="left">T</td>
<td align="right">0.313</td>
<td align="right">1.298</td>
<td align="right">0.014</td>
<td align="right">0</td>
<td align="left">ABO</td>
<td align="left">TRUE</td>
<td align="left">reported</td>
<td align="left">dU3C0x</td>
</tr>
<tr class="even">
<td align="left">rs635634</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="right">0.180</td>
<td align="right">-0.300</td>
<td align="right">0.032</td>
<td align="right">0</td>
<td align="left">LIFR</td>
<td align="left">TRUE</td>
<td align="left">reported</td>
<td align="left">YmGdhW</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ieu-a-7"</span>,<span class="st">"ebi-a-GCST007432"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pqtlMR.html">pqtlMR</a></span><span class="op">(</span><span class="va">ivs</span>, <span class="va">ids</span><span class="op">)</span></span>
<span><span class="co">#&gt; API: public: http://gwas-api.mrcieu.ac.uk/</span></span>
<span><span class="co">#&gt; Extracting data for 2 SNP(s) from 2 GWAS(s)</span></span>
<span><span class="co">#&gt; Harmonising ABO (dU3C0x) and FEV1 || id:ebi-a-GCST007432 (ebi-a-GCST007432)</span></span>
<span><span class="co">#&gt; Harmonising LIFR (YmGdhW) and FEV1 || id:ebi-a-GCST007432 (ebi-a-GCST007432)</span></span>
<span><span class="co">#&gt; Harmonising ABO (dU3C0x) and Coronary heart disease || id:ieu-a-7 (ieu-a-7)</span></span>
<span><span class="co">#&gt; Harmonising LIFR (YmGdhW) and Coronary heart disease || id:ieu-a-7 (ieu-a-7)</span></span>
<span><span class="co">#&gt; Analysing 'dU3C0x' on 'ebi-a-GCST007432'</span></span>
<span><span class="co">#&gt; Analysing 'dU3C0x' on 'ieu-a-7'</span></span>
<span><span class="co">#&gt; Analysing 'YmGdhW' on 'ebi-a-GCST007432'</span></span>
<span><span class="co">#&gt; Analysing 'YmGdhW' on 'ieu-a-7'</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="st">"pQTL-combined-result.txt"</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">result</span>,caption<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">caption4</span>, <span class="st">"(result)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-3">Table 3.2: </span>ABO/LIFR variants and CHD/FEV1 (result)</caption>
<colgroup>
<col width="9%">
<col width="13%">
<col width="37%">
<col width="7%">
<col width="8%">
<col width="4%">
<col width="6%">
<col width="6%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="left">outcome</th>
<th align="left">exposure</th>
<th align="left">method</th>
<th align="right">nsnp</th>
<th align="right">b</th>
<th align="right">se</th>
<th align="right">pval</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dU3C0x</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ABO</td>
<td align="left">Wald ratio</td>
<td align="right">1</td>
<td align="right">-0.0109</td>
<td align="right">0.00193</td>
<td align="right">0.0e+00</td>
</tr>
<tr class="even">
<td align="left">dU3C0x</td>
<td align="left">ieu-a-7</td>
<td align="left">Coronary heart disease || id:ieu-a-7</td>
<td align="left">ABO</td>
<td align="left">Wald ratio</td>
<td align="right">1</td>
<td align="right">0.0334</td>
<td align="right">0.00730</td>
<td align="right">4.6e-06</td>
</tr>
<tr class="odd">
<td align="left">YmGdhW</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">LIFR</td>
<td align="left">Wald ratio</td>
<td align="right">1</td>
<td align="right">0.0620</td>
<td align="right">0.01000</td>
<td align="right">0.0e+00</td>
</tr>
<tr class="even">
<td align="left">YmGdhW</td>
<td align="left">ieu-a-7</td>
<td align="left">Coronary heart disease || id:ieu-a-7</td>
<td align="left">LIFR</td>
<td align="left">Wald ratio</td>
<td align="right">1</td>
<td align="right">-0.2572</td>
<td align="right">0.03904</td>
<td align="right">0.0e+00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="st">"pQTL-combined-single.txt"</span>,header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">single</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"All"</span>,<span class="va">SNP</span><span class="op">)</span><span class="op">)</span>, caption<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">caption4</span>, <span class="st">"(single)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-3">Table 3.2: </span>ABO/LIFR variants and CHD/FEV1 (single)</caption>
<colgroup>
<col width="2%">
<col width="6%">
<col width="35%">
<col width="9%">
<col width="12%">
<col width="8%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">exposure</th>
<th align="left">outcome</th>
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="right">samplesize</th>
<th align="left">SNP</th>
<th align="left">b</th>
<th align="left">se</th>
<th align="left">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">ABO</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">dU3C0x</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs505922</td>
<td align="left">-0.0109</td>
<td align="left">0.00193</td>
<td align="left">1.35e-08</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">ABO</td>
<td align="left">Coronary heart disease || id:ieu-a-7</td>
<td align="left">dU3C0x</td>
<td align="left">ieu-a-7</td>
<td align="right">184305</td>
<td align="left">rs505922</td>
<td align="left">0.0334</td>
<td align="left">0.00730</td>
<td align="left">4.63e-06</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">LIFR</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">YmGdhW</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs635634</td>
<td align="left">0.0620</td>
<td align="left">0.01000</td>
<td align="left">5.65e-10</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">LIFR</td>
<td align="left">Coronary heart disease || id:ieu-a-7</td>
<td align="left">YmGdhW</td>
<td align="left">ieu-a-7</td>
<td align="right">184305</td>
<td align="left">rs635634</td>
<td align="left">-0.2572</td>
<td align="left">0.03904</td>
<td align="left">4.47e-11</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"harmonise"</span>,<span class="st">"result"</span>,<span class="st">"single"</span><span class="op">)</span>,</span>
<span>                 <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pQTL-combined-"</span>,<span class="va">x</span>,<span class="st">".txt"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2" number="4">
<h2 id="run_twosamplemr">
<span class="header-section-number">4</span> run_TwoSampleMR<a class="anchor" aria-label="anchor" href="#run_twosamplemr"></a>
</h2>
<p>The function has similiarity to<span class="citation"><sup>2</sup></span>. The documentation example is quoted here,</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="st">"ebi-a-GCST007432"</span></span>
<span><span class="va">prot</span> <span class="op">&lt;-</span> <span class="st">"MMP.10"</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"cis"</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">prot</span>,<span class="st">"-"</span>,<span class="va">type</span>,<span class="st">".mrx"</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"tests"</span>,<span class="va">f</span><span class="op">)</span>,</span>
<span>                header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">exposure</span> <span class="op">&lt;-</span> <span class="fu">format_data</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">d</span>,<span class="op">{</span><span class="va">P</span><span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="va">logP</span><span class="op">}</span><span class="op">)</span>, phenotype_col<span class="op">=</span><span class="st">"prot"</span>, snp_col<span class="op">=</span><span class="st">"rsid"</span>,</span>
<span>                        chr_col<span class="op">=</span><span class="st">"Chromosome"</span>, pos_col<span class="op">=</span><span class="st">"Posistion"</span>,</span>
<span>                        effect_allele_col<span class="op">=</span><span class="st">"Allele1"</span>, other_allele_col<span class="op">=</span><span class="st">"Allele2"</span>,</span>
<span>                        eaf_col<span class="op">=</span><span class="st">"Freq1"</span>, beta_col<span class="op">=</span><span class="st">"Effect"</span>, se_col<span class="op">=</span><span class="st">"StdErr"</span>,</span>
<span>                        pval_col<span class="op">=</span><span class="st">"P"</span>, log_pval<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        samplesize_col<span class="op">=</span><span class="st">"N"</span><span class="op">)</span></span>
<span><span class="va">clump</span> <span class="op">&lt;-</span> <span class="fu">clump_data</span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please look at vignettes for options on running this locally if you need to run many instances of this command.</span></span>
<span><span class="co">#&gt; Clumping ZoHewj, 1106 variants, using EUR population reference</span></span>
<span><span class="co">#&gt; Removing 1102 of 1106 variants due to LD with other variants or absence from LD reference panel</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu">extract_outcome_data</span><span class="op">(</span>snps<span class="op">=</span><span class="va">exposure</span><span class="op">$</span><span class="va">SNP</span>,outcomes<span class="op">=</span><span class="va">outcomes</span><span class="op">)</span></span>
<span><span class="co">#&gt; Extracting data for 1106 SNP(s) from 1 GWAS(s)</span></span>
<span><span class="co">#&gt; Finding proxies for 155 SNPs in outcome ebi-a-GCST007432</span></span>
<span><span class="co">#&gt; Extracting data for 155 SNP(s) from 1 GWAS(s)</span></span>
<span><span class="va">harmonise</span> <span class="op">&lt;-</span> <span class="fu">harmonise_data</span><span class="op">(</span><span class="va">clump</span>,<span class="va">outcome</span><span class="op">)</span></span>
<span><span class="co">#&gt; Harmonising MMP.10 (ZoHewj) and FEV1 || id:ebi-a-GCST007432 (ebi-a-GCST007432)</span></span>
<span><span class="va">prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">outcomes</span>,<span class="va">prot</span>,<span class="va">type</span>,sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/run_TwoSampleMR.html">run_TwoSampleMR</a></span><span class="op">(</span><span class="va">harmonise</span>, mr_plot<span class="op">=</span><span class="st">"pQTLtools"</span>, prefix<span class="op">=</span><span class="va">prefix</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysing 'ZoHewj' on 'ebi-a-GCST007432'</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pQTLtools/run_TwoSampleMR-1.png" alt="Two-sample MR" width="672" style="display:block; margin: auto"><p class="caption">
(#fig:run_TwoSampleMR-1)Two-sample MR
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pQTLtools/run_TwoSampleMR-2.png" alt="Two-sample MR" width="672" style="display:block; margin: auto"><p class="caption">
(#fig:run_TwoSampleMR-2)Two-sample MR
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pQTLtools/run_TwoSampleMR-3.png" alt="Two-sample MR" width="672" style="display:block; margin: auto"><p class="caption">
(#fig:run_TwoSampleMR-3)Two-sample MR
</p>
</div>
<div class="figure" style="text-align: center">
<img src="pQTLtools/run_TwoSampleMR-4.png" alt="Two-sample MR" width="672" style="display:block; margin: auto"><p class="caption">
(#fig:run_TwoSampleMR-4)Two-sample MR
</p>
</div>
<p>The output is contained in individual <code>.txt</code> files, together with the scatter, forest, funnel and leave-one-out plots.</p>
<table style="width:100%;" class="table">
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>MMP.10 variants and FEV1 (result)</caption>
<colgroup>
<col width="9%">
<col width="12%">
<col width="29%">
<col width="6%">
<col width="19%">
<col width="3%">
<col width="7%">
<col width="6%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="left">outcome</th>
<th align="left">exposure</th>
<th align="left">method</th>
<th align="right">nsnp</th>
<th align="right">b</th>
<th align="right">se</th>
<th align="right">pval</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">MR Egger</td>
<td align="right">4</td>
<td align="right">-0.000577</td>
<td align="right">0.01001</td>
<td align="right">0.959</td>
</tr>
<tr class="even">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">Weighted median</td>
<td align="right">4</td>
<td align="right">0.002002</td>
<td align="right">0.00628</td>
<td align="right">0.750</td>
</tr>
<tr class="odd">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">Inverse variance weighted</td>
<td align="right">4</td>
<td align="right">0.002067</td>
<td align="right">0.00594</td>
<td align="right">0.728</td>
</tr>
<tr class="even">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">Simple mode</td>
<td align="right">4</td>
<td align="right">0.004152</td>
<td align="right">0.00994</td>
<td align="right">0.704</td>
</tr>
<tr class="odd">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">Weighted mode</td>
<td align="right">4</td>
<td align="right">0.001134</td>
<td align="right">0.00706</td>
<td align="right">0.883</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>MMP.10 variants and FEV1 (heterogeneity)</caption>
<colgroup>
<col width="10%">
<col width="14%">
<col width="31%">
<col width="7%">
<col width="21%">
<col width="5%">
<col width="4%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="left">outcome</th>
<th align="left">exposure</th>
<th align="left">method</th>
<th align="right">Q</th>
<th align="right">Q_df</th>
<th align="right">Q_pval</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">MR Egger</td>
<td align="right">0.114</td>
<td align="right">2</td>
<td align="right">0.944</td>
</tr>
<tr class="even">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="left">Inverse variance weighted</td>
<td align="right">0.222</td>
<td align="right">3</td>
<td align="right">0.974</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>MMP.10 variants and FEV1 (pleiotropy)</caption>
<colgroup>
<col width="11%">
<col width="16%">
<col width="35%">
<col width="8%">
<col width="15%">
<col width="7%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="left">outcome</th>
<th align="left">exposure</th>
<th align="right">egger_intercept</th>
<th align="right">se</th>
<th align="right">pval</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">MMP.10</td>
<td align="right">0.00143</td>
<td align="right">0.00434</td>
<td align="right">0.774</td>
</tr></tbody>
</table>
<table style="width:100%;" class="table">
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>MMP.10 variants and FEV1 (single)</caption>
<colgroup>
<col width="6%">
<col width="26%">
<col width="8%">
<col width="11%">
<col width="7%">
<col width="22%">
<col width="6%">
<col width="5%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">exposure</th>
<th align="left">outcome</th>
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="right">samplesize</th>
<th align="left">SNP</th>
<th align="right">b</th>
<th align="right">se</th>
<th align="right">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs11225354</td>
<td align="right">0.006425</td>
<td align="right">0.01217</td>
<td align="right">0.598</td>
</tr>
<tr class="even">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs142915220</td>
<td align="right">-0.003993</td>
<td align="right">0.02856</td>
<td align="right">0.889</td>
</tr>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs17099622</td>
<td align="right">0.004360</td>
<td align="right">0.02229</td>
<td align="right">0.845</td>
</tr>
<tr class="even">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs17860955</td>
<td align="right">0.000616</td>
<td align="right">0.00739</td>
<td align="right">0.934</td>
</tr>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">All - Inverse variance weighted</td>
<td align="right">0.002067</td>
<td align="right">0.00594</td>
<td align="right">0.728</td>
</tr>
<tr class="even">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">All - MR Egger</td>
<td align="right">-0.000577</td>
<td align="right">0.01001</td>
<td align="right">0.959</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>MMP.10 variants and FEV1 (loo)</caption>
<colgroup>
<col width="7%">
<col width="31%">
<col width="9%">
<col width="13%">
<col width="9%">
<col width="9%">
<col width="7%">
<col width="6%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">exposure</th>
<th align="left">outcome</th>
<th align="left">id.exposure</th>
<th align="left">id.outcome</th>
<th align="right">samplesize</th>
<th align="left">SNP</th>
<th align="right">b</th>
<th align="right">se</th>
<th align="right">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs11225354</td>
<td align="right">0.000703</td>
<td align="right">0.00681</td>
<td align="right">0.918</td>
</tr>
<tr class="even">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs142915220</td>
<td align="right">0.002341</td>
<td align="right">0.00608</td>
<td align="right">0.700</td>
</tr>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs17099622</td>
<td align="right">0.001891</td>
<td align="right">0.00617</td>
<td align="right">0.759</td>
</tr>
<tr class="even">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">rs17860955</td>
<td align="right">0.004730</td>
<td align="right">0.01001</td>
<td align="right">0.636</td>
</tr>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FEV1 || id:ebi-a-GCST007432</td>
<td align="left">ZoHewj</td>
<td align="left">ebi-a-GCST007432</td>
<td align="right">321047</td>
<td align="left">All</td>
<td align="right">0.002067</td>
<td align="right">0.00594</td>
<td align="right">0.728</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2" number="5">
<h2 id="mr-using-cis-trans-and-cistrans-pan-instruments">
<span class="header-section-number">5</span> MR using cis, trans and cis+trans (pan) instruments<a class="anchor" aria-label="anchor" href="#mr-using-cis-trans-and-cistrans-pan-instruments"></a>
</h2>
<p>This is illustrated with IL-12B.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">efo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"efo.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"IL.12B.txt"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>MRBASEID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">outcome</span>,<span class="st">"id:"</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,y<span class="op">=</span><span class="va">b</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">outcome</span>,<span class="op">-</span><span class="va">method</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">left_join</span><span class="op">(</span><span class="va">efo</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">cistrans</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining, by = "MRBASEID"</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MRBASEID"</span>,<span class="st">"trait"</span>,<span class="st">"cistrans"</span>,<span class="st">"nsnp"</span>,<span class="st">"b"</span>,<span class="st">"se"</span>,<span class="st">"pval"</span><span class="op">)</span><span class="op">]</span>,<span class="fl">29</span><span class="op">)</span>,caption<span class="op">=</span><span class="st">"MR with IL-12B variants"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:mr">Table 5.1: </span>MR with IL-12B variants</caption>
<colgroup>
<col width="22%">
<col width="30%">
<col width="9%">
<col width="5%">
<col width="11%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left">MRBASEID</th>
<th align="left">trait</th>
<th align="left">cistrans</th>
<th align="right">nsnp</th>
<th align="right">b</th>
<th align="right">se</th>
<th align="right">pval</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">bbj-a-123</td>
<td align="left">Graves disease</td>
<td align="left">cis</td>
<td align="right">21</td>
<td align="right">0.0078000</td>
<td align="right">0.1008000</td>
<td align="right">0.9380000</td>
</tr>
<tr class="even">
<td align="left">ebi-a-GCST003156</td>
<td align="left">systemic lupus erythematosus</td>
<td align="left">cis</td>
<td align="right">39</td>
<td align="right">-0.0958000</td>
<td align="right">0.0676000</td>
<td align="right">0.1566000</td>
</tr>
<tr class="odd">
<td align="left">ebi-a-GCST005528</td>
<td align="left">juvenile idiopathic arthritis</td>
<td align="left">cis</td>
<td align="right">1</td>
<td align="right">-0.1670000</td>
<td align="right">0.1140000</td>
<td align="right">0.1400000</td>
</tr>
<tr class="even">
<td align="left">ebi-a-GCST005581</td>
<td align="left">primary biliary cirrhosis</td>
<td align="left">cis</td>
<td align="right">2</td>
<td align="right">0.0056600</td>
<td align="right">0.1630000</td>
<td align="right">0.9720000</td>
</tr>
<tr class="odd">
<td align="left">finn-a-AB1_HIV</td>
<td align="left">HIV infection</td>
<td align="left">cis</td>
<td align="right">29</td>
<td align="right">-0.1292000</td>
<td align="right">0.2800000</td>
<td align="right">0.6450000</td>
</tr>
<tr class="even">
<td align="left">finn-a-D3_SARCOIDOSIS</td>
<td align="left">Sarcoidosis</td>
<td align="left">cis</td>
<td align="right">29</td>
<td align="right">-0.0604000</td>
<td align="right">0.1150000</td>
<td align="right">0.6010000</td>
</tr>
<tr class="odd">
<td align="left">finn-a-M13_SJOGREN</td>
<td align="left">Sjogren syndrome</td>
<td align="left">cis</td>
<td align="right">29</td>
<td align="right">-0.2480000</td>
<td align="right">0.1410000</td>
<td align="right">0.0802000</td>
</tr>
<tr class="even">
<td align="left">finn-a-MENINGITIS</td>
<td align="left">meningitis infection</td>
<td align="left">cis</td>
<td align="right">29</td>
<td align="right">-0.2172000</td>
<td align="right">0.1910000</td>
<td align="right">0.2570000</td>
</tr>
<tr class="odd">
<td align="left">ieu-a-1081</td>
<td align="left">IGA glomerulonephritis</td>
<td align="left">cis</td>
<td align="right">3</td>
<td align="right">0.2096000</td>
<td align="right">0.1770000</td>
<td align="right">0.2370000</td>
</tr>
<tr class="even">
<td align="left">ieu-a-1112</td>
<td align="left">sclerosing cholangitis</td>
<td align="left">cis</td>
<td align="right">32</td>
<td align="right">0.0520400</td>
<td align="right">0.0682000</td>
<td align="right">0.4460000</td>
</tr>
<tr class="odd">
<td align="left">ieu-a-276</td>
<td align="left">celiac disease</td>
<td align="left">cis</td>
<td align="right">3</td>
<td align="right">-0.0172900</td>
<td align="right">0.1214000</td>
<td align="right">0.8870000</td>
</tr>
<tr class="even">
<td align="left">ieu-a-31</td>
<td align="left">inflammatory bowel disease</td>
<td align="left">cis</td>
<td align="right">56</td>
<td align="right">0.3900000</td>
<td align="right">0.0350000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">ieu-b-18</td>
<td align="left">multiple sclerosis</td>
<td align="left">cis</td>
<td align="right">26</td>
<td align="right">-0.0256000</td>
<td align="right">0.0426000</td>
<td align="right">0.5480000</td>
</tr>
<tr class="even">
<td align="left">ieu-b-69</td>
<td align="left">sepsis</td>
<td align="left">cis</td>
<td align="right">56</td>
<td align="right">-0.0334000</td>
<td align="right">0.0266000</td>
<td align="right">0.2090000</td>
</tr>
<tr class="odd">
<td align="left">ukb-a-115</td>
<td align="left">Vitiligo</td>
<td align="left">cis</td>
<td align="right">54</td>
<td align="right">-0.0000624</td>
<td align="right">0.0000757</td>
<td align="right">0.4100000</td>
</tr>
<tr class="even">
<td align="left">ukb-a-552</td>
<td align="left">Crohnâ€™s disease</td>
<td align="left">cis</td>
<td align="right">54</td>
<td align="right">0.0008850</td>
<td align="right">0.0002140</td>
<td align="right">0.0000363</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-10537</td>
<td align="left">psoriasis</td>
<td align="left">cis</td>
<td align="right">17</td>
<td align="right">-0.0035700</td>
<td align="right">0.0007880</td>
<td align="right">0.0000059</td>
</tr>
<tr class="even">
<td align="left">ukb-b-13251</td>
<td align="left">gout</td>
<td align="left">cis</td>
<td align="right">20</td>
<td align="right">-0.0001410</td>
<td align="right">0.0004710</td>
<td align="right">0.7640000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-15606</td>
<td align="left">pneumonia</td>
<td align="left">cis</td>
<td align="right">7</td>
<td align="right">0.0002170</td>
<td align="right">0.0002460</td>
<td align="right">0.3760000</td>
</tr>
<tr class="even">
<td align="left">ukb-b-15622</td>
<td align="left">Tuberculosis</td>
<td align="left">cis</td>
<td align="right">7</td>
<td align="right">0.0001340</td>
<td align="right">0.0003120</td>
<td align="right">0.6680000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-16499</td>
<td align="left">allergic rhinitis</td>
<td align="left">cis</td>
<td align="right">40</td>
<td align="right">0.0002750</td>
<td align="right">0.0010300</td>
<td align="right">0.7880000</td>
</tr>
<tr class="even">
<td align="left">ukb-b-16702</td>
<td align="left">allergy</td>
<td align="left">cis</td>
<td align="right">7</td>
<td align="right">-0.0003850</td>
<td align="right">0.0003460</td>
<td align="right">0.2654000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-18194</td>
<td align="left">ankylosing spondylitis</td>
<td align="left">cis</td>
<td align="right">5</td>
<td align="right">0.0001030</td>
<td align="right">0.0002750</td>
<td align="right">0.7100000</td>
</tr>
<tr class="even">
<td align="left">ukb-b-19386</td>
<td align="left">ulcerative colitis</td>
<td align="left">cis</td>
<td align="right">7</td>
<td align="right">0.0005620</td>
<td align="right">0.0002730</td>
<td align="right">0.0394000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-19732</td>
<td align="left">hypothyroidism</td>
<td align="left">cis</td>
<td align="right">37</td>
<td align="right">-0.0000555</td>
<td align="right">0.0009270</td>
<td align="right">0.9520000</td>
</tr>
<tr class="even">
<td align="left">ukb-b-20141</td>
<td align="left">atopic eczema</td>
<td align="left">cis</td>
<td align="right">26</td>
<td align="right">-0.0000095</td>
<td align="right">0.0006290</td>
<td align="right">0.9880000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-20208</td>
<td align="left">asthma</td>
<td align="left">cis</td>
<td align="right">7</td>
<td align="right">0.0000822</td>
<td align="right">0.0002650</td>
<td align="right">0.7560000</td>
</tr>
<tr class="even">
<td align="left">ukb-b-8814</td>
<td align="left">urinary tract infection</td>
<td align="left">cis</td>
<td align="right">18</td>
<td align="right">-0.0005110</td>
<td align="right">0.0004730</td>
<td align="right">0.2790000</td>
</tr>
<tr class="odd">
<td align="left">ukb-b-9125</td>
<td align="left">rheumatoid arthritis</td>
<td align="left">cis</td>
<td align="right">17</td>
<td align="right">-0.0001220</td>
<td align="right">0.0006220</td>
<td align="right">0.8450000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">d3</span>,<span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">trait</span>, x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">cistrans</span>,ncol<span class="op">=</span><span class="fl">3</span>,scales<span class="op">=</span><span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">b</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, xend <span class="op">=</span> <span class="va">b</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, yend <span class="op">=</span> <span class="va">trait</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>lty<span class="op">=</span><span class="fl">2</span>, <span class="fu">aes</span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Effect size"</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mr"></span>
<img src="pQTLtools/mr-1.png" alt="MR with cis, trans and cis+trans variants of IL-12B" width="672" style="display:block; margin: auto"><p class="caption">
Figure 5.1: MR with cis, trans and cis+trans variants of IL-12B
</p>
</div>
</div>
<div class="section level2" number="6">
<h2 id="gsmr-forest-plots">
<span class="header-section-number">6</span> GSMR forest plots<a class="anchor" aria-label="anchor" href="#gsmr-forest-plots"></a>
</h2>
<p>This is based on GSMR results of TNFB and a range of immune-mediated traits,</p>
<table class="table">
<caption>
<span id="tab:tnfb">Table 6.1: </span>GSMR results for TNFB and immune-mediated traits</caption>
<thead><tr class="header">
<th align="left">Outcome</th>
<th align="right">Effect</th>
<th align="right">StdErr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Multiple sclerosis</td>
<td align="right">0.6905860</td>
<td align="right">0.0592704</td>
</tr>
<tr class="even">
<td align="left">Systemic lupus erythematosus</td>
<td align="right">0.7668750</td>
<td align="right">0.0790005</td>
</tr>
<tr class="odd">
<td align="left">Sclerosing cholangitis</td>
<td align="right">0.6267150</td>
<td align="right">0.0759547</td>
</tr>
<tr class="even">
<td align="left">Juvenile idiopathic arthritis</td>
<td align="right">-1.1757700</td>
<td align="right">0.1602930</td>
</tr>
<tr class="odd">
<td align="left">Psoriasis</td>
<td align="right">0.0058259</td>
<td align="right">0.0008000</td>
</tr>
<tr class="even">
<td align="left">Rheumatoid arthritis</td>
<td align="right">-0.0037807</td>
<td align="right">0.0006252</td>
</tr>
<tr class="odd">
<td align="left">Inflammatory bowel disease</td>
<td align="right">-0.1433420</td>
<td align="right">0.0252725</td>
</tr>
<tr class="even">
<td align="left">Ankylosing spondylitis</td>
<td align="right">-0.0031685</td>
<td align="right">0.0006262</td>
</tr>
<tr class="odd">
<td align="left">Hypothyroidism</td>
<td align="right">-0.0043205</td>
<td align="right">0.0009873</td>
</tr>
<tr class="even">
<td align="left">Allergic rhinitis</td>
<td align="right">0.0039308</td>
<td align="right">0.0009260</td>
</tr>
<tr class="odd">
<td align="left">IgA glomerulonephritis</td>
<td align="right">-0.3269660</td>
<td align="right">0.1052620</td>
</tr>
<tr class="even">
<td align="left">Atopic eczema</td>
<td align="right">-0.0020402</td>
<td align="right">0.0006781</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">mr_forestplot</span><span class="op">(</span><span class="va">tnfb</span>,colgap.forest.left<span class="op">=</span><span class="st">"0.05cm"</span>, fontsize<span class="op">=</span><span class="fl">14</span>,</span>
<span>              leftcols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"studlab"</span><span class="op">)</span>, leftlabs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Outcome"</span><span class="op">)</span>,</span>
<span>              plotwidth<span class="op">=</span><span class="st">"5inch"</span>, sm<span class="op">=</span><span class="st">"OR"</span>, sortvar<span class="op">=</span><span class="va">tnfb</span><span class="op">[[</span><span class="st">"Effect"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>              rightcols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"effect"</span>,<span class="st">"ci"</span>,<span class="st">"pval"</span><span class="op">)</span>, rightlabs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OR"</span>,<span class="st">"95%CI"</span>,<span class="st">"GSMR P"</span><span class="op">)</span>,</span>
<span>              digits<span class="op">=</span><span class="fl">3</span>, digits.pval<span class="op">=</span><span class="fl">2</span>, scientific.pval<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>              common<span class="op">=</span><span class="cn">FALSE</span>, random<span class="op">=</span><span class="cn">FALSE</span>, print.I2<span class="op">=</span><span class="cn">FALSE</span>, print.pval.Q<span class="op">=</span><span class="cn">FALSE</span>, print.tau2<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>              addrow<span class="op">=</span><span class="cn">TRUE</span>, backtransf<span class="op">=</span><span class="cn">TRUE</span>, spacing<span class="op">=</span><span class="fl">1.6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: meta</span></span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="pQTLtools/mr_forestplot-1.png" alt="Forest plots based on MR results on TNFB" width="1152" style="display:block; margin: auto"><p class="caption">
(#fig:mr_forestplot)Forest plots based on MR results on TNFB
</p>
</div>
</div>
<div class="section level2" number="7">
<h2 id="literature-on-pqtls">
<span class="header-section-number">7</span> Literature on pQTLs<a class="anchor" aria-label="anchor" href="#literature-on-pqtls"></a>
</h2>
<p>Those as identified by<span class="citation"><sup>3</sup></span> and<span class="citation"><sup>4</sup></span> are included as EndNote libraries which is now part of pQTLdata package.</p>
</div>
<div class="section level2" number="8">
<h2 id="uniprot-ids">
<span class="header-section-number">8</span> UniProt IDs<a class="anchor" aria-label="anchor" href="#uniprot-ids"></a>
</h2>
<p>The function <code>uniprot2ids</code> converts UniProt IDs to others.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-zheng20" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Zheng, J. <em>et al.</em> <a href="https://doi.org/10.1038/s41588-020-0682-6" class="external-link">Phenome-wide mendelian randomization mapping the influence of the plasma proteome on complex diseases</a>. <em>Nature Genetics</em> <strong>52</strong>, 1122â€“1131 (2020).</div>
</div>
<div id="ref-dt18" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Dimou, N. L. &amp; Tsilidis, K. K. A primer in mendelian randomization methodology with a focus on utilizing published summary association data. in <em>Genetic epidemiology: Methods and protocols</em> (ed. Evangelou, E.) 211â€“230 (Springer Science+Business Media, LLC, part of Springer Nature, 2018).</div>
</div>
<div id="ref-sun18" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Sun, B. B. <em>et al.</em> <a href="https://doi.org/10.1038/s41586-018-0175-2" class="external-link">Genomic atlas of the human plasma proteome</a>. <em>Nature</em> <strong>558</strong>, 73â€“79 (2018).</div>
</div>
<div id="ref-suhre20" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Suhre, K., McCarthy, M. I. &amp; Schwenk, J. M. Genetics meets proteomics: Perspectives for large population-based studies. <em>Nat Rev Genet</em> (2020) doi:<a href="https://doi.org/10.1038/s41576-020-0268-2" class="external-link">10.1038/s41576-020-0268-2</a>.</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Crafted by <a href="https://jinghuazhao.github.io/" class="external-link"><img src="https://jinghuazhao.github.io/bees.svg" width="24"> Jing Hua Zhao</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
