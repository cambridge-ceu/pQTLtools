<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bioconductor notes • pQTLtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bioconductor notes">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pQTLtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Vignettes:</h6></li>
    <li><a class="dropdown-item" href="../articles/pQTLtools.html">An overview of pQTLtools</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Articles:</h6></li>
    <li><a class="dropdown-item" href="../articles/bioconductor.html">Bioconductor notes</a></li>
    <li><a class="dropdown-item" href="../articles/LocusZoom.js.html">LocusZoom.js</a></li>
    <li><a class="dropdown-item" href="../articles/snakemake.html">snakemake showcases</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/pQTLtools.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jinghuazhao/pQTLtools" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://jinghuazhao.github.io/R/" aria-label="R packages"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://alphafold.ebi.ac.uk/" aria-label="AlphaFold"><span class="fa fas fa-fast-backward"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-urls" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">URLs</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-urls">
<li><a class="external-link dropdown-item" href="https://alphafold.ebi.ac.uk/">AlphaFold</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/Bioconductor">Bioconductor</a></li>
    <li><a class="external-link dropdown-item" href="https://biorender.com/">BioRender</a></li>
    <li><a class="external-link dropdown-item" href="https://cran.r-project.org/">CRAN</a></li>
    <li><a class="external-link dropdown-item" href="https://cytoscape.org/">Cytoscape</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ensembl.org/">Ensembl</a></li>
    <li><a class="external-link dropdown-item" href="https://esmatlas.com/">ESMfold</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ebi.ac.uk/eqtl/">eQTL catalog</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ebi.ac.uk/gwas/">GWAS catalog</a></li>
    <li><a class="external-link dropdown-item" href="https://www.histo.fyi/">histo.fyi</a></li>
    <li><a class="external-link dropdown-item" href="https://metascape.org/">metascape</a></li>
    <li><a class="external-link dropdown-item" href="https://ligand-discovery.ai/">Ligand discovery</a></li>
    <li><a class="external-link dropdown-item" href="https://www.mrbase.org/">MRBase</a></li>
    <li><a class="external-link dropdown-item" href="https://www.proteomicsdb.org/">ProteomicsDB</a></li>
    <li><a class="external-link dropdown-item" href="https://pubmed.ncbi.nlm.nih.gov/">PubMed</a></li>
    <li><a class="external-link dropdown-item" href="https://string-db.org/">STRING</a></li>
    <li><a class="external-link dropdown-item" href="https://www.proteinatlas.org/">The Human Protein Atlas</a></li>
    <li><a class="external-link dropdown-item" href="https://www.uniprot.org/">UniProt</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.uniprot.org/" aria-label="UniProt"><span class="fa fas fa-fast-forward"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Bioconductor notes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jinghuazhao/pQTLtools/blob/HEAD/vignettes/bioconductor.Rmd" class="external-link"><code>vignettes/bioconductor.Rmd</code></a></small>
      <div class="d-none name"><code>bioconductor.Rmd</code></div>
    </div>

    
    
<p>This article collects notes on Bioconductor packages, made available here to faciliate their use and extensions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AnnotationDbi"</span>, <span class="st">"AnnotationFilter"</span>, <span class="st">"ComplexHeatmap"</span>, <span class="st">"DESeq2"</span>, <span class="st">"EnsDb.Hsapiens.v86"</span>,</span>
<span>          <span class="st">"FlowSorted.DLPFC.450k"</span>, <span class="st">"GeneNet"</span>, <span class="st">"GenomicFeatures"</span>, <span class="st">"IlluminaHumanMethylation450kmanifest"</span>,</span>
<span>          <span class="st">"OUTRIDER"</span>,<span class="st">"RColorBrewer"</span>, <span class="st">"RMariaDB"</span>, <span class="st">"Rgraphviz"</span>, <span class="st">"S4Vectors"</span>, <span class="st">"SummarizedExperiment"</span>,</span>
<span>          <span class="st">"TxDb.Hsapiens.UCSC.hg38.knownGene"</span>, <span class="st">"bladderbatch"</span>, <span class="st">"clusterProfiler"</span>,</span>
<span>          <span class="st">"corpcor"</span>, <span class="st">"doParallel"</span>, <span class="st">"ensembldb"</span>, <span class="st">"fdrtool"</span>, <span class="st">"graph"</span>, <span class="st">"graphite"</span>, <span class="st">"heatmaply"</span>,</span>
<span>          <span class="st">"minfi"</span>, <span class="st">"org.Hs.eg.db"</span>, <span class="st">"plyr"</span>, <span class="st">"quantro"</span>, <span class="st">"recount3"</span>, <span class="st">"sva"</span><span class="op">)</span></span>
<span><span class="va">es_pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biobase"</span>, <span class="st">"arrayQualityMetrics"</span>, <span class="st">"dplyr"</span>, <span class="st">"knitr"</span>, <span class="st">"mclust"</span>, <span class="st">"pQTLtools"</span>, <span class="st">"rgl"</span>, <span class="st">"scatterplot3d"</span><span class="op">)</span></span>
<span><span class="va">se_pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BiocGenerics"</span>,<span class="st">"GenomicRanges"</span>,<span class="st">"IRanges"</span>,<span class="st">"MsCoreUtils"</span>,<span class="st">"SummarizedExperiment"</span>,<span class="st">"impute"</span><span class="op">)</span></span>
<span><span class="va">sp_pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Biostrings"</span>, <span class="st">"CAMERA"</span>, <span class="st">"MSnbase"</span>, <span class="st">"MSstats"</span>, <span class="st">"Spectra"</span>, <span class="st">"mzR"</span>, <span class="st">"protViz"</span>, <span class="st">"rawrr"</span><span class="op">)</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">es_pkgs</span>,<span class="va">se_pkgs</span>,<span class="va">sp_pkgs</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="va">pkgs</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"^package:"</span>, <span class="va">p</span>, <span class="st">"$"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/search.html" class="external-link">search</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"This vignette needs package `"</span>, <span class="va">p</span>, <span class="st">"'; please install"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2" number="1">
<h2 id="liftover">
<span class="header-section-number">1</span> liftover<a class="anchor" aria-label="anchor" href="#liftover"></a>
</h2>
<p>See <code>inst/turboman</code>in the source, <a href="https://github.com/jinghuazhao/pQTLtools/tree/master/inst/turboman" class="external-link uri">https://github.com/jinghuazhao/pQTLtools/tree/master/inst/turboman</a>, or <code>turboman/</code> directory in the installed package.</p>
</div>
<div class="section level2" number="2">
<h2 id="expressionset">
<span class="header-section-number">2</span> ExpressionSet<a class="anchor" aria-label="anchor" href="#expressionset"></a>
</h2>
<p>We start with Bioconductor/Biobase’s ExpressionSet example and finish with a real application.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataDirectory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"Biobase"</span><span class="op">)</span></span>
<span><span class="va">exprsFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDirectory</span>, <span class="st">"exprsData.txt"</span><span class="op">)</span></span>
<span><span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">exprsFile</span>, header<span class="op">=</span><span class="cn">TRUE</span>, sep<span class="op">=</span><span class="st">"\t"</span>, row.names<span class="op">=</span><span class="fl">1</span>, as.is<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pDataFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dataDirectory</span>, <span class="st">"pData.txt"</span><span class="op">)</span></span>
<span><span class="va">pData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">pDataFile</span>, row.names<span class="op">=</span><span class="fl">1</span>, header<span class="op">=</span><span class="cn">TRUE</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">pData</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">exprs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>labelDescription<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Patient gender"</span>,</span>
<span>                                          <span class="st">"Case/control status"</span>,</span>
<span>                                          <span class="st">"Tumor progress on XYZ scale"</span><span class="op">)</span>,</span>
<span>                       row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"type"</span>, <span class="st">"score"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phenoData</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/class.AnnotatedDataFrame.html" class="external-link">AnnotatedDataFrame</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">pData</span>, varMetadata<span class="op">=</span><span class="va">metadata</span><span class="op">)</span></span>
<span><span class="va">experimentData</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/class.MIAME.html" class="external-link">MIAME</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Pierre Fermat"</span>,</span>
<span>                                 lab<span class="op">=</span><span class="st">"Francis Galton Lab"</span>,</span>
<span>                                 contact<span class="op">=</span><span class="st">"pfermat@lab.not.exist"</span>,</span>
<span>                                 title<span class="op">=</span><span class="st">"Smoking-Cancer Experiment"</span>,</span>
<span>                                 abstract<span class="op">=</span><span class="st">"An example ExpressionSet"</span>,</span>
<span>                                 url<span class="op">=</span><span class="st">"www.lab.not.exist"</span>,</span>
<span>                                 other<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>notes<span class="op">=</span><span class="st">"Created from text files"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exampleSet</span> <span class="op">&lt;-</span> <span class="fu">pQTLtools</span><span class="fu">::</span><span class="fu"><a href="../reference/make_ExpressionSet.html">make_ExpressionSet</a></span><span class="op">(</span><span class="va">exprs</span>,<span class="va">phenoData</span>,experimentData<span class="op">=</span><span class="va">experimentData</span>,</span>
<span>                                            annotation<span class="op">=</span><span class="st">"hgu95av2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample.ExpressionSet</span>, package<span class="op">=</span><span class="st">"Biobase"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">exampleSet</span>,<span class="va">sample.ExpressionSet</span><span class="op">)</span></span></code></pre></div>
<div class="section level3" number="2.1">
<h3 id="data-frame">
<span class="header-section-number">2.1</span> data.frame<a class="anchor" aria-label="anchor" href="#data-frame"></a>
</h3>
<p>The great benefit is to use the object directly as a data.frame.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm.result</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/esApply.html" class="external-link">esApply</a></span><span class="op">(</span><span class="va">exampleSet</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">score</span><span class="op">~</span><span class="va">gender</span><span class="op">+</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">lm.result</span>,<span class="va">coef</span><span class="op">)</span>,<span class="st">"["</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">beta.x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; AFFX-MurIL2_at.x </span></span>
<span><span class="co">#&gt;    -0.0001907472</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">score</span><span class="op">~</span><span class="va">gender</span><span class="op">+</span><span class="va">AFFX.MurIL2_at</span>,data<span class="op">=</span><span class="va">exampleSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = score ~ gender + AFFX.MurIL2_at, data = exampleSet)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;    (Intercept)      genderMale  AFFX.MurIL2_at  </span></span>
<span><span class="co">#&gt;      0.5531725       0.0098932      -0.0001907</span></span></code></pre></div>
</div>
<div class="section level3" number="2.2">
<h3 id="composite-plots">
<span class="header-section-number">2.2</span> Composite plots<a class="anchor" aria-label="anchor" href="#composite-plots"></a>
</h3>
<p>We wish to examine the distribution of each feature via histogram, scatter and boxplot.
One could resort to <code><a href="https://rdrr.io/pkg/Biobase/man/esApply.html" class="external-link">esApply()</a></code> for its simplicity as before</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/esApply.html" class="external-link">esApply</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">1</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>                           <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>but it is nicer to add feature name in the title.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html" class="external-link">featureNames</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">f</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>                     <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>                     <span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html" class="external-link">featureNames</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">d</span>,main<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="va">fn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d</span>, ylab<span class="op">=</span><span class="va">fn</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">d</span>,ylab<span class="op">=</span><span class="va">fn</span><span class="op">)</span></span>
<span>                   <span class="op">}</span></span>
<span>          <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plots-1"></span>
<img src="bioconductor/plots-1.png" alt="Histogram, scatter &amp; boxplots" width="672" style="display:block; margin: auto"><p class="caption">
Figure 2.1: Histogram, scatter &amp; boxplots
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plots-2"></span>
<img src="bioconductor/plots-2.png" alt="Histogram, scatter &amp; boxplots" width="672" style="display:block; margin: auto"><p class="caption">
Figure 2.2: Histogram, scatter &amp; boxplots
</p>
</div>
<p>where the expression set is indexed using feature name(s).</p>
</div>
<div class="section level3" number="2.3">
<h3 id="outlier-detections">
<span class="header-section-number">2.3</span> Outlier detections<a class="anchor" aria-label="anchor" href="#outlier-detections"></a>
</h3>
<p>This illustrates one mechanism,</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_outliers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">es</span>, <span class="va">method</span><span class="op">=</span><span class="st">"upperquartile"</span><span class="op">)</span></span>
<span>                 <span class="fu">arrayQualityMetrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arrayQualityMetrics/man/outliers.html" class="external-link">outliers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span>,method<span class="op">=</span><span class="va">method</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KS"</span>,<span class="st">"sum"</span>,<span class="st">"upperquartile"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">ZWK_outliers</span> <span class="op">&lt;-</span> <span class="fu">list_outliers</span><span class="op">(</span><span class="va">protein_ZWK</span>,method<span class="op">=</span><span class="va">method</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ZWK_outliers</span><span class="op">@</span><span class="va">statistic</span><span class="op">[</span><span class="va">ZWK_outliers</span><span class="op">@</span><span class="va">which</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3" number="2.4">
<h3 id="clustering">
<span class="header-section-number">2.4</span> Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h3>
<p>We employ model-based clustering absed on principal compoents to see potential groupings in the data,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, rank<span class="op">=</span><span class="fl">10</span>, scale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">pc1pc2pc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">x</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu">mclust</span><span class="fu">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></span><span class="op">(</span><span class="va">pc1pc2pc3</span>,G<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mc</span>, <span class="op">{</span></span>
<span>      <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span>, <span class="st">"purple"</span><span class="op">)</span></span>
<span>      <span class="va">s3d</span> <span class="op">&lt;-</span> <span class="fu">scatterplot3d</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scatterplot3d/man/scatterplot3d.html" class="external-link">scatterplot3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                          color<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">classification</span><span class="op">]</span>,</span>
<span>                                          pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>                                          type<span class="op">=</span><span class="st">"h"</span>,</span>
<span>                                          main<span class="op">=</span><span class="st">"Plot of the PC1, PC2 and PC3"</span><span class="op">)</span></span>
<span>      <span class="va">s3d.coords</span> <span class="op">&lt;-</span> <span class="va">s3d</span><span class="op">$</span><span class="fu">xyz.convert</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">s3d.coords</span><span class="op">$</span><span class="va">x</span>, </span>
<span>           <span class="va">s3d.coords</span><span class="op">$</span><span class="va">y</span>,   </span>
<span>           cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>           col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">classification</span><span class="op">]</span>,</span>
<span>           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">pc1pc2pc3</span><span class="op">)</span>,</span>
<span>           pos <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">classification</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">classification</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span>      <span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html" class="external-link">open3d</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">500</span>, height <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span>      <span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1.2</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">classification</span><span class="op">]</span>,size<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span>      <span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/texts.html" class="external-link">text3d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pca</span>,<span class="va">x</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1.2</span>,col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">classification</span><span class="op">]</span>,texts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">pc1pc2pc3</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu">htmlwidgets</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmlwidgets/man/saveWidget.html" class="external-link">saveWidget</a></span><span class="op">(</span><span class="fu">rgl</span><span class="fu">::</span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rglwidget.html" class="external-link">rglwidget</a></span><span class="op">(</span><span class="op">)</span>, file <span class="op">=</span> <span class="st">"mcpca3d.html"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mcpca"></span>
<img src="bioconductor/mcpca-1.png" alt="Three-group Clustering" width="672" style="display:block; margin: auto"><p class="caption">
Figure 2.3: Three-group Clustering
</p>
</div>
<pre><code><span><span class="co">#&gt; Warning in par3d(userMatrix = structure(c(1, 0, 0, 0, 0, 0.342020143325668, :</span></span>
<span><span class="co">#&gt; parameter "width" cannot be set</span></span>
<span><span class="co">#&gt; Warning in par3d(userMatrix = structure(c(1, 0, 0, 0, 0, 0.342020143325668, :</span></span>
<span><span class="co">#&gt; parameter "height" cannot be set</span></span></code></pre>
<p>An interactive version is also available,</p>
<iframe src="mcpca3d.html" width="100%" height="450px"></iframe>
</div>
<div class="section level3" number="2.5">
<h3 id="data-transformation">
<span class="header-section-number">2.5</span> Data transformation<a class="anchor" aria-label="anchor" href="#data-transformation"></a>
</h3>
<p>Suppose we wish use log2 for those greater than zero but set those negative values to be missing.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log2.na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span>, <span class="va">x</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">log2.na</span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3" number="2.6">
<h3 id="limit-of-detection-lod">
<span class="header-section-number">2.6</span> Limit of detection (LOD)<a class="anchor" aria-label="anchor" href="#limit-of-detection-lod"></a>
</h3>
<p>We generate a <code>lod.max</code> ~ U[0,1] variable to experiment</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span></span>
<span><span class="co">#&gt; data frame with 0 columns and 500 rows</span></span>
<span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span><span class="op">$</span><span class="va">lod.max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span>,<span class="fl">1</span>,<span class="va">quantile</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lod</span> <span class="op">&lt;-</span> <span class="fu">pQTLtools</span><span class="fu">::</span><span class="fu"><a href="../reference/get.prop.below.LLOD.html">get.prop.below.LLOD</a></span><span class="op">(</span><span class="va">exampleSet</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">lod</span><span class="op">)</span>,<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">pc.belowLOD.new</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lod</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="2%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="13%">
<col width="6%">
<col width="6%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">AFFX.MurIL2_at</th>
<th align="right">AFFX.MurIL10_at</th>
<th align="right">AFFX.MurIL4_at</th>
<th align="right">AFFX.MurFAS_at</th>
<th align="right">AFFX.BioB.5_at</th>
<th align="right">AFFX.BioB.M_at</th>
<th align="left">gender</th>
<th align="left">type</th>
<th align="right">score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">192.7420</td>
<td align="right">97.13700</td>
<td align="right">45.81920</td>
<td align="right">22.54450</td>
<td align="right">96.7875</td>
<td align="right">89.0730</td>
<td align="left">Female</td>
<td align="left">Control</td>
<td align="right">0.75</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">85.7533</td>
<td align="right">126.19600</td>
<td align="right">8.83135</td>
<td align="right">3.60093</td>
<td align="right">30.4380</td>
<td align="right">25.8461</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">176.7570</td>
<td align="right">77.92160</td>
<td align="right">33.06320</td>
<td align="right">14.68830</td>
<td align="right">46.1271</td>
<td align="right">57.2033</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.73</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">135.5750</td>
<td align="right">93.37130</td>
<td align="right">28.70720</td>
<td align="right">12.33970</td>
<td align="right">70.9319</td>
<td align="right">69.9766</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">64.4939</td>
<td align="right">24.39860</td>
<td align="right">5.94492</td>
<td align="right">36.86630</td>
<td align="right">56.1744</td>
<td align="right">49.5822</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.93</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="right">76.3569</td>
<td align="right">85.50880</td>
<td align="right">28.29250</td>
<td align="right">11.25680</td>
<td align="right">42.6756</td>
<td align="right">26.1262</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.22</td>
</tr>
<tr class="odd">
<td align="left">G</td>
<td align="right">160.5050</td>
<td align="right">98.90860</td>
<td align="right">30.96940</td>
<td align="right">23.00340</td>
<td align="right">86.5156</td>
<td align="right">75.0083</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">H</td>
<td align="right">65.9631</td>
<td align="right">81.69320</td>
<td align="right">14.79230</td>
<td align="right">16.21340</td>
<td align="right">30.7927</td>
<td align="right">42.3352</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.79</td>
</tr>
<tr class="odd">
<td align="left">I</td>
<td align="right">56.9039</td>
<td align="right">97.80150</td>
<td align="right">14.23990</td>
<td align="right">12.03750</td>
<td align="right">19.7183</td>
<td align="right">41.1207</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">J</td>
<td align="right">135.6080</td>
<td align="right">90.48380</td>
<td align="right">34.48740</td>
<td align="right">4.54978</td>
<td align="right">46.3520</td>
<td align="right">91.5307</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="left">K</td>
<td align="right">63.4432</td>
<td align="right">70.57330</td>
<td align="right">20.35210</td>
<td align="right">8.51782</td>
<td align="right">39.1326</td>
<td align="right">39.9136</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="left">L</td>
<td align="right">78.2126</td>
<td align="right">94.54180</td>
<td align="right">14.15540</td>
<td align="right">27.28520</td>
<td align="right">41.7698</td>
<td align="right">49.8397</td>
<td align="left">Female</td>
<td align="left">Control</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">M</td>
<td align="right">83.0943</td>
<td align="right">75.34550</td>
<td align="right">20.62510</td>
<td align="right">10.16160</td>
<td align="right">80.2197</td>
<td align="right">63.4794</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.41</td>
</tr>
<tr class="even">
<td align="left">N</td>
<td align="right">89.3372</td>
<td align="right">68.58270</td>
<td align="right">15.92310</td>
<td align="right">20.24880</td>
<td align="right">36.4903</td>
<td align="right">24.7007</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.80</td>
</tr>
<tr class="odd">
<td align="left">O</td>
<td align="right">91.0615</td>
<td align="right">87.40500</td>
<td align="right">20.15790</td>
<td align="right">15.78490</td>
<td align="right">36.4021</td>
<td align="right">47.4641</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">P</td>
<td align="right">95.9377</td>
<td align="right">84.45810</td>
<td align="right">27.81390</td>
<td align="right">14.32760</td>
<td align="right">35.3054</td>
<td align="right">47.3578</td>
<td align="left">Female</td>
<td align="left">Control</td>
<td align="right">0.41</td>
</tr>
<tr class="odd">
<td align="left">Q</td>
<td align="right">179.8450</td>
<td align="right">87.68060</td>
<td align="right">32.79110</td>
<td align="right">15.94880</td>
<td align="right">58.6239</td>
<td align="right">58.1331</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.16</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="right">152.4670</td>
<td align="right">108.03200</td>
<td align="right">33.52920</td>
<td align="right">14.67530</td>
<td align="right">114.0620</td>
<td align="right">104.1220</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.72</td>
</tr>
<tr class="odd">
<td align="left">S</td>
<td align="right">180.8340</td>
<td align="right">134.26300</td>
<td align="right">19.81720</td>
<td align="right">-7.91911</td>
<td align="right">93.4402</td>
<td align="right">115.8310</td>
<td align="left">Male</td>
<td align="left">Case</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">T</td>
<td align="right">85.4146</td>
<td align="right">91.40310</td>
<td align="right">20.41900</td>
<td align="right">12.88750</td>
<td align="right">22.5168</td>
<td align="right">58.1224</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.74</td>
</tr>
<tr class="odd">
<td align="left">U</td>
<td align="right">157.9890</td>
<td align="right">-8.68811</td>
<td align="right">26.87200</td>
<td align="right">11.91860</td>
<td align="right">48.6462</td>
<td align="right">73.4221</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.35</td>
</tr>
<tr class="even">
<td align="left">V</td>
<td align="right">146.8000</td>
<td align="right">85.02120</td>
<td align="right">31.14880</td>
<td align="right">12.83240</td>
<td align="right">90.2215</td>
<td align="right">64.6066</td>
<td align="left">Female</td>
<td align="left">Control</td>
<td align="right">0.77</td>
</tr>
<tr class="odd">
<td align="left">W</td>
<td align="right">93.8829</td>
<td align="right">79.29980</td>
<td align="right">22.34200</td>
<td align="right">11.13900</td>
<td align="right">42.0053</td>
<td align="right">40.3068</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.27</td>
</tr>
<tr class="even">
<td align="left">X</td>
<td align="right">103.8550</td>
<td align="right">71.65520</td>
<td align="right">19.01350</td>
<td align="right">7.55564</td>
<td align="right">57.5738</td>
<td align="right">41.8209</td>
<td align="left">Male</td>
<td align="left">Control</td>
<td align="right">0.98</td>
</tr>
<tr class="odd">
<td align="left">Y</td>
<td align="right">64.4340</td>
<td align="right">64.23690</td>
<td align="right">12.16860</td>
<td align="right">19.98490</td>
<td align="right">44.8216</td>
<td align="right">46.1087</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.94</td>
</tr>
<tr class="even">
<td align="left">Z</td>
<td align="right">175.6150</td>
<td align="right">78.70680</td>
<td align="right">17.37800</td>
<td align="right">8.96849</td>
<td align="right">61.7044</td>
<td align="right">49.4122</td>
<td align="left">Female</td>
<td align="left">Case</td>
<td align="right">0.32</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, main<span class="op">=</span><span class="st">"Random quantile cutoff"</span>, ylab<span class="op">=</span><span class="st">"&lt;lod%"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lod"></span>
<img src="bioconductor/lod-1.png" alt="LOD based on a random cutoff" width="672" style="display:block; margin: auto"><p class="caption">
Figure 2.4: LOD based on a random cutoff
</p>
</div>
<p>The quantity has been shown to have a big impact on protein abundance and therefore pQTL detection as is shown with a real example.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="st">"~/rds/post_qc_data/interval/phenotype/olink_proteomics/post-qc/"</span></span>
<span><span class="va">eset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dir</span>,<span class="st">"eset.inf1.flag.out.outlier.in.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">pQTLtools</span><span class="fu">::</span><span class="fu"><a href="../reference/get.prop.below.LLOD.html">get.prop.below.LLOD</a></span><span class="op">(</span><span class="va">eset</span><span class="op">)</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html" class="external-link">fData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">MissDataProp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\%$"</span>, <span class="st">""</span>, <span class="va">annot</span><span class="op">$</span><span class="va">MissDataProp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">annot</span><span class="op">$</span><span class="va">MissDataProp</span>, <span class="va">annot</span><span class="op">$</span><span class="va">pc.belowLOD.new</span>, xlab<span class="op">=</span><span class="st">"% &lt;LLOD in Original"</span>,</span>
<span>     ylab<span class="op">=</span><span class="st">"% &lt;LLOD in post QC dataset"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">INF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"INF"</span><span class="op">)</span></span>
<span><span class="va">np</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">INF</span>, <span class="st">"work"</span>, <span class="st">"INF1.merge.nosig"</span>, sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                 col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>, <span class="st">"uniprot"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">np</span>, caption<span class="op">=</span><span class="st">"Proteins with no pQTL"</span><span class="op">)</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">pQTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">no.pQTL.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">annot</span><span class="op">$</span><span class="va">uniprot.id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">np</span><span class="op">$</span><span class="va">uniprot</span><span class="op">)</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">pQTL</span><span class="op">[</span><span class="va">no.pQTL.ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span><span class="va">annot</span><span class="op">$</span><span class="va">pQTL</span><span class="op">[</span><span class="op">-</span><span class="va">no.pQTL.ind</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"blue"</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="va">annot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">annot</span><span class="op">$</span><span class="va">pc.belowLOD.new</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="va">annot</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^BDNF$"</span>, <span class="va">annot</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">annot</span>,file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="st">"pQTLtools"</span>,<span class="st">"tests"</span>,<span class="st">"annot.RDS"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">find.package</a></span><span class="op">(</span><span class="st">"pQTLtools"</span><span class="op">)</span>,<span class="st">"tests"</span>,<span class="st">"annot.RDS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">pQTLdata</span><span class="fu">::</span><span class="va"><a href="https://jinghuazhao.github.io/pQTLdata/reference/inf1.html" class="external-link">inf1</a></span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prot"</span>,<span class="st">"target.short"</span>,<span class="st">"alt_name"</span><span class="op">)</span><span class="op">]</span>,by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">=</span><span class="st">"prot"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prot<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">alt_name</span><span class="op">)</span>,<span class="va">target.short</span>,<span class="va">alt_name</span><span class="op">)</span>,order<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">order</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xtick</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">100</span><span class="op">-</span><span class="va">pc.belowLOD.new</span>,cex<span class="op">=</span><span class="fl">2</span>,pch<span class="op">=</span><span class="fl">19</span>,col<span class="op">=</span><span class="va">pQTL</span>,xaxt<span class="op">=</span><span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,cex.axis<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">66</span>,<span class="fl">16</span>,<span class="st">"IL-17C"</span>,offset<span class="op">=</span><span class="fl">0</span>,pos<span class="op">=</span><span class="fl">2</span>,cex<span class="op">=</span><span class="fl">1.5</span>,font<span class="op">=</span><span class="fl">2</span>,srt<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="fl">67</span>,<span class="fl">16</span>,<span class="fl">71</span>,<span class="fl">16</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="va">xtick</span>, labels<span class="op">=</span><span class="va">prot</span>, lwd.tick<span class="op">=</span><span class="fl">0.5</span>, lwd<span class="op">=</span><span class="fl">0</span>, las<span class="op">=</span><span class="fl">2</span>, hadj<span class="op">=</span><span class="fl">1</span>, cex.axis<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"% samples above LLOD"</span>,side<span class="op">=</span><span class="fl">2</span>,line<span class="op">=</span><span class="fl">2.5</span>,cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Ordered protein"</span>,side<span class="op">=</span><span class="fl">1</span>,line<span class="op">=</span><span class="fl">6.5</span>,cex<span class="op">=</span><span class="fl">1.2</span>,font<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span>,y<span class="op">=</span><span class="fl">25</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"without pQTL"</span>,<span class="st">"with pQTL"</span><span class="op">)</span>,box.lwd<span class="op">=</span><span class="fl">0</span>,cex<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"blue"</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:test"></span>
<img src="bioconductor/test-1.png" alt="LOD in SCALLOP-INF/INTERVAL" width="1440" style="display:block; margin: auto"><p class="caption">
Figure 2.5: LOD in SCALLOP-INF/INTERVAL
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="va">annot</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">annot</span>,caption<span class="op">=</span><span class="st">"Summary statistics"</span>,row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
<span id="tab:test">Table 2.1: </span>Summary statistics</caption>
<colgroup>
<col width="10%">
<col width="5%">
<col width="13%">
<col width="7%">
<col width="5%">
<col width="9%">
<col width="11%">
<col width="3%">
<col width="10%">
<col width="6%">
<col width="10%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">ID</th>
<th align="left">dichot</th>
<th align="left">olink.id</th>
<th align="left">uniprot.id</th>
<th align="right">lod.max</th>
<th align="right">MissDataProp</th>
<th align="right">pc.belowLOD.new</th>
<th align="left">pQTL</th>
<th align="left">target.short</th>
<th align="left">alt_name</th>
<th align="left">prot</th>
<th align="right">order</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CSF.1</td>
<td align="left">FALSE</td>
<td align="left">196_CSF-1</td>
<td align="left">P09603</td>
<td align="right">1.02</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CSF-1</td>
<td align="left">NA</td>
<td align="left">CSF-1</td>
<td align="right">91</td>
</tr>
<tr class="even">
<td align="left">TNFB</td>
<td align="left">FALSE</td>
<td align="left">195_TNFB</td>
<td align="left">P01374</td>
<td align="right">1.10</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TNFB</td>
<td align="left">NA</td>
<td align="left">TNFB</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="left">ADA</td>
<td align="left">FALSE</td>
<td align="left">194_ADA</td>
<td align="left">P00813</td>
<td align="right">1.80</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">ADA</td>
<td align="left">NA</td>
<td align="left">ADA</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="left">STAMPB</td>
<td align="left">FALSE</td>
<td align="left">192_STAMPB</td>
<td align="left">O95630</td>
<td align="right">1.40</td>
<td align="right">0.06</td>
<td align="right">0.0000000</td>
<td align="left">red</td>
<td align="left">STAMPB</td>
<td align="left">NA</td>
<td align="left">STAMPB</td>
<td align="right">88</td>
</tr>
<tr class="odd">
<td align="left">CCL20</td>
<td align="left">FALSE</td>
<td align="left">190_CCL20</td>
<td align="left">P78556</td>
<td align="right">1.42</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL20</td>
<td align="left">NA</td>
<td align="left">CCL20</td>
<td align="right">87</td>
</tr>
<tr class="even">
<td align="left">TWEAK</td>
<td align="left">FALSE</td>
<td align="left">189_TWEAK</td>
<td align="left">O43508</td>
<td align="right">1.78</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TWEAK</td>
<td align="left">NA</td>
<td align="left">TWEAK</td>
<td align="right">86</td>
</tr>
<tr class="odd">
<td align="left">TNFRSF9</td>
<td align="left">FALSE</td>
<td align="left">187_TNFRSF9</td>
<td align="left">Q07011</td>
<td align="right">1.86</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TNFRSF9</td>
<td align="left">NA</td>
<td align="left">TNFRSF9</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td align="left">CX3CL1</td>
<td align="left">FALSE</td>
<td align="left">186_CX3CL1</td>
<td align="left">P78423</td>
<td align="right">1.76</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CX3CL1</td>
<td align="left">NA</td>
<td align="left">CX3CL1</td>
<td align="right">84</td>
</tr>
<tr class="odd">
<td align="left">CCL25</td>
<td align="left">FALSE</td>
<td align="left">185_CCL25</td>
<td align="left">O15444</td>
<td align="right">1.32</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL25</td>
<td align="left">NA</td>
<td align="left">CCL25</td>
<td align="right">83</td>
</tr>
<tr class="even">
<td align="left">CASP.8</td>
<td align="left">FALSE</td>
<td align="left">184_CASP-8</td>
<td align="left">Q14790</td>
<td align="right">1.38</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CASP-8</td>
<td align="left">NA</td>
<td align="left">CASP-8</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="left">MCP.2</td>
<td align="left">FALSE</td>
<td align="left">183_MCP-2</td>
<td align="left">P80075</td>
<td align="right">2.10</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">MCP-2</td>
<td align="left">CCL8</td>
<td align="left">CCL8</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left">FGF.19</td>
<td align="left">FALSE</td>
<td align="left">179_FGF-19</td>
<td align="left">O95750</td>
<td align="right">1.25</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">FGF-19</td>
<td align="left">NA</td>
<td align="left">FGF-19</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">CD40</td>
<td align="left">FALSE</td>
<td align="left">176_CD40</td>
<td align="left">P25942</td>
<td align="right">1.91</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CD40</td>
<td align="left">NA</td>
<td align="left">CD40</td>
<td align="right">79</td>
</tr>
<tr class="even">
<td align="left">DNER</td>
<td align="left">FALSE</td>
<td align="left">174_DNER</td>
<td align="left">Q8NFT8 </td>
<td align="right">1.63</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">DNER</td>
<td align="left">NA</td>
<td align="left">DNER</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="left">4E.BP1</td>
<td align="left">FALSE</td>
<td align="left">170_4E-BP1</td>
<td align="left">Q13541</td>
<td align="right">1.04</td>
<td align="right">0.10</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">4EBP1</td>
<td align="left">NA</td>
<td align="left">4EBP1</td>
<td align="right">77</td>
</tr>
<tr class="even">
<td align="left">CXCL10</td>
<td align="left">FALSE</td>
<td align="left">169_CXCL10</td>
<td align="left">P02778</td>
<td align="right">2.03</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL10</td>
<td align="left">NA</td>
<td align="left">CXCL10</td>
<td align="right">76</td>
</tr>
<tr class="odd">
<td align="left">CXCL6</td>
<td align="left">FALSE</td>
<td align="left">168_CXCL6</td>
<td align="left">P80162</td>
<td align="right">1.80</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL6</td>
<td align="left">CXCL6</td>
<td align="left">CXCL6</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="left">Flt3L</td>
<td align="left">FALSE</td>
<td align="left">167_Flt3L</td>
<td align="left">P49771</td>
<td align="right">2.12</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">FIt3L</td>
<td align="left">NA</td>
<td align="left">FIt3L</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td align="left">CD5</td>
<td align="left">FALSE</td>
<td align="left">165_CD5</td>
<td align="left">P06127</td>
<td align="right">1.42</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CD5</td>
<td align="left">NA</td>
<td align="left">CD5</td>
<td align="right">73</td>
</tr>
<tr class="even">
<td align="left">CCL23</td>
<td align="left">FALSE</td>
<td align="left">164_CCL23</td>
<td align="left">P55773</td>
<td align="right">2.10</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL23</td>
<td align="left">NA</td>
<td align="left">CCL23</td>
<td align="right">72</td>
</tr>
<tr class="odd">
<td align="left">MMP.10</td>
<td align="left">FALSE</td>
<td align="left">161_MMP-10</td>
<td align="left">P09238</td>
<td align="right">1.56</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">MMP-10</td>
<td align="left">NA</td>
<td align="left">MMP-10</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">IL.12B</td>
<td align="left">FALSE</td>
<td align="left">157_IL-12B</td>
<td align="left">P29460</td>
<td align="right">0.85</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">IL-12B</td>
<td align="left">NA</td>
<td align="left">IL-12B</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="left">HGF</td>
<td align="left">FALSE</td>
<td align="left">156_HGF</td>
<td align="left">P14210</td>
<td align="right">1.77</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">HGF</td>
<td align="left">NA</td>
<td align="left">HGF</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="left">TRANCE</td>
<td align="left">FALSE</td>
<td align="left">155_TRANCE</td>
<td align="left">O14788</td>
<td align="right">1.51</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TRANCE</td>
<td align="left">NA</td>
<td align="left">TRANCE</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="left">CXCL5</td>
<td align="left">FALSE</td>
<td align="left">154_CXCL5</td>
<td align="left">P42830</td>
<td align="right">1.92</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL5</td>
<td align="left">NA</td>
<td align="left">CXCL5</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="left">PD.L1</td>
<td align="left">FALSE</td>
<td align="left">152_PD-L1</td>
<td align="left">Q9NZQ7</td>
<td align="right">2.14</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">PD-L1</td>
<td align="left">NA</td>
<td align="left">PD-L1</td>
<td align="right">66</td>
</tr>
<tr class="odd">
<td align="left">IL.18R1</td>
<td align="left">FALSE</td>
<td align="left">151_IL-18R1</td>
<td align="left">Q13478</td>
<td align="right">1.21</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">IL-18R1</td>
<td align="left">NA</td>
<td align="left">IL-18R1</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td align="left">IL.10RB</td>
<td align="left">FALSE</td>
<td align="left">149_IL-10RB</td>
<td align="left">Q08334</td>
<td align="right">1.72</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">IL10RB</td>
<td align="left">NA</td>
<td align="left">IL10RB</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left">CCL19</td>
<td align="left">FALSE</td>
<td align="left">145_CCL19</td>
<td align="left">Q99731</td>
<td align="right">2.13</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL19</td>
<td align="left">NA</td>
<td align="left">CCL19</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="left">FGF.21</td>
<td align="left">FALSE</td>
<td align="left">144_FGF-21</td>
<td align="left">Q9NSA1</td>
<td align="right">1.14</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">FGF-21</td>
<td align="left">NA</td>
<td align="left">FGF-21</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="left">LIF.R</td>
<td align="left">FALSE</td>
<td align="left">143_LIF-R</td>
<td align="left">P42702</td>
<td align="right">2.08</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">LIF-R</td>
<td align="left">NA</td>
<td align="left">LIF-R</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td align="left">FGF.23</td>
<td align="left">FALSE</td>
<td align="left">139_FGF-23</td>
<td align="left">Q9GZV9</td>
<td align="right">0.66</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">FGF-23</td>
<td align="left">NA</td>
<td align="left">FGF-23</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="left">TNFSF14</td>
<td align="left">FALSE</td>
<td align="left">138_TNFSF14</td>
<td align="left">O43557</td>
<td align="right">1.81</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TNFSF14</td>
<td align="left">NA</td>
<td align="left">TNFSF14</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="left">CCL11</td>
<td align="left">FALSE</td>
<td align="left">137_CCL11</td>
<td align="left">P51671</td>
<td align="right">2.09</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL11</td>
<td align="left">CCL11</td>
<td align="left">CCL11</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="left">MCP.4</td>
<td align="left">FALSE</td>
<td align="left">136_MCP-4</td>
<td align="left">Q99616</td>
<td align="right">0.56</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">MCP-4</td>
<td align="left">CCL13</td>
<td align="left">CCL13</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="left">TGF.alpha</td>
<td align="left">FALSE</td>
<td align="left">135_TGF-alpha</td>
<td align="left">P01135</td>
<td align="right">0.07</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TGF-alpha</td>
<td align="left">NA</td>
<td align="left">TGF-alpha</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="left">IL.18</td>
<td align="left">FALSE</td>
<td align="left">133_IL-18</td>
<td align="left">Q14116</td>
<td align="right">2.79</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">IL-18</td>
<td align="left">NA</td>
<td align="left">IL-18</td>
<td align="right">55</td>
</tr>
<tr class="even">
<td align="left">SCF</td>
<td align="left">FALSE</td>
<td align="left">132_SCF</td>
<td align="left">P21583</td>
<td align="right">2.30</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">SCF</td>
<td align="left">NA</td>
<td align="left">SCF</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td align="left">CD6</td>
<td align="left">FALSE</td>
<td align="left">131_CD6</td>
<td align="left">Q8WWJ7</td>
<td align="right">1.78</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CD6</td>
<td align="left">NA</td>
<td align="left">CD6</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td align="left">CCL4</td>
<td align="left">FALSE</td>
<td align="left">130_CCL4</td>
<td align="left">P13236</td>
<td align="right">2.15</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CCL4</td>
<td align="left">NA</td>
<td align="left">CCL4</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="left">CXCL1</td>
<td align="left">FALSE</td>
<td align="left">128_CXCL1</td>
<td align="left">P09341</td>
<td align="right">3.45</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL1</td>
<td align="left">NA</td>
<td align="left">CXCL1</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="left">OSM</td>
<td align="left">FALSE</td>
<td align="left">126_OSM</td>
<td align="left">P13725</td>
<td align="right">1.32</td>
<td align="right">0.06</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">OSM</td>
<td align="left">NA</td>
<td align="left">OSM</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="left">CST5</td>
<td align="left">FALSE</td>
<td align="left">123_CST5</td>
<td align="left">P28325</td>
<td align="right">4.34</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CST5</td>
<td align="left">NA</td>
<td align="left">CST5</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="left">CXCL9</td>
<td align="left">FALSE</td>
<td align="left">122_CXCL9</td>
<td align="left">Q07325</td>
<td align="right">1.04</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL9</td>
<td align="left">NA</td>
<td align="left">CXCL9</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="left">TRAIL</td>
<td align="left">FALSE</td>
<td align="left">120_TRAIL</td>
<td align="left">P50591</td>
<td align="right">1.22</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">TRAIL</td>
<td align="left">NA</td>
<td align="left">TRAIL</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td align="left">CXCL11</td>
<td align="left">FALSE</td>
<td align="left">117_CXCL11</td>
<td align="left">O14625</td>
<td align="right">1.40</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CXCL11</td>
<td align="left">NA</td>
<td align="left">CXCL11</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="left">MCP.1</td>
<td align="left">FALSE</td>
<td align="left">115_MCP-1</td>
<td align="left">P13500</td>
<td align="right">1.90</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">MCP-1</td>
<td align="left">CCL2</td>
<td align="left">CCL2</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="left">uPA</td>
<td align="left">FALSE</td>
<td align="left">112_uPA</td>
<td align="left">P00749</td>
<td align="right">1.75</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">uPA</td>
<td align="left">NA</td>
<td align="left">uPA</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td align="left">LAP.TGF.beta.1</td>
<td align="left">FALSE</td>
<td align="left">111_LAP TGF-beta-1</td>
<td align="left">P01137</td>
<td align="right">0.86</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">LAP TGF-beta-1</td>
<td align="left">NA</td>
<td align="left">LAP TGF-beta-1</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td align="left">OPG</td>
<td align="left">FALSE</td>
<td align="left">110_OPG</td>
<td align="left">O00300</td>
<td align="right">1.81</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">OPG</td>
<td align="left">NA</td>
<td align="left">OPG</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left">CD244</td>
<td align="left">FALSE</td>
<td align="left">108_CD244</td>
<td align="left">Q9BZW8</td>
<td align="right">1.09</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CD244</td>
<td align="left">NA</td>
<td align="left">CD244</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="left">CDCP1</td>
<td align="left">FALSE</td>
<td align="left">107_CDCP1</td>
<td align="left">Q9H5V8</td>
<td align="right">0.21</td>
<td align="right">0.04</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">CDCP1</td>
<td align="left">NA</td>
<td align="left">CDCP1</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">VEGF.A</td>
<td align="left">FALSE</td>
<td align="left">102_VEGF-A</td>
<td align="left">P15692</td>
<td align="right">3.15</td>
<td align="right">0.02</td>
<td align="right">0.0000000</td>
<td align="left">blue</td>
<td align="left">VEGF_A</td>
<td align="left">NA</td>
<td align="left">VEGF_A</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">MIP.1.alpha</td>
<td align="left">FALSE</td>
<td align="left">166_MIP-1 alpha</td>
<td align="left">P10147</td>
<td align="right">1.92</td>
<td align="right">0.06</td>
<td align="right">0.0203998</td>
<td align="left">blue</td>
<td align="left">MIP-1 alpha</td>
<td align="left">NA</td>
<td align="left">MIP-1 alpha</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="left">MMP.1</td>
<td align="left">FALSE</td>
<td align="left">142_MMP-1</td>
<td align="left">P03956</td>
<td align="right">1.89</td>
<td align="right">0.06</td>
<td align="right">0.0407997</td>
<td align="left">blue</td>
<td align="left">MMP-1</td>
<td align="left">NA</td>
<td align="left">MMP-1</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="left">SIRT2</td>
<td align="left">FALSE</td>
<td align="left">172_SIRT2</td>
<td align="left">Q8IXJ6</td>
<td align="right">1.52</td>
<td align="right">1.00</td>
<td align="right">0.0815993</td>
<td align="left">blue</td>
<td align="left">SIRT2</td>
<td align="left">NA</td>
<td align="left">SIRT2</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left">IL.8</td>
<td align="left">FALSE</td>
<td align="left">101_IL-8</td>
<td align="left">P10145</td>
<td align="right">3.17</td>
<td align="right">0.25</td>
<td align="right">0.2447980</td>
<td align="left">blue</td>
<td align="left">IL-8</td>
<td align="left">NA</td>
<td align="left">IL-8</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">IL.7</td>
<td align="left">FALSE</td>
<td align="left">109_IL-7</td>
<td align="left">P13232</td>
<td align="right">1.39</td>
<td align="right">1.43</td>
<td align="right">0.7547940</td>
<td align="left">blue</td>
<td align="left">IL-7</td>
<td align="left">NA</td>
<td align="left">IL-7</td>
<td align="right">34</td>
</tr>
<tr class="odd">
<td align="left">SLAMF1</td>
<td align="left">FALSE</td>
<td align="left">134_SLAMF1</td>
<td align="left">Q13291</td>
<td align="right">1.55</td>
<td align="right">2.13</td>
<td align="right">1.5299878</td>
<td align="left">blue</td>
<td align="left">SLAMF1</td>
<td align="left">NA</td>
<td align="left">SLAMF1</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">EN.RAGE</td>
<td align="left">FALSE</td>
<td align="left">175_EN-RAGE</td>
<td align="left">P80511</td>
<td align="right">1.57</td>
<td align="right">3.28</td>
<td align="right">3.5291718</td>
<td align="left">blue</td>
<td align="left">EN-RAGE</td>
<td align="left">NA</td>
<td align="left">EN-RAGE</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td align="left">Beta.NGF</td>
<td align="left">FALSE</td>
<td align="left">153_Beta-NGF</td>
<td align="left">P01138</td>
<td align="right">1.23</td>
<td align="right">3.96</td>
<td align="right">4.2227662</td>
<td align="left">blue</td>
<td align="left">Beta-NGF</td>
<td align="left">NA</td>
<td align="left">Beta-NGF</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="left">CCL28</td>
<td align="left">FALSE</td>
<td align="left">173_CCL28</td>
<td align="left">Q9NRJ3</td>
<td align="right">0.92</td>
<td align="right">5.49</td>
<td align="right">5.2835577</td>
<td align="left">red</td>
<td align="left">CCL28</td>
<td align="left">NA</td>
<td align="left">CCL28</td>
<td align="right">30</td>
</tr>
<tr class="odd">
<td align="left">IL.10</td>
<td align="left">FALSE</td>
<td align="left">162_IL-10</td>
<td align="left">P22301</td>
<td align="right">1.50</td>
<td align="right">7.71</td>
<td align="right">7.0583435</td>
<td align="left">blue</td>
<td align="left">IL-10</td>
<td align="left">NA</td>
<td align="left">IL-10</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">AXIN1</td>
<td align="left">FALSE</td>
<td align="left">118_AXIN1</td>
<td align="left">O15169</td>
<td align="right">1.30</td>
<td align="right">13.04</td>
<td align="right">10.8731130</td>
<td align="left">red</td>
<td align="left">AXIN1</td>
<td align="left">NA</td>
<td align="left">AXIN1</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">NT.3</td>
<td align="left">FALSE</td>
<td align="left">188_NT-3</td>
<td align="left">P20783</td>
<td align="right">0.85</td>
<td align="right">12.77</td>
<td align="right">13.2394941</td>
<td align="left">blue</td>
<td align="left">NT-3</td>
<td align="left">NA</td>
<td align="left">NT-3</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">FGF.5</td>
<td align="left">FALSE</td>
<td align="left">141_FGF-5</td>
<td align="left">Q8NF90</td>
<td align="right">1.00</td>
<td align="right">31.71</td>
<td align="right">30.3957568</td>
<td align="left">blue</td>
<td align="left">FGF-5</td>
<td align="left">NA</td>
<td align="left">FGF-5</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">ST1A1</td>
<td align="left">FALSE</td>
<td align="left">191_ST1A1</td>
<td align="left">P50225</td>
<td align="right">1.34</td>
<td align="right">32.68</td>
<td align="right">31.2525500</td>
<td align="left">blue</td>
<td align="left">ST1A1</td>
<td align="left">NA</td>
<td align="left">ST1A1</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">GDNF</td>
<td align="left">FALSE</td>
<td align="left">106_GDNF</td>
<td align="left">P39905</td>
<td align="right">1.13</td>
<td align="right">43.26</td>
<td align="right">42.4520604</td>
<td align="left">blue</td>
<td align="left">hGDNF</td>
<td align="left">NA</td>
<td align="left">hGDNF</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="left">IL.10RA</td>
<td align="left">FALSE</td>
<td align="left">140_IL-10RA</td>
<td align="left">Q13651</td>
<td align="right">1.14</td>
<td align="right">53.30</td>
<td align="right">53.9779682</td>
<td align="left">red</td>
<td align="left">IL-10RA</td>
<td align="left">NA</td>
<td align="left">IL-10RA</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">IL.6</td>
<td align="left">FALSE</td>
<td align="left">113_IL-6</td>
<td align="left">P05231</td>
<td align="right">1.97</td>
<td align="right">69.06</td>
<td align="right">68.6250510</td>
<td align="left">blue</td>
<td align="left">IL-6</td>
<td align="left">NA</td>
<td align="left">IL-6</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">IL.5</td>
<td align="left">FALSE</td>
<td align="left">193_IL-5</td>
<td align="left">P05113</td>
<td align="right">1.55</td>
<td align="right">78.21</td>
<td align="right">77.8457772</td>
<td align="left">red</td>
<td align="left">IL-5</td>
<td align="left">NA</td>
<td align="left">IL-5</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">MCP.3</td>
<td align="left">FALSE</td>
<td align="left">105_MCP-3</td>
<td align="left">P80098</td>
<td align="right">1.31</td>
<td align="right">79.30</td>
<td align="right">79.0697674</td>
<td align="left">blue</td>
<td align="left">MCP-3</td>
<td align="left">CCL7</td>
<td align="left">CCL7</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">IL.17C</td>
<td align="left">FALSE</td>
<td align="left">114_IL-17C</td>
<td align="left">Q9P0M4</td>
<td align="right">1.28</td>
<td align="right">83.07</td>
<td align="right">83.3741330</td>
<td align="left">blue</td>
<td align="left">IL-17C</td>
<td align="left">NA</td>
<td align="left">IL-17C</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">IL.17A</td>
<td align="left">FALSE</td>
<td align="left">116_IL-17A</td>
<td align="left">Q16552</td>
<td align="right">0.97</td>
<td align="right">84.73</td>
<td align="right">84.7001224</td>
<td align="left">red</td>
<td align="left">IL-17A</td>
<td align="left">NA</td>
<td align="left">IL-17A</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="left">IL.4</td>
<td align="left">FALSE</td>
<td align="left">180_IL-4</td>
<td align="left">P05112</td>
<td align="right">1.11</td>
<td align="right">93.91</td>
<td align="right">94.4104447</td>
<td align="left">red</td>
<td align="left">IL-4</td>
<td align="left">NA</td>
<td align="left">IL-4</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">LIF</td>
<td align="left">FALSE</td>
<td align="left">181_LIF</td>
<td align="left">P15018</td>
<td align="right">1.45</td>
<td align="right">94.90</td>
<td align="right">94.8184415</td>
<td align="left">red</td>
<td align="left">LIF</td>
<td align="left">NA</td>
<td align="left">LIF</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">TNF</td>
<td align="left">FALSE</td>
<td align="left">163_TNF</td>
<td align="left">P01375</td>
<td align="right">1.19</td>
<td align="right">95.22</td>
<td align="right">95.1244390</td>
<td align="left">red</td>
<td align="left">TNF</td>
<td align="left">NA</td>
<td align="left">TNF</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="left">IL.20RA</td>
<td align="left">FALSE</td>
<td align="left">121_IL-20RA</td>
<td align="left">Q9UHF4</td>
<td align="right">0.79</td>
<td align="right">95.16</td>
<td align="right">95.7772338</td>
<td align="left">red</td>
<td align="left">IL-20RA</td>
<td align="left">NA</td>
<td align="left">IL-20RA</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">ARTN</td>
<td align="left">FALSE</td>
<td align="left">160_ARTN</td>
<td align="left">Q5T4W7</td>
<td align="right">0.73</td>
<td align="right">95.84</td>
<td align="right">95.9404325</td>
<td align="left">red</td>
<td align="left">ARTN</td>
<td align="left">NA</td>
<td align="left">ARTN</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">IL.15RA</td>
<td align="left">FALSE</td>
<td align="left">148_IL-15RA</td>
<td align="left">Q13261</td>
<td align="right">1.18</td>
<td align="right">96.10</td>
<td align="right">96.1648307</td>
<td align="left">blue</td>
<td align="left">IL-15RA</td>
<td align="left">NA</td>
<td align="left">IL-15RA</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">IL.13</td>
<td align="left">FALSE</td>
<td align="left">159_IL-13</td>
<td align="left">P35225</td>
<td align="right">1.71</td>
<td align="right">96.51</td>
<td align="right">96.5524276</td>
<td align="left">red</td>
<td align="left">IL-13</td>
<td align="left">NA</td>
<td align="left">IL-13</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">IL.20</td>
<td align="left">FALSE</td>
<td align="left">171_IL-20</td>
<td align="left">Q9NYY1</td>
<td align="right">1.30</td>
<td align="right">96.72</td>
<td align="right">96.7156263</td>
<td align="left">red</td>
<td align="left">IL-20</td>
<td align="left">NA</td>
<td align="left">IL-20</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">IL.24</td>
<td align="left">FALSE</td>
<td align="left">158_IL-24</td>
<td align="left">Q13007</td>
<td align="right">1.95</td>
<td align="right">97.13</td>
<td align="right">97.0828233</td>
<td align="left">red</td>
<td align="left">IL-24</td>
<td align="left">NA</td>
<td align="left">IL-24</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">IL.2RB</td>
<td align="left">FALSE</td>
<td align="left">124_IL-2RB</td>
<td align="left">P14784</td>
<td align="right">1.47</td>
<td align="right">97.11</td>
<td align="right">97.1032232</td>
<td align="left">red</td>
<td align="left">IL-2RB</td>
<td align="left">NA</td>
<td align="left">IL-2RB</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">NRTN</td>
<td align="left">FALSE</td>
<td align="left">182_NRTN</td>
<td align="left">Q99748</td>
<td align="right">1.39</td>
<td align="right">97.11</td>
<td align="right">97.1236230</td>
<td align="left">red</td>
<td align="left">NRTN</td>
<td align="left">NA</td>
<td align="left">NRTN</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">IL.33</td>
<td align="left">FALSE</td>
<td align="left">177_IL-33</td>
<td align="left">O95760</td>
<td align="right">1.17</td>
<td align="right">98.54</td>
<td align="right">98.5516116</td>
<td align="left">red</td>
<td align="left">IL-33</td>
<td align="left">NA</td>
<td align="left">IL-33</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">TSLP</td>
<td align="left">FALSE</td>
<td align="left">129_TSLP</td>
<td align="left">Q969D9</td>
<td align="right">1.80</td>
<td align="right">99.49</td>
<td align="right">99.4900041</td>
<td align="left">red</td>
<td align="left">TSLP</td>
<td align="left">NA</td>
<td align="left">TSLP</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">IFN.gamma</td>
<td align="left">FALSE</td>
<td align="left">178_IFN-gamma</td>
<td align="left">P01579</td>
<td align="right">1.40</td>
<td align="right">99.53</td>
<td align="right">99.5308038</td>
<td align="left">red</td>
<td align="left">IFN-gamma</td>
<td align="left">NA</td>
<td align="left">IFN-gamma</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">IL.22.RA1</td>
<td align="left">FALSE</td>
<td align="left">150_IL-22 RA1</td>
<td align="left">Q8N6P7</td>
<td align="right">1.79</td>
<td align="right">99.61</td>
<td align="right">99.6124031</td>
<td align="left">red</td>
<td align="left">IL-22RA1</td>
<td align="left">NA</td>
<td align="left">IL-22RA1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">IL.2</td>
<td align="left">FALSE</td>
<td align="left">127_IL-2</td>
<td align="left">P60568</td>
<td align="right">0.93</td>
<td align="right">99.86</td>
<td align="right">99.8776010</td>
<td align="left">red</td>
<td align="left">IL-2</td>
<td align="left">NA</td>
<td align="left">IL-2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">IL.1.alpha</td>
<td align="left">FALSE</td>
<td align="left">125_IL-1 alpha</td>
<td align="left">P01583</td>
<td align="right">4.76</td>
<td align="right">99.88</td>
<td align="right">99.8776010</td>
<td align="left">blue</td>
<td align="left">IL-1 alpha</td>
<td align="left">NA</td>
<td align="left">IL-1 alpha</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3" number="2.7">
<h3 id="maendtoend">
<span class="header-section-number">2.7</span> maEndtoEnd<a class="anchor" aria-label="anchor" href="#maendtoend"></a>
</h3>
<p>Web: <a href="https://bioconductor.org/packages/release/workflows/html/maEndToEnd.html" class="external-link uri">https://bioconductor.org/packages/release/workflows/html/maEndToEnd.html</a>.</p>
<p>Examples can be found on PCA, heatmap, normalisation, linear models, and enrichment analysis from this Bioconductor package.</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="summarizedexperiment">
<span class="header-section-number">3</span> SummarizedExperiment<a class="anchor" aria-label="anchor" href="#summarizedexperiment"></a>
</h2>
<p>This is a more modern construct. Based on the documentation example, ranged summarized experiment (rse) and imputation are shown below.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">nrows</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">ncols</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nrows</span> <span class="op">*</span> <span class="va">ncols</span>, <span class="fl">1</span>, <span class="fl">1e4</span><span class="op">)</span>, <span class="va">nrows</span><span class="op">)</span></span>
<span><span class="va">missing_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">counts</span><span class="op">[</span><span class="va">missing_indices</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">rowRanges</span> <span class="op">&lt;-</span> <span class="fu">GenomicRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="va">nrows</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>                            <span class="fu">IRanges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">nrows</span>, <span class="fl">1e5</span>, <span class="fl">1e6</span><span class="op">)</span><span class="op">)</span>, width<span class="op">=</span><span class="va">ncols</span><span class="op">)</span>,</span>
<span>                            strand<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"-"</span><span class="op">)</span>, <span class="va">nrows</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                            feature_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"ID%03d"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nrows</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colData</span> <span class="op">&lt;-</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>Treatment<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ChIP"</span>, <span class="st">"Input"</span><span class="op">)</span>, <span class="va">ncols</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                                row.names<span class="op">=</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ncols</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">rse</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>assays<span class="op">=</span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">counts</span><span class="op">)</span>,</span>
<span>                                                  rowRanges<span class="op">=</span><span class="va">rowRanges</span>, colData<span class="op">=</span><span class="va">colData</span><span class="op">)</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt;               A         B         C           D</span></span>
<span><span class="co">#&gt;  [1,] 2876.4876 8895.5036 1428.8574 6651.486831</span></span>
<span><span class="co">#&gt;  [2,] 7883.2630 6928.3413 4146.0488  949.311769</span></span>
<span><span class="co">#&gt;  [3,] 4090.3602 6405.4276 4137.8295 3840.312408</span></span>
<span><span class="co">#&gt;  [4,] 8830.2910 9942.7035 3689.0857 2744.562062</span></span>
<span><span class="co">#&gt;  [5,] 9404.7324 6557.4023 1525.2950 8146.585749</span></span>
<span><span class="co">#&gt;  [6,]        NA 7085.5962 1388.9218 4485.714898</span></span>
<span><span class="co">#&gt;  [7,] 5281.5268 5441.1162 2331.1080 8100.833466</span></span>
<span><span class="co">#&gt;  [8,] 8924.2980 5941.8261 4660.1585 8124.082706</span></span>
<span><span class="co">#&gt;  [9,] 5514.7987 2892.3082 2660.4604 7943.628869</span></span>
<span><span class="co">#&gt; [10,] 4566.6907 1471.9894        NA 4398.877044</span></span>
<span><span class="co">#&gt; [11,] 9568.3766        NA  459.2658 7544.997111</span></span>
<span><span class="co">#&gt; [12,] 4533.8882 9023.0882 4422.5585          NA</span></span>
<span><span class="co">#&gt; [13,] 6776.0288 6907.3621 7989.4495 7102.113831</span></span>
<span><span class="co">#&gt; [14,] 5726.7614 7954.8787 1219.8707    7.247108</span></span>
<span><span class="co">#&gt; [15,] 1030.1439  247.1122 5609.9189 4753.690424</span></span>
<span><span class="co">#&gt; [16,] 8998.3499 4778.4819 2066.1074 2201.968733</span></span>
<span><span class="co">#&gt; [17,] 2461.6313 7584.8369 1276.1890 3798.785561</span></span>
<span><span class="co">#&gt; [18,]  421.5533 2164.8630 7533.3253 6128.097262</span></span>
<span><span class="co">#&gt; [19,] 3279.8793        NA 8950.5585 3518.627295</span></span>
<span><span class="co">#&gt; [20,] 9545.0820 2317.0262 3745.2533 1112.243108</span></span>
<span><span class="va">imputed</span> <span class="op">&lt;-</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MsCoreUtils/man/imputation.html" class="external-link">impute_knn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">imputed_counts</span> <span class="op">&lt;-</span> <span class="fu">MsCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MsCoreUtils/man/imputation.html" class="external-link">impute_RF</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">imputed</span><span class="op">-</span><span class="va">imputed_counts</span></span>
<span><span class="co">#&gt;              A         B        C        D</span></span>
<span><span class="co">#&gt;  [1,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [2,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [3,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [4,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [5,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [6,] 2559.339    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [7,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [8,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt;  [9,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [10,]    0.000    0.0000 1791.909    0.000</span></span>
<span><span class="co">#&gt; [11,]    0.000 -709.2786    0.000    0.000</span></span>
<span><span class="co">#&gt; [12,]    0.000    0.0000    0.000 2467.614</span></span>
<span><span class="co">#&gt; [13,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [14,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [15,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [16,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [17,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [18,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="co">#&gt; [19,]    0.000 1298.3456    0.000    0.000</span></span>
<span><span class="co">#&gt; [20,]    0.000    0.0000    0.000    0.000</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">imputed_counts</span><span class="op">)</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt;               A         B         C           D</span></span>
<span><span class="co">#&gt;  [1,] 2876.4876 8895.5036 1428.8574 6651.486831</span></span>
<span><span class="co">#&gt;  [2,] 7883.2630 6928.3413 4146.0488  949.311769</span></span>
<span><span class="co">#&gt;  [3,] 4090.3602 6405.4276 4137.8295 3840.312408</span></span>
<span><span class="co">#&gt;  [4,] 8830.2910 9942.7035 3689.0857 2744.562062</span></span>
<span><span class="co">#&gt;  [5,] 9404.7324 6557.4023 1525.2950 8146.585749</span></span>
<span><span class="co">#&gt;  [6,] 4439.2947 7085.5962 1388.9218 4485.714898</span></span>
<span><span class="co">#&gt;  [7,] 5281.5268 5441.1162 2331.1080 8100.833466</span></span>
<span><span class="co">#&gt;  [8,] 8924.2980 5941.8261 4660.1585 8124.082706</span></span>
<span><span class="co">#&gt;  [9,] 5514.7987 2892.3082 2660.4604 7943.628869</span></span>
<span><span class="co">#&gt; [10,] 4566.6907 1471.9894 4812.3872 4398.877044</span></span>
<span><span class="co">#&gt; [11,] 9568.3766 5545.7565  459.2658 7544.997111</span></span>
<span><span class="co">#&gt; [12,] 4533.8882 9023.0882 4422.5585 4611.837102</span></span>
<span><span class="co">#&gt; [13,] 6776.0288 6907.3621 7989.4495 7102.113831</span></span>
<span><span class="co">#&gt; [14,] 5726.7614 7954.8787 1219.8707    7.247108</span></span>
<span><span class="co">#&gt; [15,] 1030.1439  247.1122 5609.9189 4753.690424</span></span>
<span><span class="co">#&gt; [16,] 8998.3499 4778.4819 2066.1074 2201.968733</span></span>
<span><span class="co">#&gt; [17,] 2461.6313 7584.8369 1276.1890 3798.785561</span></span>
<span><span class="co">#&gt; [18,]  421.5533 2164.8630 7533.3253 6128.097262</span></span>
<span><span class="co">#&gt; [19,] 3279.8793 4566.2289 8950.5585 3518.627295</span></span>
<span><span class="co">#&gt; [20,] 9545.0820 2317.0262 3745.2533 1112.243108</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/List-utils.html" class="external-link">endoapply</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span>, <span class="va">asinh</span><span class="op">)</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt;              A        B        C        D</span></span>
<span><span class="co">#&gt;  [1,] 8.657472 9.786448 7.957778 9.495743</span></span>
<span><span class="co">#&gt;  [2,] 9.665644 9.536523 9.023058 7.548885</span></span>
<span><span class="co">#&gt;  [3,] 9.009536 9.458048 9.021074 8.946456</span></span>
<span><span class="co">#&gt;  [4,] 9.779090 9.897741 8.906281 8.610524</span></span>
<span><span class="co">#&gt;  [5,] 9.842115 9.481497 8.023090 9.698501</span></span>
<span><span class="co">#&gt;  [6,] 9.091398 9.558966 7.929430 9.101800</span></span>
<span><span class="co">#&gt;  [7,] 9.265118 9.294887 8.447246 9.692869</span></span>
<span><span class="co">#&gt;  [8,] 9.789680 9.382919 9.139952 9.695735</span></span>
<span><span class="co">#&gt;  [9,] 9.308338 8.662957 8.579402 9.673273</span></span>
<span><span class="co">#&gt; [10,] 9.119691 7.987517 9.172096 9.082252</span></span>
<span><span class="co">#&gt; [11,] 9.859366 9.313936 6.822778 9.621787</span></span>
<span><span class="co">#&gt; [12,] 9.112482 9.800689 9.087621 9.129529</span></span>
<span><span class="co">#&gt; [13,] 9.514294 9.533490 9.679024 9.561295</span></span>
<span><span class="co">#&gt; [14,] 9.346053 9.674688 7.799647 2.678476</span></span>
<span><span class="co">#&gt; [15,] 7.630601 6.202994 9.325439 9.159824</span></span>
<span><span class="co">#&gt; [16,] 9.797944 9.165025 8.326569 8.390254</span></span>
<span><span class="co">#&gt; [17,] 8.501727 9.627054 7.844781 8.935584</span></span>
<span><span class="co">#&gt; [18,] 6.737095 8.373260 9.620239 9.413787</span></span>
<span><span class="co">#&gt; [19,] 8.788709 9.119590 9.792618 8.858973</span></span>
<span><span class="co">#&gt; [20,] 9.856929 8.441187 8.921392 7.707281</span></span>
<span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 20 ranges and 1 metadata column:</span></span>
<span><span class="co">#&gt;        seqnames        ranges strand |  feature_id</span></span>
<span><span class="co">#&gt;           &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></span>
<span><span class="co">#&gt;    [1]     chr1 409164-409167      - |       ID001</span></span>
<span><span class="co">#&gt;    [2]     chr1 691082-691085      + |       ID002</span></span>
<span><span class="co">#&gt;    [3]     chr1 388335-388338      + |       ID003</span></span>
<span><span class="co">#&gt;    [4]     chr1 268922-268925      - |       ID004</span></span>
<span><span class="co">#&gt;    [5]     chr1 804064-804067      - |       ID005</span></span>
<span><span class="co">#&gt;    ...      ...           ...    ... .         ...</span></span>
<span><span class="co">#&gt;   [16]     chr2 647861-647864      + |       ID016</span></span>
<span><span class="co">#&gt;   [17]     chr2 469620-469623      + |       ID017</span></span>
<span><span class="co">#&gt;   [18]     chr2 232385-232388      + |       ID018</span></span>
<span><span class="co">#&gt;   [19]     chr2 941769-941772      - |       ID019</span></span>
<span><span class="co">#&gt;   [20]     chr2 371106-371109      + |       ID020</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 2 sequences from an unspecified genome; no seqlengths</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 20 rows and 1 column</span></span>
<span><span class="co">#&gt;      feature_id</span></span>
<span><span class="co">#&gt;     &lt;character&gt;</span></span>
<span><span class="co">#&gt; 1         ID001</span></span>
<span><span class="co">#&gt; 2         ID002</span></span>
<span><span class="co">#&gt; 3         ID003</span></span>
<span><span class="co">#&gt; 4         ID004</span></span>
<span><span class="co">#&gt; 5         ID005</span></span>
<span><span class="co">#&gt; ...         ...</span></span>
<span><span class="co">#&gt; 16        ID016</span></span>
<span><span class="co">#&gt; 17        ID017</span></span>
<span><span class="co">#&gt; 18        ID018</span></span>
<span><span class="co">#&gt; 19        ID019</span></span>
<span><span class="co">#&gt; 20        ID020</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">rse</span><span class="op">)</span></span>
<span><span class="co">#&gt; DataFrame with 4 rows and 1 column</span></span>
<span><span class="co">#&gt;     Treatment</span></span>
<span><span class="co">#&gt;   &lt;character&gt;</span></span>
<span><span class="co">#&gt; A        ChIP</span></span>
<span><span class="co">#&gt; B       Input</span></span>
<span><span class="co">#&gt; C        ChIP</span></span>
<span><span class="co">#&gt; D       Input</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 id="normalisation">
<span class="header-section-number">4</span> Normalisation<a class="anchor" aria-label="anchor" href="#normalisation"></a>
</h2>
<div class="section level3" number="4.1">
<h3 id="combat">
<span class="header-section-number">4.1</span> ComBat<a class="anchor" aria-label="anchor" href="#combat"></a>
</h3>
<p>This is the documentation example, based on Bioconductor 3.14.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bladderdata</span>, package<span class="op">=</span><span class="st">"bladderbatch"</span><span class="op">)</span></span>
<span><span class="va">edat</span> <span class="op">&lt;-</span> <span class="va">bladderEset</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span></span>
<span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">edat</span><span class="op">)</span></span>
<span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="va">pheno</span><span class="op">$</span><span class="va">batch</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span></span>
<span><span class="co">#&gt; batch</span></span>
<span><span class="co">#&gt;  1  2  3  4  5 </span></span>
<span><span class="co">#&gt; 11 18  4  5 19</span></span>
<span><span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/matboxplot.html" class="external-link">matboxplot</a></span><span class="op">(</span><span class="va">edat</span>,<span class="va">batch</span>,cex.axis<span class="op">=</span><span class="fl">0.6</span>,notch<span class="op">=</span><span class="cn">TRUE</span>,pch<span class="op">=</span><span class="fl">19</span>,ylab<span class="op">=</span><span class="st">"Expression"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ComBat-1"></span>
<img src="bioconductor/ComBat-1.png" alt="ComBat example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.1: ComBat example
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/matdensity.html" class="external-link">matdensity</a></span><span class="op">(</span><span class="va">edat</span>,<span class="va">batch</span>,xlab<span class="op">=</span><span class="st">" "</span>,ylab<span class="op">=</span><span class="st">"density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,legend<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ComBat-2"></span>
<img src="bioconductor/ComBat-2.png" alt="ComBat example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.2: ComBat example
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># 1. parametric adjustment</span></span>
<span><span class="va">combat_edata1</span> <span class="op">&lt;-</span> <span class="fu">sva</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sva/man/ComBat.html" class="external-link">ComBat</a></span><span class="op">(</span>dat<span class="op">=</span><span class="va">edat</span>, batch<span class="op">=</span><span class="va">batch</span>, par.prior<span class="op">=</span><span class="cn">TRUE</span>, prior.plots<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Found5batches</span></span>
<span><span class="co">#&gt; Adjusting for0covariate(s) or covariate level(s)</span></span>
<span><span class="co">#&gt; Standardizing Data across genes</span></span>
<span><span class="co">#&gt; Fitting L/S model and finding priors</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ComBat-3"></span>
<img src="bioconductor/ComBat-3.png" alt="ComBat example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.3: ComBat example
</p>
</div>
<pre><code><span><span class="co">#&gt; Finding parametric adjustments</span></span>
<span><span class="co">#&gt; Adjusting the Data</span></span>
<span></span>
<span><span class="co"># 2. non-parametric adjustment, mean-only version</span></span>
<span><span class="va">combat_edata2</span> <span class="op">&lt;-</span> <span class="fu">sva</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sva/man/ComBat.html" class="external-link">ComBat</a></span><span class="op">(</span>dat<span class="op">=</span><span class="va">edat</span>, batch<span class="op">=</span><span class="va">batch</span>, par.prior<span class="op">=</span><span class="cn">FALSE</span>, mean.only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using the 'mean only' version of ComBat</span></span>
<span><span class="co">#&gt; Found5batches</span></span>
<span><span class="co">#&gt; Adjusting for0covariate(s) or covariate level(s)</span></span>
<span><span class="co">#&gt; Standardizing Data across genes</span></span>
<span><span class="co">#&gt; Fitting L/S model and finding priors</span></span>
<span><span class="co">#&gt; Finding nonparametric adjustments</span></span>
<span><span class="co">#&gt; Adjusting the Data</span></span>
<span></span>
<span><span class="co"># 3. reference-batch version, with covariates</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cancer</span><span class="op">)</span>, data<span class="op">=</span><span class="va">pheno</span><span class="op">)</span></span>
<span><span class="va">combat_edata3</span> <span class="op">&lt;-</span> <span class="fu">sva</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sva/man/ComBat.html" class="external-link">ComBat</a></span><span class="op">(</span>dat<span class="op">=</span><span class="va">edat</span>, batch<span class="op">=</span><span class="va">batch</span>, mod<span class="op">=</span><span class="va">mod</span>, par.prior<span class="op">=</span><span class="cn">TRUE</span>, ref.batch<span class="op">=</span><span class="fl">3</span>, prior.plots<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using batch =3as a reference batch (this batch won't change)</span></span>
<span><span class="co">#&gt; Found5batches</span></span>
<span><span class="co">#&gt; Adjusting for2covariate(s) or covariate level(s)</span></span>
<span><span class="co">#&gt; Standardizing Data across genes</span></span>
<span><span class="co">#&gt; Fitting L/S model and finding priors</span></span></code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ComBat-4"></span>
<img src="bioconductor/ComBat-4.png" alt="ComBat example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.4: ComBat example
</p>
</div>
<pre><code><span><span class="co">#&gt; Finding parametric adjustments</span></span>
<span><span class="co">#&gt; Adjusting the Data</span></span></code></pre>
</div>
<div class="section level3" number="4.2">
<h3 id="quantro">
<span class="header-section-number">4.2</span> quantro<a class="anchor" aria-label="anchor" href="#quantro"></a>
</h3>
<p>This is also adapted from the package vignette but with <code>FlowSorted.DLPFC.450k</code> in place of <code>FlowSorted</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FlowSorted.DLPFC.450k</span>,package<span class="op">=</span><span class="st">"FlowSorted.DLPFC.450k"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">getBeta</span><span class="op">(</span><span class="va">FlowSorted.DLPFC.450k</span>,offset<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu">Biobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">FlowSorted.DLPFC.450k</span><span class="op">)</span></span>
<span><span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/matboxplot.html" class="external-link">matboxplot</a></span><span class="op">(</span><span class="va">p</span>, groupFactor <span class="op">=</span> <span class="va">pd</span><span class="op">$</span><span class="va">CellType</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, main <span class="op">=</span> <span class="st">"Beta Values"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:quantro-1"></span>
<img src="bioconductor/quantro-1.png" alt="quantro example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.5: quantro example
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/matdensity.html" class="external-link">matdensity</a></span><span class="op">(</span><span class="va">p</span>, groupFactor <span class="op">=</span> <span class="va">pd</span><span class="op">$</span><span class="va">CellType</span>, xlab <span class="op">=</span> <span class="st">" "</span>, ylab <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>                    main <span class="op">=</span> <span class="st">"Beta Values"</span>, brewer.n <span class="op">=</span> <span class="fl">8</span>, brewer.name <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'top'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NeuN_neg"</span>, <span class="st">"NeuN_pos"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:quantro-2"></span>
<img src="bioconductor/quantro-2.png" alt="quantro example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 4.6: quantro example
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qtest</span> <span class="op">&lt;-</span> <span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/quantro.html" class="external-link">quantro</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">p</span>, groupFactor <span class="op">=</span> <span class="va">pd</span><span class="op">$</span><span class="va">CellType</span><span class="op">)</span></span>
<span><span class="co">#&gt; [quantro] Average medians of the distributions are </span></span>
<span><span class="co">#&gt;                         not equal across groups.</span></span>
<span><span class="co">#&gt; [quantro] Calculating the quantro test statistic.</span></span>
<span><span class="co">#&gt; [quantro] No permutation testing performed. </span></span>
<span><span class="co">#&gt;                          Use B &gt; 0 for permutation testing.</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span>cores<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="va">qtestPerm</span> <span class="op">&lt;-</span> <span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/quantro.html" class="external-link">quantro</a></span><span class="op">(</span><span class="va">p</span>, groupFactor <span class="op">=</span> <span class="va">pd</span><span class="op">$</span><span class="va">CellType</span>, B <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span>  <span class="fu">quantro</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantro/man/quantroPlot.html" class="external-link">quantroPlot</a></span><span class="op">(</span><span class="va">qtestPerm</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2" number="5">
<h2 id="outlier-detection-in-rna-seq">
<span class="header-section-number">5</span> Outlier detection in RNA-Seq<a class="anchor" aria-label="anchor" href="#outlier-detection-in-rna-seq"></a>
</h2>
<p>The following is adapted from package OUTRIDER,</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ctsFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'KremerNBaderSmall.tsv'</span>, package<span class="op">=</span><span class="st">'OUTRIDER'</span><span class="op">)</span></span>
<span><span class="va">ctsTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="va">ctsFile</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">ods</span> <span class="op">&lt;-</span> <span class="fu">OUTRIDER</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OUTRIDER/man/OutriderDataSet-class.html" class="external-link">OutriderDataSet</a></span><span class="op">(</span>countData<span class="op">=</span><span class="va">ctsTable</span><span class="op">)</span></span>
<span><span class="va">ods</span> <span class="op">&lt;-</span> <span class="fu">OUTRIDER</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OUTRIDER/man/filterExpression.html" class="external-link">filterExpression</a></span><span class="op">(</span><span class="va">ods</span>, minCounts<span class="op">=</span><span class="cn">TRUE</span>, filterGenes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 229 genes did not pass the filter due to zero counts. This is 22.9% of the genes.</span></span>
<span><span class="va">ods</span> <span class="op">&lt;-</span> <span class="fu">OUTRIDER</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OUTRIDER/man/OUTRIDER.html" class="external-link">OUTRIDER</a></span><span class="op">(</span><span class="va">ods</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:44:28 2025: SizeFactor estimation ...</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:44:29 2025: Controlling for confounders ...</span></span>
<span><span class="co">#&gt; Using estimated q with: 23</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:44:29 2025: Using the autoencoder implementation for controlling.</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:34 2025: Initial PCA loss: 4.73997327486604"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:37 2025: Iteration: 1 loss: 4.19416269506454"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:40 2025: Iteration: 2 loss: 4.17550752619036"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:43 2025: Iteration: 3 loss: 4.16639365666912"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:45 2025: Iteration: 4 loss: 4.16142359470334"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:47 2025: Iteration: 5 loss: 4.15785341106832"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:48 2025: Iteration: 6 loss: 4.15533343090454"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:50 2025: Iteration: 7 loss: 4.15339892434562"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:52 2025: Iteration: 8 loss: 4.15175378925737"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:53 2025: Iteration: 9 loss: 4.15069201289976"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:54 2025: Iteration: 10 loss: 4.1501222741797"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:55 2025: Iteration: 11 loss: 4.14904801948777"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:57 2025: Iteration: 12 loss: 4.14805452270911"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:58 2025: Iteration: 13 loss: 4.14796461892655"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:44:59 2025: Iteration: 14 loss: 4.14722109314569"</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:45:00 2025: Iteration: 15 loss: 4.14696284053289"</span></span>
<span><span class="co">#&gt; Time difference of 25.732 secs</span></span>
<span><span class="co">#&gt; [1] "Fri Mar 14 10:45:00 2025: 15 Final nb-AE loss: 4.14696284053289"</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:45:00 2025: Used the autoencoder implementation for controlling.</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:45:00 2025: P-value calculation ...</span></span>
<span><span class="co">#&gt; Fri Mar 14 10:45:04 2025: Zscore calculation ...</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">OUTRIDER</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OUTRIDER/man/results.html" class="external-link">results</a></span><span class="op">(</span><span class="va">ods</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">res</span>,caption<span class="op">=</span><span class="st">"A check list of outliers"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>
<span id="tab:ods">Table 5.1: </span>A check list of outliers</caption>
<colgroup>
<col width="8%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="4%">
<col width="3%">
<col width="6%">
<col width="8%">
<col width="6%">
<col width="8%">
<col width="4%">
<col width="5%">
<col width="10%">
<col width="9%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">geneID</th>
<th align="left">sampleID</th>
<th align="right">pValue</th>
<th align="right">padjust</th>
<th align="right">zScore</th>
<th align="right">l2fc</th>
<th align="right">rawcounts</th>
<th align="right">meanRawcounts</th>
<th align="right">normcounts</th>
<th align="right">meanCorrected</th>
<th align="right">theta</th>
<th align="left">aberrant</th>
<th align="right">AberrantBySample</th>
<th align="right">AberrantByGene</th>
<th align="right">padj_rank</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ATAD3C</td>
<td align="left">MUC1360</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000001</td>
<td align="right">5.28</td>
<td align="right">1.88</td>
<td align="right">948</td>
<td align="right">82.29</td>
<td align="right">248.14</td>
<td align="right">67.33</td>
<td align="right">16.48</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NBPF15</td>
<td align="left">MUC1351</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000035</td>
<td align="right">5.80</td>
<td align="right">0.77</td>
<td align="right">7591</td>
<td align="right">4224.88</td>
<td align="right">7028.35</td>
<td align="right">4121.14</td>
<td align="right">112.78</td>
<td align="left">TRUE</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">MSTO1</td>
<td align="left">MUC1367</td>
<td align="right">0.0e+00</td>
<td align="right">0.0000177</td>
<td align="right">-6.26</td>
<td align="right">-0.81</td>
<td align="right">761</td>
<td align="right">1327.87</td>
<td align="right">727.74</td>
<td align="right">1276.02</td>
<td align="right">153.26</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">HDAC1</td>
<td align="left">MUC1350</td>
<td align="right">0.0e+00</td>
<td align="right">0.0001133</td>
<td align="right">-5.88</td>
<td align="right">-0.78</td>
<td align="right">2215</td>
<td align="right">3805.56</td>
<td align="right">2128.19</td>
<td align="right">3649.04</td>
<td align="right">135.60</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">DCAF6</td>
<td align="left">MUC1374</td>
<td align="right">1.0e-07</td>
<td align="right">0.0004182</td>
<td align="right">-5.67</td>
<td align="right">-0.61</td>
<td align="right">2348</td>
<td align="right">4869.53</td>
<td align="right">3085.40</td>
<td align="right">4724.25</td>
<td align="right">196.31</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NBPF16</td>
<td align="left">MUC1351</td>
<td align="right">2.0e-07</td>
<td align="right">0.0006791</td>
<td align="right">4.83</td>
<td align="right">0.67</td>
<td align="right">4014</td>
<td align="right">2459.90</td>
<td align="right">3822.18</td>
<td align="right">2402.36</td>
<td align="right">107.85</td>
<td align="left">TRUE</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">FAM102B</td>
<td align="left">MUC1363</td>
<td align="right">1.2e-06</td>
<td align="right">0.0067682</td>
<td align="right">-5.37</td>
<td align="right">-1.29</td>
<td align="right">455</td>
<td align="right">1138.75</td>
<td align="right">440.62</td>
<td align="right">1076.81</td>
<td align="right">41.98</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">LOC100288142</td>
<td align="left">MUC1361</td>
<td align="right">3.0e-06</td>
<td align="right">0.0167927</td>
<td align="right">4.25</td>
<td align="right">0.85</td>
<td align="right">637</td>
<td align="right">356.12</td>
<td align="right">622.40</td>
<td align="right">345.76</td>
<td align="right">57.44</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">TARDBP</td>
<td align="left">MUC0486</td>
<td align="right">7.3e-06</td>
<td align="right">0.0407384</td>
<td align="right">-4.56</td>
<td align="right">-0.32</td>
<td align="right">5911</td>
<td align="right">5780.34</td>
<td align="right">4449.25</td>
<td align="right">5565.44</td>
<td align="right">464.81</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">ZMPSTE24</td>
<td align="left">MUC1370</td>
<td align="right">7.7e-06</td>
<td align="right">0.0426990</td>
<td align="right">4.28</td>
<td align="right">0.38</td>
<td align="right">6180</td>
<td align="right">4026.77</td>
<td align="right">5088.19</td>
<td align="right">3905.38</td>
<td align="right">273.05</td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">OUTRIDER</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OUTRIDER/man/plotFunctions.html" class="external-link">plotQQ</a></span><span class="op">(</span><span class="va">ods</span>, <span class="va">res</span><span class="op">[</span><span class="st">"geneID"</span><span class="op">]</span>,global<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ods"></span>
<img src="bioconductor/ods-1.png" alt="Q-Q plot for Kremer data" width="672" style="display:block; margin: auto"><p class="caption">
Figure 5.1: Q-Q plot for Kremer data
</p>
</div>
</div>
<div class="section level2" number="6">
<h2 id="differential-expression">
<span class="header-section-number">6</span> Differential expression<a class="anchor" aria-label="anchor" href="#differential-expression"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/makeExampleDESeqDataSet.html" class="external-link">makeExampleDESeqDataSet</a></span><span class="op">(</span>m<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">dds</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html" class="external-link">DESeq</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimating size factors</span></span>
<span><span class="co">#&gt; estimating dispersions</span></span>
<span><span class="co">#&gt; gene-wise dispersion estimates</span></span>
<span><span class="co">#&gt; mean-dispersion relationship</span></span>
<span><span class="co">#&gt; final dispersion estimates</span></span>
<span><span class="co">#&gt; fitting model and testing</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html" class="external-link">results</a></span><span class="op">(</span><span class="va">dds</span>, contrast<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span>,<span class="st">"B"</span>,<span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rld</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/rlog.html" class="external-link">rlogTransformation</a></span><span class="op">(</span><span class="va">ex</span>, blind<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">rld</span>, intgroup<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"condition"</span><span class="op">)</span>,returnData<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; using ntop=500 top features by variance</span></span>
<span><span class="va">percentVar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dat</span>,<span class="st">"percentVar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">PC1</span>, <span class="va">PC2</span>, color<span class="op">=</span><span class="va">condition</span>, shape<span class="op">=</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC1:"</span>,<span class="va">percentVar</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"% variance"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PC2:"</span>,<span class="va">percentVar</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">"% variance"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:DESeq2"></span>
<img src="bioconductor/DESeq2-1.png" alt="DESeq2 example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 6.1: DESeq2 example
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span><span class="op">$</span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">ex</span><span class="op">$</span><span class="va">condition</span>, ref<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">dds2</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html" class="external-link">DESeq</a></span><span class="op">(</span><span class="va">dds</span><span class="op">)</span></span>
<span><span class="co">#&gt; using pre-existing size factors</span></span>
<span><span class="co">#&gt; estimating dispersions</span></span>
<span><span class="co">#&gt; found already estimated dispersions, replacing these</span></span>
<span><span class="co">#&gt; gene-wise dispersion estimates</span></span>
<span><span class="co">#&gt; mean-dispersion relationship</span></span>
<span><span class="co">#&gt; final dispersion estimates</span></span>
<span><span class="co">#&gt; fitting model and testing</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html" class="external-link">results</a></span><span class="op">(</span><span class="va">dds2</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="8%">
<col width="15%">
<col width="20%">
<col width="13%">
<col width="15%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">baseMean</th>
<th align="right">log2FoldChange</th>
<th align="right">lfcSE</th>
<th align="right">stat</th>
<th align="right">pvalue</th>
<th align="right">padj</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">gene1</td>
<td align="right">1.433908</td>
<td align="right">-2.2829589</td>
<td align="right">3.4622957</td>
<td align="right">-0.6593772</td>
<td align="right">0.5096536</td>
<td align="right">0.9968571</td>
</tr>
<tr class="even">
<td align="left">gene2</td>
<td align="right">1.931925</td>
<td align="right">1.6064693</td>
<td align="right">2.7934763</td>
<td align="right">0.5750789</td>
<td align="right">0.5652379</td>
<td align="right">0.9968571</td>
</tr>
<tr class="odd">
<td align="left">gene3</td>
<td align="right">163.169483</td>
<td align="right">-0.0858607</td>
<td align="right">0.4951941</td>
<td align="right">-0.1733880</td>
<td align="right">0.8623465</td>
<td align="right">0.9968571</td>
</tr>
<tr class="even">
<td align="left">gene4</td>
<td align="right">5.175563</td>
<td align="right">2.6325522</td>
<td align="right">1.9693871</td>
<td align="right">1.3367368</td>
<td align="right">0.1813086</td>
<td align="right">0.9968571</td>
</tr>
<tr class="odd">
<td align="left">gene5</td>
<td align="right">74.730433</td>
<td align="right">0.3756936</td>
<td align="right">0.5927440</td>
<td align="right">0.6338209</td>
<td align="right">0.5261977</td>
<td align="right">0.9968571</td>
</tr>
<tr class="even">
<td align="left">gene6</td>
<td align="right">35.012376</td>
<td align="right">0.0475492</td>
<td align="right">0.7285611</td>
<td align="right">0.0652646</td>
<td align="right">0.9479634</td>
<td align="right">0.9968571</td>
</tr>
</tbody>
</table>
<p>See the package in action from a snakemake workflow<span class="citation"><sup><a href="#ref-koster21" role="doc-biblioref">1</a></sup></span>.</p>
</div>
<div class="section level2" number="7">
<h2 id="gene-co-expression-and-network-analysis">
<span class="header-section-number">7</span> Gene co-expression and network analysis<a class="anchor" aria-label="anchor" href="#gene-co-expression-and-network-analysis"></a>
</h2>
<p>A simple network is furnished with the <code>GeneNet</code> documentation example,</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## A random network with 40 nodes </span></span>
<span><span class="co"># it contains 780=40*39/2 edges of which 5 percent (=39) are non-zero</span></span>
<span><span class="va">true.pcor</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/ggm.simulate.pcor.html" class="external-link">ggm.simulate.pcor</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># A data set with 40 observations</span></span>
<span><span class="va">m.sim</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/ggm.simulate.data.html" class="external-link">ggm.simulate.data</a></span><span class="op">(</span><span class="fl">40</span>, <span class="va">true.pcor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A simple estimate of partial correlations</span></span>
<span><span class="va">estimated.pcor</span> <span class="op">&lt;-</span> <span class="fu">corpcor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corpcor/man/cor2pcor.html" class="external-link">cor2pcor</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">m.sim</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># A comparison of estimated and true values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true.pcor</span><span class="op">-</span><span class="va">estimated.pcor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 915.4608</span></span>
<span></span>
<span><span class="co"># A slightly better estimate ...</span></span>
<span><span class="va">estimated.pcor.2</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/ggm.estimate.pcor.html" class="external-link">ggm.estimate.pcor</a></span><span class="op">(</span><span class="va">m.sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimating optimal shrinkage intensity lambda (correlation matrix): 0.376</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">true.pcor</span><span class="op">-</span><span class="va">estimated.pcor.2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9.349797</span></span>
<span></span>
<span><span class="co">## ecoli data </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ecoli</span>, package<span class="op">=</span><span class="st">"GeneNet"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># partial correlation matrix </span></span>
<span><span class="va">inferred.pcor</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/ggm.estimate.pcor.html" class="external-link">ggm.estimate.pcor</a></span><span class="op">(</span><span class="va">ecoli</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimating optimal shrinkage intensity lambda (correlation matrix): 0.1804</span></span>
<span></span>
<span><span class="co"># p-values, q-values and posterior probabilities for each potential edge </span></span>
<span><span class="va">test.results</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.test.edges.html" class="external-link">network.test.edges</a></span><span class="op">(</span><span class="va">inferred.pcor</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimate (local) false discovery rates (partial correlations):</span></span>
<span><span class="co">#&gt; Step 1... determine cutoff point</span></span>
<span><span class="co">#&gt; Step 2... estimate parameters of null distribution and eta0</span></span>
<span><span class="co">#&gt; Step 3... compute p-values and estimate empirical PDF/CDF</span></span>
<span><span class="co">#&gt; Step 4... compute q-values and local fdr</span></span>
<span><span class="co">#&gt; Step 5... prepare for plotting</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GeneNet-1"></span>
<img src="bioconductor/GeneNet-1.png" alt="GeneNet example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 7.1: GeneNet example
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># best 20 edges (strongest correlation)</span></span>
<span><span class="va">test.results</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;           pcor node1 node2         pval         qval      prob</span></span>
<span><span class="co">#&gt; 1   0.23185664    51    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 2   0.22405545    52    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 3   0.21507824    51    52 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 4   0.17328863     7    93 3.108624e-15 3.792816e-12 0.9999945</span></span>
<span><span class="co">#&gt; 5  -0.13418892    29    86 1.120812e-09 1.093997e-06 0.9999516</span></span>
<span><span class="co">#&gt; 6   0.12594697    21    72 1.103836e-08 8.978563e-06 0.9998400</span></span>
<span><span class="co">#&gt; 7   0.11956105    28    86 5.890924e-08 3.853590e-05 0.9998400</span></span>
<span><span class="co">#&gt; 8  -0.11723897    26    80 1.060526e-07 5.816172e-05 0.9998400</span></span>
<span><span class="co">#&gt; 9  -0.11711625    72    89 1.093655e-07 5.930499e-05 0.9972804</span></span>
<span><span class="co">#&gt; 10  0.10658013    20    21 1.366610e-06 5.925275e-04 0.9972804</span></span>
<span><span class="co">#&gt; 11  0.10589778    21    73 1.596859e-06 6.678429e-04 0.9972804</span></span>
<span><span class="co">#&gt; 12  0.10478689    20    91 2.053403e-06 8.024425e-04 0.9972804</span></span>
<span><span class="co">#&gt; 13  0.10420836     7    52 2.338382e-06 8.778605e-04 0.9944557</span></span>
<span><span class="co">#&gt; 14  0.10236077    87    95 3.525186e-06 1.224964e-03 0.9944557</span></span>
<span><span class="co">#&gt; 15  0.10113550    27    95 4.610444e-06 1.500047e-03 0.9920084</span></span>
<span><span class="co">#&gt; 16  0.09928954    21    51 6.868357e-06 2.046549e-03 0.9920084</span></span>
<span><span class="co">#&gt; 17  0.09791914    21    88 9.192373e-06 2.520616e-03 0.9920084</span></span>
<span><span class="co">#&gt; 18  0.09719685    18    95 1.070232e-05 2.790102e-03 0.9920084</span></span>
<span><span class="co">#&gt; 19  0.09621791    28    90 1.313007e-05 3.171817e-03 0.9920084</span></span>
<span><span class="co">#&gt; 20  0.09619099    12    80 1.320374e-05 3.182526e-03 0.9920084</span></span>
<span></span>
<span><span class="co"># network containing edges with prob &gt; 0.9 (i.e. local fdr &lt; 0.1)</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.test.edges.html" class="external-link">extract.network</a></span><span class="op">(</span><span class="va">test.results</span>, cutoff.ggm<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Significant edges:  65 </span></span>
<span><span class="co">#&gt;     Corresponding to  1.26 %  of possible edges</span></span>
<span><span class="va">net</span></span>
<span><span class="co">#&gt;           pcor node1 node2         pval         qval      prob</span></span>
<span><span class="co">#&gt; 1   0.23185664    51    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 2   0.22405545    52    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 3   0.21507824    51    52 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 4   0.17328863     7    93 3.108624e-15 3.792816e-12 0.9999945</span></span>
<span><span class="co">#&gt; 5  -0.13418892    29    86 1.120812e-09 1.093997e-06 0.9999516</span></span>
<span><span class="co">#&gt; 6   0.12594697    21    72 1.103836e-08 8.978563e-06 0.9998400</span></span>
<span><span class="co">#&gt; 7   0.11956105    28    86 5.890924e-08 3.853590e-05 0.9998400</span></span>
<span><span class="co">#&gt; 8  -0.11723897    26    80 1.060526e-07 5.816172e-05 0.9998400</span></span>
<span><span class="co">#&gt; 9  -0.11711625    72    89 1.093655e-07 5.930499e-05 0.9972804</span></span>
<span><span class="co">#&gt; 10  0.10658013    20    21 1.366610e-06 5.925275e-04 0.9972804</span></span>
<span><span class="co">#&gt; 11  0.10589778    21    73 1.596859e-06 6.678429e-04 0.9972804</span></span>
<span><span class="co">#&gt; 12  0.10478689    20    91 2.053403e-06 8.024425e-04 0.9972804</span></span>
<span><span class="co">#&gt; 13  0.10420836     7    52 2.338382e-06 8.778605e-04 0.9944557</span></span>
<span><span class="co">#&gt; 14  0.10236077    87    95 3.525186e-06 1.224964e-03 0.9944557</span></span>
<span><span class="co">#&gt; 15  0.10113550    27    95 4.610444e-06 1.500047e-03 0.9920084</span></span>
<span><span class="co">#&gt; 16  0.09928954    21    51 6.868357e-06 2.046549e-03 0.9920084</span></span>
<span><span class="co">#&gt; 17  0.09791914    21    88 9.192373e-06 2.520616e-03 0.9920084</span></span>
<span><span class="co">#&gt; 18  0.09719685    18    95 1.070232e-05 2.790102e-03 0.9920084</span></span>
<span><span class="co">#&gt; 19  0.09621791    28    90 1.313007e-05 3.171817e-03 0.9920084</span></span>
<span><span class="co">#&gt; 20  0.09619099    12    80 1.320374e-05 3.182526e-03 0.9920084</span></span>
<span><span class="co">#&gt; 21  0.09576091    89    95 1.443542e-05 3.354777e-03 0.9891317</span></span>
<span><span class="co">#&gt; 22  0.09473210     7    51 1.784126e-05 3.864825e-03 0.9891317</span></span>
<span><span class="co">#&gt; 23 -0.09386896    53    58 2.127622e-05 4.313590e-03 0.9891317</span></span>
<span><span class="co">#&gt; 24 -0.09366615    29    83 2.217013e-05 4.421099e-03 0.9891317</span></span>
<span><span class="co">#&gt; 25 -0.09341148    21    89 2.334321e-05 4.556947e-03 0.9810727</span></span>
<span><span class="co">#&gt; 26 -0.09156391    49    93 3.380043e-05 5.955972e-03 0.9810727</span></span>
<span><span class="co">#&gt; 27 -0.09150710    80    90 3.418363e-05 6.002083e-03 0.9810727</span></span>
<span><span class="co">#&gt; 28  0.09101505     7    53 3.767966e-05 6.408102e-03 0.9810727</span></span>
<span><span class="co">#&gt; 29  0.09050688    21    84 4.164471e-05 6.838782e-03 0.9810727</span></span>
<span><span class="co">#&gt; 30  0.08965490    72    73 4.919365e-05 7.581866e-03 0.9810727</span></span>
<span><span class="co">#&gt; 31 -0.08934025    29    99 5.229604e-05 7.861416e-03 0.9810727</span></span>
<span><span class="co">#&gt; 32 -0.08906819     9    95 5.512708e-05 8.104759e-03 0.9810727</span></span>
<span><span class="co">#&gt; 33  0.08888345     2    49 5.713144e-05 8.270673e-03 0.9810727</span></span>
<span><span class="co">#&gt; 34  0.08850681    86    90 6.143363e-05 8.610161e-03 0.9810727</span></span>
<span><span class="co">#&gt; 35  0.08805868    17    53 6.695170e-05 9.015175e-03 0.9810727</span></span>
<span><span class="co">#&gt; 36  0.08790809    28    48 6.890884e-05 9.151291e-03 0.9810727</span></span>
<span><span class="co">#&gt; 37  0.08783471    33    58 6.988211e-05 9.217597e-03 0.9682377</span></span>
<span><span class="co">#&gt; 38 -0.08705796     7    49 8.101244e-05 1.021362e-02 0.9682377</span></span>
<span><span class="co">#&gt; 39  0.08645033    20    46 9.086547e-05 1.102466e-02 0.9682377</span></span>
<span><span class="co">#&gt; 40  0.08609950    48    86 9.705862e-05 1.150392e-02 0.9682377</span></span>
<span><span class="co">#&gt; 41  0.08598769    21    52 9.911458e-05 1.165816e-02 0.9682377</span></span>
<span><span class="co">#&gt; 42  0.08555275    32    95 1.075099e-04 1.226435e-02 0.9682377</span></span>
<span><span class="co">#&gt; 43  0.08548231    17    51 1.089311e-04 1.236337e-02 0.9424721</span></span>
<span><span class="co">#&gt; 44  0.08470370    80    83 1.258659e-04 1.382356e-02 0.9424721</span></span>
<span><span class="co">#&gt; 45  0.08442510    80    82 1.325062e-04 1.437068e-02 0.9174573</span></span>
<span><span class="co">#&gt; 46  0.08271606    80    93 1.810275e-04 1.845632e-02 0.9174573</span></span>
<span><span class="co">#&gt; 47  0.08235175    46    91 1.933329e-04 1.941579e-02 0.9174573</span></span>
<span><span class="co">#&gt; 48  0.08217787    25    95 1.994788e-04 1.988432e-02 0.9174573</span></span>
<span><span class="co">#&gt; 49 -0.08170331    29    87 2.171999e-04 2.119715e-02 0.9174573</span></span>
<span><span class="co">#&gt; 50  0.08123632    19    29 2.360716e-04 2.253606e-02 0.9174573</span></span>
<span><span class="co">#&gt; 51  0.08101702    51    84 2.454547e-04 2.318024e-02 0.9174573</span></span>
<span><span class="co">#&gt; 52  0.08030748    16    93 2.782643e-04 2.532796e-02 0.9174573</span></span>
<span><span class="co">#&gt; 53  0.08006503    28    52 2.903870e-04 2.608271e-02 0.9174573</span></span>
<span><span class="co">#&gt; 54 -0.07941656    41    80 3.252833e-04 2.814824e-02 0.9174573</span></span>
<span><span class="co">#&gt; 55  0.07941410    54    89 3.254229e-04 2.815620e-02 0.9174573</span></span>
<span><span class="co">#&gt; 56 -0.07934653    28    80 3.292784e-04 2.837511e-02 0.9174573</span></span>
<span><span class="co">#&gt; 57  0.07916783    29    92 3.396802e-04 2.895702e-02 0.9174573</span></span>
<span><span class="co">#&gt; 58 -0.07866905    17    86 3.703635e-04 3.060293e-02 0.9174573</span></span>
<span><span class="co">#&gt; 59  0.07827749    16    29 3.962446e-04 3.191462e-02 0.9174573</span></span>
<span><span class="co">#&gt; 60 -0.07808262    73    89 4.097452e-04 3.257290e-02 0.9174573</span></span>
<span><span class="co">#&gt; 61  0.07766261    52    67 4.403165e-04 3.400207e-02 0.9174573</span></span>
<span><span class="co">#&gt; 62  0.07762917    25    87 4.428396e-04 3.411637e-02 0.9174573</span></span>
<span><span class="co">#&gt; 63 -0.07739378     9    93 4.609872e-04 3.492295e-02 0.9174573</span></span>
<span><span class="co">#&gt; 64  0.07738885    31    80 4.613747e-04 3.493988e-02 0.9174573</span></span>
<span><span class="co">#&gt; 65 -0.07718681    80    94 4.775136e-04 3.563444e-02 0.9174573</span></span>
<span></span>
<span><span class="co"># significant based on FDR cutoff Q=0.05?</span></span>
<span><span class="va">num.significant.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">test.results</span><span class="op">$</span><span class="va">qval</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">test.results</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">num.significant.1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;           pcor node1 node2         pval         qval      prob</span></span>
<span><span class="co">#&gt; 1   0.23185664    51    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 2   0.22405545    52    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 3   0.21507824    51    52 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 4   0.17328863     7    93 3.108624e-15 3.792816e-12 0.9999945</span></span>
<span><span class="co">#&gt; 5  -0.13418892    29    86 1.120812e-09 1.093997e-06 0.9999516</span></span>
<span><span class="co">#&gt; 6   0.12594697    21    72 1.103836e-08 8.978563e-06 0.9998400</span></span>
<span><span class="co">#&gt; 7   0.11956105    28    86 5.890924e-08 3.853590e-05 0.9998400</span></span>
<span><span class="co">#&gt; 8  -0.11723897    26    80 1.060526e-07 5.816172e-05 0.9998400</span></span>
<span><span class="co">#&gt; 9  -0.11711625    72    89 1.093655e-07 5.930499e-05 0.9972804</span></span>
<span><span class="co">#&gt; 10  0.10658013    20    21 1.366610e-06 5.925275e-04 0.9972804</span></span>
<span><span class="co">#&gt; 11  0.10589778    21    73 1.596859e-06 6.678429e-04 0.9972804</span></span>
<span><span class="co">#&gt; 12  0.10478689    20    91 2.053403e-06 8.024425e-04 0.9972804</span></span>
<span><span class="co">#&gt; 13  0.10420836     7    52 2.338382e-06 8.778605e-04 0.9944557</span></span>
<span><span class="co">#&gt; 14  0.10236077    87    95 3.525186e-06 1.224964e-03 0.9944557</span></span>
<span><span class="co">#&gt; 15  0.10113550    27    95 4.610444e-06 1.500047e-03 0.9920084</span></span>
<span><span class="co">#&gt; 16  0.09928954    21    51 6.868357e-06 2.046549e-03 0.9920084</span></span>
<span><span class="co">#&gt; 17  0.09791914    21    88 9.192373e-06 2.520616e-03 0.9920084</span></span>
<span><span class="co">#&gt; 18  0.09719685    18    95 1.070232e-05 2.790102e-03 0.9920084</span></span>
<span><span class="co">#&gt; 19  0.09621791    28    90 1.313007e-05 3.171817e-03 0.9920084</span></span>
<span><span class="co">#&gt; 20  0.09619099    12    80 1.320374e-05 3.182526e-03 0.9920084</span></span>
<span><span class="co">#&gt; 21  0.09576091    89    95 1.443542e-05 3.354777e-03 0.9891317</span></span>
<span><span class="co">#&gt; 22  0.09473210     7    51 1.784126e-05 3.864825e-03 0.9891317</span></span>
<span><span class="co">#&gt; 23 -0.09386896    53    58 2.127622e-05 4.313590e-03 0.9891317</span></span>
<span><span class="co">#&gt; 24 -0.09366615    29    83 2.217013e-05 4.421099e-03 0.9891317</span></span>
<span><span class="co">#&gt; 25 -0.09341148    21    89 2.334321e-05 4.556947e-03 0.9810727</span></span>
<span><span class="co">#&gt; 26 -0.09156391    49    93 3.380043e-05 5.955972e-03 0.9810727</span></span>
<span><span class="co">#&gt; 27 -0.09150710    80    90 3.418363e-05 6.002083e-03 0.9810727</span></span>
<span><span class="co">#&gt; 28  0.09101505     7    53 3.767966e-05 6.408102e-03 0.9810727</span></span>
<span><span class="co">#&gt; 29  0.09050688    21    84 4.164471e-05 6.838782e-03 0.9810727</span></span>
<span><span class="co">#&gt; 30  0.08965490    72    73 4.919365e-05 7.581866e-03 0.9810727</span></span>
<span><span class="co">#&gt; 31 -0.08934025    29    99 5.229604e-05 7.861416e-03 0.9810727</span></span>
<span><span class="co">#&gt; 32 -0.08906819     9    95 5.512708e-05 8.104759e-03 0.9810727</span></span>
<span><span class="co">#&gt; 33  0.08888345     2    49 5.713144e-05 8.270673e-03 0.9810727</span></span>
<span><span class="co">#&gt; 34  0.08850681    86    90 6.143363e-05 8.610161e-03 0.9810727</span></span>
<span><span class="co">#&gt; 35  0.08805868    17    53 6.695170e-05 9.015175e-03 0.9810727</span></span>
<span><span class="co">#&gt; 36  0.08790809    28    48 6.890884e-05 9.151291e-03 0.9810727</span></span>
<span><span class="co">#&gt; 37  0.08783471    33    58 6.988211e-05 9.217597e-03 0.9682377</span></span>
<span><span class="co">#&gt; 38 -0.08705796     7    49 8.101244e-05 1.021362e-02 0.9682377</span></span>
<span><span class="co">#&gt; 39  0.08645033    20    46 9.086547e-05 1.102466e-02 0.9682377</span></span>
<span><span class="co">#&gt; 40  0.08609950    48    86 9.705862e-05 1.150392e-02 0.9682377</span></span>
<span><span class="co">#&gt; 41  0.08598769    21    52 9.911458e-05 1.165816e-02 0.9682377</span></span>
<span><span class="co">#&gt; 42  0.08555275    32    95 1.075099e-04 1.226435e-02 0.9682377</span></span>
<span><span class="co">#&gt; 43  0.08548231    17    51 1.089311e-04 1.236337e-02 0.9424721</span></span>
<span><span class="co">#&gt; 44  0.08470370    80    83 1.258659e-04 1.382356e-02 0.9424721</span></span>
<span><span class="co">#&gt; 45  0.08442510    80    82 1.325062e-04 1.437068e-02 0.9174573</span></span>
<span><span class="co">#&gt; 46  0.08271606    80    93 1.810275e-04 1.845632e-02 0.9174573</span></span>
<span><span class="co">#&gt; 47  0.08235175    46    91 1.933329e-04 1.941579e-02 0.9174573</span></span>
<span><span class="co">#&gt; 48  0.08217787    25    95 1.994788e-04 1.988432e-02 0.9174573</span></span>
<span><span class="co">#&gt; 49 -0.08170331    29    87 2.171999e-04 2.119715e-02 0.9174573</span></span>
<span><span class="co">#&gt; 50  0.08123632    19    29 2.360716e-04 2.253606e-02 0.9174573</span></span>
<span><span class="co">#&gt; 51  0.08101702    51    84 2.454547e-04 2.318024e-02 0.9174573</span></span>
<span><span class="co">#&gt; 52  0.08030748    16    93 2.782643e-04 2.532796e-02 0.9174573</span></span>
<span><span class="co">#&gt; 53  0.08006503    28    52 2.903870e-04 2.608271e-02 0.9174573</span></span>
<span><span class="co">#&gt; 54 -0.07941656    41    80 3.252833e-04 2.814824e-02 0.9174573</span></span>
<span><span class="co">#&gt; 55  0.07941410    54    89 3.254229e-04 2.815620e-02 0.9174573</span></span>
<span><span class="co">#&gt; 56 -0.07934653    28    80 3.292784e-04 2.837511e-02 0.9174573</span></span>
<span><span class="co">#&gt; 57  0.07916783    29    92 3.396802e-04 2.895702e-02 0.9174573</span></span>
<span><span class="co">#&gt; 58 -0.07866905    17    86 3.703635e-04 3.060293e-02 0.9174573</span></span>
<span><span class="co">#&gt; 59  0.07827749    16    29 3.962446e-04 3.191462e-02 0.9174573</span></span>
<span><span class="co">#&gt; 60 -0.07808262    73    89 4.097452e-04 3.257290e-02 0.9174573</span></span>
<span><span class="co">#&gt; 61  0.07766261    52    67 4.403165e-04 3.400207e-02 0.9174573</span></span>
<span><span class="co">#&gt; 62  0.07762917    25    87 4.428396e-04 3.411637e-02 0.9174573</span></span>
<span><span class="co">#&gt; 63 -0.07739378     9    93 4.609872e-04 3.492295e-02 0.9174573</span></span>
<span><span class="co">#&gt; 64  0.07738885    31    80 4.613747e-04 3.493988e-02 0.9174573</span></span>
<span><span class="co">#&gt; 65 -0.07718681    80    94 4.775136e-04 3.563444e-02 0.9174573</span></span>
<span><span class="co">#&gt; 66  0.07706275    27    58 4.876831e-04 3.606179e-02 0.8297811</span></span>
<span><span class="co">#&gt; 67 -0.07610709    16    83 5.730532e-04 4.085920e-02 0.8297811</span></span>
<span><span class="co">#&gt; 68  0.07550557    53    84 6.337143e-04 4.406472e-02 0.8297811</span></span>
<span></span>
<span><span class="co"># significant based on "local fdr" cutoff (prob &gt; 0.9)?</span></span>
<span><span class="va">num.significant.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">test.results</span><span class="op">$</span><span class="va">prob</span> <span class="op">&gt;</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">test.results</span><span class="op">[</span><span class="va">test.results</span><span class="op">$</span><span class="va">prob</span> <span class="op">&gt;</span> <span class="fl">0.9</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;           pcor node1 node2         pval         qval      prob</span></span>
<span><span class="co">#&gt; 1   0.23185664    51    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 2   0.22405545    52    53 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 3   0.21507824    51    52 2.220446e-16 3.612205e-13 1.0000000</span></span>
<span><span class="co">#&gt; 4   0.17328863     7    93 3.108624e-15 3.792816e-12 0.9999945</span></span>
<span><span class="co">#&gt; 5  -0.13418892    29    86 1.120812e-09 1.093997e-06 0.9999516</span></span>
<span><span class="co">#&gt; 6   0.12594697    21    72 1.103836e-08 8.978563e-06 0.9998400</span></span>
<span><span class="co">#&gt; 7   0.11956105    28    86 5.890924e-08 3.853590e-05 0.9998400</span></span>
<span><span class="co">#&gt; 8  -0.11723897    26    80 1.060526e-07 5.816172e-05 0.9998400</span></span>
<span><span class="co">#&gt; 9  -0.11711625    72    89 1.093655e-07 5.930499e-05 0.9972804</span></span>
<span><span class="co">#&gt; 10  0.10658013    20    21 1.366610e-06 5.925275e-04 0.9972804</span></span>
<span><span class="co">#&gt; 11  0.10589778    21    73 1.596859e-06 6.678429e-04 0.9972804</span></span>
<span><span class="co">#&gt; 12  0.10478689    20    91 2.053403e-06 8.024425e-04 0.9972804</span></span>
<span><span class="co">#&gt; 13  0.10420836     7    52 2.338382e-06 8.778605e-04 0.9944557</span></span>
<span><span class="co">#&gt; 14  0.10236077    87    95 3.525186e-06 1.224964e-03 0.9944557</span></span>
<span><span class="co">#&gt; 15  0.10113550    27    95 4.610444e-06 1.500047e-03 0.9920084</span></span>
<span><span class="co">#&gt; 16  0.09928954    21    51 6.868357e-06 2.046549e-03 0.9920084</span></span>
<span><span class="co">#&gt; 17  0.09791914    21    88 9.192373e-06 2.520616e-03 0.9920084</span></span>
<span><span class="co">#&gt; 18  0.09719685    18    95 1.070232e-05 2.790102e-03 0.9920084</span></span>
<span><span class="co">#&gt; 19  0.09621791    28    90 1.313007e-05 3.171817e-03 0.9920084</span></span>
<span><span class="co">#&gt; 20  0.09619099    12    80 1.320374e-05 3.182526e-03 0.9920084</span></span>
<span><span class="co">#&gt; 21  0.09576091    89    95 1.443542e-05 3.354777e-03 0.9891317</span></span>
<span><span class="co">#&gt; 22  0.09473210     7    51 1.784126e-05 3.864825e-03 0.9891317</span></span>
<span><span class="co">#&gt; 23 -0.09386896    53    58 2.127622e-05 4.313590e-03 0.9891317</span></span>
<span><span class="co">#&gt; 24 -0.09366615    29    83 2.217013e-05 4.421099e-03 0.9891317</span></span>
<span><span class="co">#&gt; 25 -0.09341148    21    89 2.334321e-05 4.556947e-03 0.9810727</span></span>
<span><span class="co">#&gt; 26 -0.09156391    49    93 3.380043e-05 5.955972e-03 0.9810727</span></span>
<span><span class="co">#&gt; 27 -0.09150710    80    90 3.418363e-05 6.002083e-03 0.9810727</span></span>
<span><span class="co">#&gt; 28  0.09101505     7    53 3.767966e-05 6.408102e-03 0.9810727</span></span>
<span><span class="co">#&gt; 29  0.09050688    21    84 4.164471e-05 6.838782e-03 0.9810727</span></span>
<span><span class="co">#&gt; 30  0.08965490    72    73 4.919365e-05 7.581866e-03 0.9810727</span></span>
<span><span class="co">#&gt; 31 -0.08934025    29    99 5.229604e-05 7.861416e-03 0.9810727</span></span>
<span><span class="co">#&gt; 32 -0.08906819     9    95 5.512708e-05 8.104759e-03 0.9810727</span></span>
<span><span class="co">#&gt; 33  0.08888345     2    49 5.713144e-05 8.270673e-03 0.9810727</span></span>
<span><span class="co">#&gt; 34  0.08850681    86    90 6.143363e-05 8.610161e-03 0.9810727</span></span>
<span><span class="co">#&gt; 35  0.08805868    17    53 6.695170e-05 9.015175e-03 0.9810727</span></span>
<span><span class="co">#&gt; 36  0.08790809    28    48 6.890884e-05 9.151291e-03 0.9810727</span></span>
<span><span class="co">#&gt; 37  0.08783471    33    58 6.988211e-05 9.217597e-03 0.9682377</span></span>
<span><span class="co">#&gt; 38 -0.08705796     7    49 8.101244e-05 1.021362e-02 0.9682377</span></span>
<span><span class="co">#&gt; 39  0.08645033    20    46 9.086547e-05 1.102466e-02 0.9682377</span></span>
<span><span class="co">#&gt; 40  0.08609950    48    86 9.705862e-05 1.150392e-02 0.9682377</span></span>
<span><span class="co">#&gt; 41  0.08598769    21    52 9.911458e-05 1.165816e-02 0.9682377</span></span>
<span><span class="co">#&gt; 42  0.08555275    32    95 1.075099e-04 1.226435e-02 0.9682377</span></span>
<span><span class="co">#&gt; 43  0.08548231    17    51 1.089311e-04 1.236337e-02 0.9424721</span></span>
<span><span class="co">#&gt; 44  0.08470370    80    83 1.258659e-04 1.382356e-02 0.9424721</span></span>
<span><span class="co">#&gt; 45  0.08442510    80    82 1.325062e-04 1.437068e-02 0.9174573</span></span>
<span><span class="co">#&gt; 46  0.08271606    80    93 1.810275e-04 1.845632e-02 0.9174573</span></span>
<span><span class="co">#&gt; 47  0.08235175    46    91 1.933329e-04 1.941579e-02 0.9174573</span></span>
<span><span class="co">#&gt; 48  0.08217787    25    95 1.994788e-04 1.988432e-02 0.9174573</span></span>
<span><span class="co">#&gt; 49 -0.08170331    29    87 2.171999e-04 2.119715e-02 0.9174573</span></span>
<span><span class="co">#&gt; 50  0.08123632    19    29 2.360716e-04 2.253606e-02 0.9174573</span></span>
<span><span class="co">#&gt; 51  0.08101702    51    84 2.454547e-04 2.318024e-02 0.9174573</span></span>
<span><span class="co">#&gt; 52  0.08030748    16    93 2.782643e-04 2.532796e-02 0.9174573</span></span>
<span><span class="co">#&gt; 53  0.08006503    28    52 2.903870e-04 2.608271e-02 0.9174573</span></span>
<span><span class="co">#&gt; 54 -0.07941656    41    80 3.252833e-04 2.814824e-02 0.9174573</span></span>
<span><span class="co">#&gt; 55  0.07941410    54    89 3.254229e-04 2.815620e-02 0.9174573</span></span>
<span><span class="co">#&gt; 56 -0.07934653    28    80 3.292784e-04 2.837511e-02 0.9174573</span></span>
<span><span class="co">#&gt; 57  0.07916783    29    92 3.396802e-04 2.895702e-02 0.9174573</span></span>
<span><span class="co">#&gt; 58 -0.07866905    17    86 3.703635e-04 3.060293e-02 0.9174573</span></span>
<span><span class="co">#&gt; 59  0.07827749    16    29 3.962446e-04 3.191462e-02 0.9174573</span></span>
<span><span class="co">#&gt; 60 -0.07808262    73    89 4.097452e-04 3.257290e-02 0.9174573</span></span>
<span><span class="co">#&gt; 61  0.07766261    52    67 4.403165e-04 3.400207e-02 0.9174573</span></span>
<span><span class="co">#&gt; 62  0.07762917    25    87 4.428396e-04 3.411637e-02 0.9174573</span></span>
<span><span class="co">#&gt; 63 -0.07739378     9    93 4.609872e-04 3.492295e-02 0.9174573</span></span>
<span><span class="co">#&gt; 64  0.07738885    31    80 4.613747e-04 3.493988e-02 0.9174573</span></span>
<span><span class="co">#&gt; 65 -0.07718681    80    94 4.775136e-04 3.563444e-02 0.9174573</span></span>
<span></span>
<span><span class="co"># parameters of the mixture distribution used to compute p-values etc.</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu">fdrtool</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fdrtool/man/fdrtool.html" class="external-link">fdrtool</a></span><span class="op">(</span><span class="fu">corpcor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corpcor/man/smtools.html" class="external-link">sm2vec</a></span><span class="op">(</span><span class="va">inferred.pcor</span><span class="op">)</span>, statistic<span class="op">=</span><span class="st">"correlation"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Step 1... determine cutoff point</span></span>
<span><span class="co">#&gt; Step 2... estimate parameters of null distribution and eta0</span></span>
<span><span class="co">#&gt; Step 3... compute p-values and estimate empirical PDF/CDF</span></span>
<span><span class="co">#&gt; Step 4... compute q-values and local fdr</span></span>
<span><span class="co">#&gt; Step 5... prepare for plotting</span></span>
<span><span class="va">c</span><span class="op">$</span><span class="va">param</span></span>
<span><span class="co">#&gt;          cutoff N.cens      eta0     eta0.SE    kappa kappa.SE</span></span>
<span><span class="co">#&gt; [1,] 0.03553068   4352 0.9474623 0.005656465 2043.377 94.72267</span></span>
<span></span>
<span><span class="co">## A random network with 20 nodes and 10 percent (=19) edges</span></span>
<span><span class="va">true.pcor</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/ggm.simulate.pcor.html" class="external-link">ggm.simulate.pcor</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to edge list</span></span>
<span><span class="va">test.results</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/GeneNet-internal.html" class="external-link">ggm.list.edges</a></span><span class="op">(</span><span class="va">true.pcor</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">19</span>,<span class="op">]</span></span>
<span><span class="va">nlab</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># graphviz</span></span>
<span><span class="co"># network.make.dot(filename="test.dot", test.results, nlab, main = "A graph")</span></span>
<span><span class="co"># system("fdp -T svg -o test.svg test.dot")</span></span>
<span></span>
<span><span class="co"># Rgraphviz</span></span>
<span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.make.graph.html" class="external-link">network.make.graph</a></span><span class="op">(</span> <span class="va">test.results</span>, <span class="va">nlab</span><span class="op">)</span></span>
<span><span class="va">gr</span></span>
<span><span class="co">#&gt; A graphNEL graph with directed edges</span></span>
<span><span class="co">#&gt; Number of Nodes = 20 </span></span>
<span><span class="co">#&gt; Number of Edges = 38</span></span>
<span><span class="fu">num.nodes</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="fu">edge.info</span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt;      A~M      A~O      A~D      B~D      B~J      C~H      C~E      D~S </span></span>
<span><span class="co">#&gt; -0.05268 -0.33509 -0.49353  0.20726  0.75167 -0.39474  0.65042  0.46515 </span></span>
<span><span class="co">#&gt;      D~N      E~M      F~L      F~R      G~T      G~R      H~L      J~T </span></span>
<span><span class="co">#&gt; -0.54801 -0.66116 -0.33375 -0.61415 -0.38177  0.55286 -0.17659 -0.00930 </span></span>
<span><span class="co">#&gt;      J~O      K~T      L~P </span></span>
<span><span class="co">#&gt; -0.31225  0.77817 -0.66914 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dir</span></span>
<span><span class="co">#&gt;    A~M    A~O    A~D    B~D    B~J    C~H    C~E    D~S    D~N    E~M    F~L </span></span>
<span><span class="co">#&gt; "none" "none" "none" "none" "none" "none" "none" "none" "none" "none" "none" </span></span>
<span><span class="co">#&gt;    F~R    G~T    G~R    H~L    J~T    J~O    K~T    L~P </span></span>
<span><span class="co">#&gt; "none" "none" "none" "none" "none" "none" "none" "none"</span></span>
<span><span class="va">gr2</span> <span class="op">&lt;-</span> <span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.make.graph.html" class="external-link">network.make.graph</a></span><span class="op">(</span> <span class="va">test.results</span>, <span class="va">nlab</span>, drop.singles<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gr2</span></span>
<span><span class="co">#&gt; A graphNEL graph with directed edges</span></span>
<span><span class="co">#&gt; Number of Nodes = 18 </span></span>
<span><span class="co">#&gt; Number of Edges = 38</span></span>
<span><span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.make.graph.html" class="external-link">num.nodes</a></span><span class="op">(</span><span class="va">gr2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18</span></span>
<span><span class="fu">GeneNet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GeneNet/man/network.make.graph.html" class="external-link">edge.info</a></span><span class="op">(</span><span class="va">gr2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $weight</span></span>
<span><span class="co">#&gt;      A~M      A~O      A~D      B~D      B~J      C~H      C~E      D~S </span></span>
<span><span class="co">#&gt; -0.05268 -0.33509 -0.49353  0.20726  0.75167 -0.39474  0.65042  0.46515 </span></span>
<span><span class="co">#&gt;      D~N      E~M      F~L      F~R      G~T      G~R      H~L      J~T </span></span>
<span><span class="co">#&gt; -0.54801 -0.66116 -0.33375 -0.61415 -0.38177  0.55286 -0.17659 -0.00930 </span></span>
<span><span class="co">#&gt;      J~O      K~T      L~P </span></span>
<span><span class="co">#&gt; -0.31225  0.77817 -0.66914 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dir</span></span>
<span><span class="co">#&gt;    A~M    A~O    A~D    B~D    B~J    C~H    C~E    D~S    D~N    E~M    F~L </span></span>
<span><span class="co">#&gt; "none" "none" "none" "none" "none" "none" "none" "none" "none" "none" "none" </span></span>
<span><span class="co">#&gt;    F~R    G~T    G~R    H~L    J~T    J~O    K~T    L~P </span></span>
<span><span class="co">#&gt; "none" "none" "none" "none" "none" "none" "none" "none"</span></span>
<span></span>
<span><span class="co"># plot network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gr</span>, <span class="st">"fdp"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GeneNet-2"></span>
<img src="bioconductor/GeneNet-2.png" alt="GeneNet example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 7.2: GeneNet example
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gr2</span>, <span class="st">"fdp"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GeneNet-3"></span>
<img src="bioconductor/GeneNet-3.png" alt="GeneNet example" width="672" style="display:block; margin: auto"><p class="caption">
Figure 7.3: GeneNet example
</p>
</div>
<p>A side-by-side heatmaps</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123454321</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2500</span><span class="op">)</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">r</span><span class="op">&gt;=</span><span class="fl">0.7</span><span class="op">)</span><span class="op">+</span><span class="fl">0</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">f1</span><span class="op">+</span><span class="va">f2</span></span>
<span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:heatmap"></span>
<img src="bioconductor/heatmap-1.png" alt="Heatmaps" width="672" style="display:block; margin: auto"><p class="caption">
Figure 7.4: Heatmaps
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">heatmaply</span><span class="fu">::</span><span class="fu"><a href="https://talgalili.github.io/heatmaply/reference/normalize.html" class="external-link">normalize</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu">heatmaply</span><span class="fu">::</span><span class="fu"><a href="https://talgalili.github.io/heatmaply/reference/heatmaply.html" class="external-link">heatmaply</a></span><span class="op">(</span><span class="va">df</span>,k_col<span class="op">=</span><span class="fl">5</span>,k_row<span class="op">=</span><span class="fl">5</span>,</span>
<span>                           colors <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">htmlwidgets</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/htmlwidgets/man/saveWidget.html" class="external-link">saveWidget</a></span><span class="op">(</span><span class="va">hm</span>,file<span class="op">=</span><span class="st">"heatmaply.html"</span><span class="op">)</span></span>
<span><span class="fu">htmltools</span><span class="fu">::</span><span class="va"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">tags</a></span><span class="op">$</span><span class="fu">iframe</span><span class="op">(</span>src <span class="op">=</span> <span class="st">"heatmaply.html"</span>, width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"550px"</span><span class="op">)</span></span></code></pre></div>
<iframe src="heatmaply.html" width="100%" height="550px"></iframe>
<p>so we have <a href="heatmaply.html">heatmaply.html</a> and a module analysis with WGCNA,</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">12</span>, to<span class="op">=</span><span class="fl">30</span>, by<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sft</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/pickSoftThreshold.html" class="external-link">pickSoftThreshold</a></span><span class="op">(</span><span class="va">dat</span>, powerVector<span class="op">=</span><span class="va">pwr</span>, verbose<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">ADJ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat</span>, method<span class="op">=</span><span class="st">"pearson"</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">6</span></span>
<span><span class="va">dissADJ</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">ADJ</span></span>
<span><span class="va">dissTOM</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/TOMsimilarity.html" class="external-link">TOMdist</a></span><span class="op">(</span><span class="va">ADJ</span><span class="op">)</span></span>
<span><span class="va">TOM</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/TOMsimilarityFromExpr.html" class="external-link">TOMsimilarityFromExpr</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">Tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">TOM</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"average"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">pwr</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">pam_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pam"</span>,<span class="va">j</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">pam_name</span>, <span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissADJ</span><span class="op">)</span>,<span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">pamTOM_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pamTOM"</span>,<span class="va">j</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">pamTOM_name</span>,<span class="fu">cluster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">pam</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span>,<span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">pam_name</span><span class="op">)</span><span class="op">$</span><span class="va">clustering</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">pamTOM_name</span><span class="op">)</span><span class="op">$</span><span class="va">clustering</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tc</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">tc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">colorStaticTOM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/cutreeStaticColor.html" class="external-link">cutreeStaticColor</a></span><span class="op">(</span><span class="va">Tree</span>,cutHeight<span class="op">=</span><span class="fl">.99</span>,minSize<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colorDynamicTOM</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/labels2colors.html" class="external-link">labels2colors</a></span><span class="op">(</span><span class="fu">cutreeDynamic</span><span class="op">(</span><span class="va">Tree</span>,method<span class="op">=</span><span class="st">"tree"</span>,minClusterSize<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">pamTOM6</span><span class="op">$</span><span class="va">clustering</span>,<span class="va">colorStaticTOM</span>,<span class="va">colorDynamicTOM</span><span class="op">)</span></span>
<span><span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/plotDendroAndColors.html" class="external-link">plotDendroAndColors</a></span><span class="op">(</span><span class="va">Tree</span>, <span class="va">Colors</span>, dendroLabels<span class="op">=</span><span class="cn">FALSE</span>, hang<span class="op">=</span><span class="fl">0.03</span>, addGuide<span class="op">=</span><span class="cn">TRUE</span>, guideHang<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">meg</span> <span class="op">&lt;-</span> <span class="fu">WGCNA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/moduleEigengenes.html" class="external-link">moduleEigengenes</a></span><span class="op">(</span><span class="va">dat</span>, color<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, softPower<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="8">
<h2 id="metadata">
<span class="header-section-number">8</span> Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h2>
<p>This section is based on package <code>recount3</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu">recount3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/recount3/man/available_projects.html" class="external-link">available_projects</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hs</span>,<span class="va">file_source</span><span class="op">==</span><span class="st">"gtex"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">recount3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/recount3/man/annotation_options.html" class="external-link">annotation_options</a></span><span class="op">(</span><span class="st">"human"</span><span class="op">)</span></span>
<span><span class="va">blood_rse</span> <span class="op">&lt;-</span> <span class="fu">recount3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/recount3/man/create_rse.html" class="external-link">create_rse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">hs</span>,<span class="va">project</span><span class="op">==</span><span class="st">"BLOOD"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">blood_rse</span><span class="op">)</span></span>
<span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu">rowRanges</span><span class="op">(</span><span class="va">blood_rse</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">blood_rse</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="fu">recount3</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/recount3/man/expand_sra_attributes.html" class="external-link">expand_sra_attributes</a></span><span class="op">(</span><span class="va">blood_rse</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="9">
<h2 id="pathway-and-enrichment-analysis">
<span class="header-section-number">9</span> Pathway and enrichment analysis<a class="anchor" aria-label="anchor" href="#pathway-and-enrichment-analysis"></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reactome</span> <span class="op">&lt;-</span> <span class="fu">graphite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphite/man/pathways.html" class="external-link">pathways</a></span><span class="op">(</span><span class="st">"hsapiens"</span>, <span class="st">"reactome"</span><span class="op">)</span></span>
<span><span class="va">kegg</span> <span class="op">&lt;-</span> <span class="fu">graphite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphite/man/pathways.html" class="external-link">pathways</a></span><span class="op">(</span><span class="st">"hsapiens"</span>,<span class="st">"kegg"</span><span class="op">)</span></span>
<span><span class="va">pharmgkb</span> <span class="op">&lt;-</span> <span class="fu">graphite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graphite/man/pathways.html" class="external-link">pathways</a></span><span class="op">(</span><span class="st">"hsapiens"</span>,<span class="st">"pharmgkb"</span><span class="op">)</span></span>
<span><span class="fu">nodes</span><span class="op">(</span><span class="va">kegg</span><span class="op">[[</span><span class="fl">21</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "ENTREZID:102724560" "ENTREZID:10993"     "ENTREZID:113675"   </span></span>
<span><span class="co">#&gt;  [4] "ENTREZID:132158"    "ENTREZID:1610"      "ENTREZID:1738"     </span></span>
<span><span class="co">#&gt;  [7] "ENTREZID:1757"      "ENTREZID:189"       "ENTREZID:211"      </span></span>
<span><span class="co">#&gt; [10] "ENTREZID:212"       "ENTREZID:23464"     "ENTREZID:2593"     </span></span>
<span><span class="co">#&gt; [13] "ENTREZID:26227"     "ENTREZID:2628"      "ENTREZID:27232"    </span></span>
<span><span class="co">#&gt; [16] "ENTREZID:2731"      "ENTREZID:275"       "ENTREZID:29958"    </span></span>
<span><span class="co">#&gt; [19] "ENTREZID:29968"     "ENTREZID:441531"    "ENTREZID:501"      </span></span>
<span><span class="co">#&gt; [22] "ENTREZID:51268"     "ENTREZID:5223"      "ENTREZID:5224"     </span></span>
<span><span class="co">#&gt; [25] "ENTREZID:55349"     "ENTREZID:5723"      "ENTREZID:635"      </span></span>
<span><span class="co">#&gt; [28] "ENTREZID:63826"     "ENTREZID:6470"      "ENTREZID:6472"     </span></span>
<span><span class="co">#&gt; [31] "ENTREZID:64902"     "ENTREZID:669"       "ENTREZID:875"      </span></span>
<span><span class="co">#&gt; [34] "ENTREZID:9380"      "ENTREZID:1491"</span></span>
<span><span class="va">kegg_t2g</span> <span class="op">&lt;-</span> <span class="fu">ldply</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">kegg</span>, <span class="va">nodes</span><span class="op">)</span>, <span class="va">data.frame</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">kegg_t2g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gs_name"</span>, <span class="st">"gene_symbol"</span><span class="op">)</span></span>
<span><span class="va">VEGF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">kegg_t2g</span>,<span class="va">gs_name</span><span class="op">==</span><span class="st">"VEGF signaling pathway"</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">eKEGG</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></span><span class="op">(</span>gene<span class="op">=</span><span class="va">VEGF</span>, TERM2GENE <span class="op">=</span> <span class="va">kegg_t2g</span>,</span>
<span>                                   universe<span class="op">=</span>,</span>
<span>                                   pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>                                   pvalueCutoff <span class="op">=</span> <span class="fl">0.1</span>, qvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                                   minGSSize <span class="op">=</span> <span class="fl">10</span>, maxGSSize <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="10">
<h2 id="transcript-databases">
<span class="header-section-number">10</span> Transcript databases<a class="anchor" aria-label="anchor" href="#transcript-databases"></a>
</h2>
<p>An overview of annotation is available<span class="citation"><sup><a href="#ref-carlson16" role="doc-biblioref">2</a></sup></span>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># columns(org.Hs.eg.db)</span></span>
<span><span class="co"># keyref &lt;- keys(org.Hs.eg.db, keytype="ENTREZID")</span></span>
<span><span class="co"># symbol_uniprot &lt;- select(org.Hs.eg.db,keys=keyref,columns = c("SYMBOL","UNIPROT"))</span></span>
<span><span class="co"># subset(symbol_uniprot,SYMBOL=="MC4R")</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">EnsDb.Hsapiens.v86</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">listColumns</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"protein"</span>, skip.keys<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tx_id"            "protein_id"       "protein_sequence"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">listGenebiotypes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "protein_coding"                     "unitary_pseudogene"                </span></span>
<span><span class="co">#&gt;  [3] "unprocessed_pseudogene"             "processed_pseudogene"              </span></span>
<span><span class="co">#&gt;  [5] "processed_transcript"               "transcribed_unprocessed_pseudogene"</span></span>
<span><span class="co">#&gt;  [7] "antisense"                          "transcribed_unitary_pseudogene"    </span></span>
<span><span class="co">#&gt;  [9] "polymorphic_pseudogene"             "lincRNA"                           </span></span>
<span><span class="co">#&gt; [11] "sense_intronic"                     "transcribed_processed_pseudogene"  </span></span>
<span><span class="co">#&gt; [13] "sense_overlapping"                  "IG_V_pseudogene"                   </span></span>
<span><span class="co">#&gt; [15] "pseudogene"                         "TR_V_gene"                         </span></span>
<span><span class="co">#&gt; [17] "3prime_overlapping_ncRNA"           "IG_V_gene"                         </span></span>
<span><span class="co">#&gt; [19] "bidirectional_promoter_lncRNA"      "snRNA"                             </span></span>
<span><span class="co">#&gt; [21] "miRNA"                              "misc_RNA"                          </span></span>
<span><span class="co">#&gt; [23] "snoRNA"                             "rRNA"                              </span></span>
<span><span class="co">#&gt; [25] "Mt_tRNA"                            "Mt_rRNA"                           </span></span>
<span><span class="co">#&gt; [27] "IG_C_gene"                          "IG_J_gene"                         </span></span>
<span><span class="co">#&gt; [29] "TR_J_gene"                          "TR_C_gene"                         </span></span>
<span><span class="co">#&gt; [31] "TR_V_pseudogene"                    "TR_J_pseudogene"                   </span></span>
<span><span class="co">#&gt; [33] "IG_D_gene"                          "ribozyme"                          </span></span>
<span><span class="co">#&gt; [35] "IG_C_pseudogene"                    "TR_D_gene"                         </span></span>
<span><span class="co">#&gt; [37] "TEC"                                "IG_J_pseudogene"                   </span></span>
<span><span class="co">#&gt; [39] "scRNA"                              "scaRNA"                            </span></span>
<span><span class="co">#&gt; [41] "vaultRNA"                           "sRNA"                              </span></span>
<span><span class="co">#&gt; [43] "macro_lncRNA"                       "non_coding"                        </span></span>
<span><span class="co">#&gt; [45] "IG_pseudogene"                      "LRG_gene"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">listTxbiotypes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "protein_coding"                     "processed_transcript"              </span></span>
<span><span class="co">#&gt;  [3] "nonsense_mediated_decay"            "retained_intron"                   </span></span>
<span><span class="co">#&gt;  [5] "unitary_pseudogene"                 "TEC"                               </span></span>
<span><span class="co">#&gt;  [7] "miRNA"                              "misc_RNA"                          </span></span>
<span><span class="co">#&gt;  [9] "non_stop_decay"                     "unprocessed_pseudogene"            </span></span>
<span><span class="co">#&gt; [11] "processed_pseudogene"               "transcribed_unprocessed_pseudogene"</span></span>
<span><span class="co">#&gt; [13] "lincRNA"                            "antisense"                         </span></span>
<span><span class="co">#&gt; [15] "transcribed_unitary_pseudogene"     "polymorphic_pseudogene"            </span></span>
<span><span class="co">#&gt; [17] "sense_intronic"                     "transcribed_processed_pseudogene"  </span></span>
<span><span class="co">#&gt; [19] "sense_overlapping"                  "IG_V_pseudogene"                   </span></span>
<span><span class="co">#&gt; [21] "pseudogene"                         "TR_V_gene"                         </span></span>
<span><span class="co">#&gt; [23] "3prime_overlapping_ncRNA"           "IG_V_gene"                         </span></span>
<span><span class="co">#&gt; [25] "bidirectional_promoter_lncRNA"      "snRNA"                             </span></span>
<span><span class="co">#&gt; [27] "snoRNA"                             "rRNA"                              </span></span>
<span><span class="co">#&gt; [29] "Mt_tRNA"                            "Mt_rRNA"                           </span></span>
<span><span class="co">#&gt; [31] "IG_C_gene"                          "IG_J_gene"                         </span></span>
<span><span class="co">#&gt; [33] "TR_J_gene"                          "TR_C_gene"                         </span></span>
<span><span class="co">#&gt; [35] "TR_V_pseudogene"                    "TR_J_pseudogene"                   </span></span>
<span><span class="co">#&gt; [37] "IG_D_gene"                          "ribozyme"                          </span></span>
<span><span class="co">#&gt; [39] "IG_C_pseudogene"                    "TR_D_gene"                         </span></span>
<span><span class="co">#&gt; [41] "IG_J_pseudogene"                    "scRNA"                             </span></span>
<span><span class="co">#&gt; [43] "scaRNA"                             "vaultRNA"                          </span></span>
<span><span class="co">#&gt; [45] "sRNA"                               "macro_lncRNA"                      </span></span>
<span><span class="co">#&gt; [47] "non_coding"                         "IG_pseudogene"                     </span></span>
<span><span class="co">#&gt; [49] "LRG_gene"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">listTables</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; $gene</span></span>
<span><span class="co">#&gt; [1] "gene_id"          "gene_name"        "gene_biotype"     "gene_seq_start"  </span></span>
<span><span class="co">#&gt; [5] "gene_seq_end"     "seq_name"         "seq_strand"       "seq_coord_system"</span></span>
<span><span class="co">#&gt; [9] "symbol"          </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tx</span></span>
<span><span class="co">#&gt; [1] "tx_id"            "tx_biotype"       "tx_seq_start"     "tx_seq_end"      </span></span>
<span><span class="co">#&gt; [5] "tx_cds_seq_start" "tx_cds_seq_end"   "gene_id"          "tx_name"         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tx2exon</span></span>
<span><span class="co">#&gt; [1] "tx_id"    "exon_id"  "exon_idx"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $exon</span></span>
<span><span class="co">#&gt; [1] "exon_id"        "exon_seq_start" "exon_seq_end"  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $chromosome</span></span>
<span><span class="co">#&gt; [1] "seq_name"    "seq_length"  "is_circular"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $protein</span></span>
<span><span class="co">#&gt; [1] "tx_id"            "protein_id"       "protein_sequence"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uniprot</span></span>
<span><span class="co">#&gt; [1] "protein_id"           "uniprot_id"           "uniprot_db"          </span></span>
<span><span class="co">#&gt; [4] "uniprot_mapping_type"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $protein_domain</span></span>
<span><span class="co">#&gt; [1] "protein_id"            "protein_domain_id"     "protein_domain_source"</span></span>
<span><span class="co">#&gt; [4] "interpro_accession"    "prot_dom_start"        "prot_dom_end"         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $entrezgene</span></span>
<span><span class="co">#&gt; [1] "gene_id"  "entrezid"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metadata</span></span>
<span><span class="co">#&gt; [1] "name"  "value"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html" class="external-link">metadata</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  name                               value</span></span>
<span><span class="co">#&gt; 1             Db type                               EnsDb</span></span>
<span><span class="co">#&gt; 2     Type of Gene ID                     Ensembl Gene ID</span></span>
<span><span class="co">#&gt; 3  Supporting package                           ensembldb</span></span>
<span><span class="co">#&gt; 4       Db created by ensembldb package from Bioconductor</span></span>
<span><span class="co">#&gt; 5      script_version                               0.3.0</span></span>
<span><span class="co">#&gt; 6       Creation time            Thu May 18 16:32:27 2017</span></span>
<span><span class="co">#&gt; 7     ensembl_version                                  86</span></span>
<span><span class="co">#&gt; 8        ensembl_host                           localhost</span></span>
<span><span class="co">#&gt; 9            Organism                        homo_sapiens</span></span>
<span><span class="co">#&gt; 10        taxonomy_id                                9606</span></span>
<span><span class="co">#&gt; 11       genome_build                              GRCh38</span></span>
<span><span class="co">#&gt; 12    DBSCHEMAVERSION                                 2.0</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/organism_species.html" class="external-link">organism</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Homo sapiens"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">returnFilterColumns</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqinfo</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; Seqinfo object with 357 sequences (1 circular) from GRCh38 genome:</span></span>
<span><span class="co">#&gt;   seqnames seqlengths isCircular genome</span></span>
<span><span class="co">#&gt;   X         156040895      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   20         64444167      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   1         248956422      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   6         170805979      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   3         198295559      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   ...             ...        ...    ...</span></span>
<span><span class="co">#&gt;   LRG_239      114904      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   LRG_311      115492      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   LRG_721       33396      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   LRG_741      231167      FALSE GRCh38</span></span>
<span><span class="co">#&gt;   LRG_93        22459      FALSE GRCh38</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlevels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] "1"                                     </span></span>
<span><span class="co">#&gt;   [2] "10"                                    </span></span>
<span><span class="co">#&gt;   [3] "11"                                    </span></span>
<span><span class="co">#&gt;   [4] "12"                                    </span></span>
<span><span class="co">#&gt;   [5] "13"                                    </span></span>
<span><span class="co">#&gt;   [6] "14"                                    </span></span>
<span><span class="co">#&gt;   [7] "15"                                    </span></span>
<span><span class="co">#&gt;   [8] "16"                                    </span></span>
<span><span class="co">#&gt;   [9] "17"                                    </span></span>
<span><span class="co">#&gt;  [10] "18"                                    </span></span>
<span><span class="co">#&gt;  [11] "19"                                    </span></span>
<span><span class="co">#&gt;  [12] "2"                                     </span></span>
<span><span class="co">#&gt;  [13] "20"                                    </span></span>
<span><span class="co">#&gt;  [14] "21"                                    </span></span>
<span><span class="co">#&gt;  [15] "22"                                    </span></span>
<span><span class="co">#&gt;  [16] "3"                                     </span></span>
<span><span class="co">#&gt;  [17] "4"                                     </span></span>
<span><span class="co">#&gt;  [18] "5"                                     </span></span>
<span><span class="co">#&gt;  [19] "6"                                     </span></span>
<span><span class="co">#&gt;  [20] "7"                                     </span></span>
<span><span class="co">#&gt;  [21] "8"                                     </span></span>
<span><span class="co">#&gt;  [22] "9"                                     </span></span>
<span><span class="co">#&gt;  [23] "CHR_HG107_PATCH"                       </span></span>
<span><span class="co">#&gt;  [24] "CHR_HG126_PATCH"                       </span></span>
<span><span class="co">#&gt;  [25] "CHR_HG1311_PATCH"                      </span></span>
<span><span class="co">#&gt;  [26] "CHR_HG1342_HG2282_PATCH"               </span></span>
<span><span class="co">#&gt;  [27] "CHR_HG1362_PATCH"                      </span></span>
<span><span class="co">#&gt;  [28] "CHR_HG142_HG150_NOVEL_TEST"            </span></span>
<span><span class="co">#&gt;  [29] "CHR_HG151_NOVEL_TEST"                  </span></span>
<span><span class="co">#&gt;  [30] "CHR_HG1651_PATCH"                      </span></span>
<span><span class="co">#&gt;  [31] "CHR_HG1832_PATCH"                      </span></span>
<span><span class="co">#&gt;  [32] "CHR_HG2021_PATCH"                      </span></span>
<span><span class="co">#&gt;  [33] "CHR_HG2022_PATCH"                      </span></span>
<span><span class="co">#&gt;  [34] "CHR_HG2023_PATCH"                      </span></span>
<span><span class="co">#&gt;  [35] "CHR_HG2030_PATCH"                      </span></span>
<span><span class="co">#&gt;  [36] "CHR_HG2058_PATCH"                      </span></span>
<span><span class="co">#&gt;  [37] "CHR_HG2062_PATCH"                      </span></span>
<span><span class="co">#&gt;  [38] "CHR_HG2063_PATCH"                      </span></span>
<span><span class="co">#&gt;  [39] "CHR_HG2066_PATCH"                      </span></span>
<span><span class="co">#&gt;  [40] "CHR_HG2072_PATCH"                      </span></span>
<span><span class="co">#&gt;  [41] "CHR_HG2095_PATCH"                      </span></span>
<span><span class="co">#&gt;  [42] "CHR_HG2104_PATCH"                      </span></span>
<span><span class="co">#&gt;  [43] "CHR_HG2116_PATCH"                      </span></span>
<span><span class="co">#&gt;  [44] "CHR_HG2128_PATCH"                      </span></span>
<span><span class="co">#&gt;  [45] "CHR_HG2191_PATCH"                      </span></span>
<span><span class="co">#&gt;  [46] "CHR_HG2213_PATCH"                      </span></span>
<span><span class="co">#&gt;  [47] "CHR_HG2217_PATCH"                      </span></span>
<span><span class="co">#&gt;  [48] "CHR_HG2232_PATCH"                      </span></span>
<span><span class="co">#&gt;  [49] "CHR_HG2233_PATCH"                      </span></span>
<span><span class="co">#&gt;  [50] "CHR_HG2235_PATCH"                      </span></span>
<span><span class="co">#&gt;  [51] "CHR_HG2239_PATCH"                      </span></span>
<span><span class="co">#&gt;  [52] "CHR_HG2247_PATCH"                      </span></span>
<span><span class="co">#&gt;  [53] "CHR_HG2249_PATCH"                      </span></span>
<span><span class="co">#&gt;  [54] "CHR_HG2288_HG2289_PATCH"               </span></span>
<span><span class="co">#&gt;  [55] "CHR_HG2290_PATCH"                      </span></span>
<span><span class="co">#&gt;  [56] "CHR_HG2291_PATCH"                      </span></span>
<span><span class="co">#&gt;  [57] "CHR_HG2334_PATCH"                      </span></span>
<span><span class="co">#&gt;  [58] "CHR_HG26_PATCH"                        </span></span>
<span><span class="co">#&gt;  [59] "CHR_HG986_PATCH"                       </span></span>
<span><span class="co">#&gt;  [60] "CHR_HSCHR10_1_CTG1"                    </span></span>
<span><span class="co">#&gt;  [61] "CHR_HSCHR10_1_CTG2"                    </span></span>
<span><span class="co">#&gt;  [62] "CHR_HSCHR10_1_CTG3"                    </span></span>
<span><span class="co">#&gt;  [63] "CHR_HSCHR10_1_CTG4"                    </span></span>
<span><span class="co">#&gt;  [64] "CHR_HSCHR10_1_CTG6"                    </span></span>
<span><span class="co">#&gt;  [65] "CHR_HSCHR11_1_CTG1_2"                  </span></span>
<span><span class="co">#&gt;  [66] "CHR_HSCHR11_1_CTG5"                    </span></span>
<span><span class="co">#&gt;  [67] "CHR_HSCHR11_1_CTG6"                    </span></span>
<span><span class="co">#&gt;  [68] "CHR_HSCHR11_1_CTG7"                    </span></span>
<span><span class="co">#&gt;  [69] "CHR_HSCHR11_1_CTG8"                    </span></span>
<span><span class="co">#&gt;  [70] "CHR_HSCHR11_2_CTG1"                    </span></span>
<span><span class="co">#&gt;  [71] "CHR_HSCHR11_2_CTG1_1"                  </span></span>
<span><span class="co">#&gt;  [72] "CHR_HSCHR11_3_CTG1"                    </span></span>
<span><span class="co">#&gt;  [73] "CHR_HSCHR12_1_CTG1"                    </span></span>
<span><span class="co">#&gt;  [74] "CHR_HSCHR12_1_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [75] "CHR_HSCHR12_2_CTG1"                    </span></span>
<span><span class="co">#&gt;  [76] "CHR_HSCHR12_2_CTG2"                    </span></span>
<span><span class="co">#&gt;  [77] "CHR_HSCHR12_2_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [78] "CHR_HSCHR12_3_CTG2"                    </span></span>
<span><span class="co">#&gt;  [79] "CHR_HSCHR12_3_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [80] "CHR_HSCHR12_4_CTG2"                    </span></span>
<span><span class="co">#&gt;  [81] "CHR_HSCHR12_4_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [82] "CHR_HSCHR12_5_CTG2"                    </span></span>
<span><span class="co">#&gt;  [83] "CHR_HSCHR12_5_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [84] "CHR_HSCHR12_6_CTG2_1"                  </span></span>
<span><span class="co">#&gt;  [85] "CHR_HSCHR13_1_CTG1"                    </span></span>
<span><span class="co">#&gt;  [86] "CHR_HSCHR13_1_CTG3"                    </span></span>
<span><span class="co">#&gt;  [87] "CHR_HSCHR13_1_CTG5"                    </span></span>
<span><span class="co">#&gt;  [88] "CHR_HSCHR13_1_CTG8"                    </span></span>
<span><span class="co">#&gt;  [89] "CHR_HSCHR14_1_CTG1"                    </span></span>
<span><span class="co">#&gt;  [90] "CHR_HSCHR14_2_CTG1"                    </span></span>
<span><span class="co">#&gt;  [91] "CHR_HSCHR14_3_CTG1"                    </span></span>
<span><span class="co">#&gt;  [92] "CHR_HSCHR14_7_CTG1"                    </span></span>
<span><span class="co">#&gt;  [93] "CHR_HSCHR15_1_CTG1"                    </span></span>
<span><span class="co">#&gt;  [94] "CHR_HSCHR15_1_CTG3"                    </span></span>
<span><span class="co">#&gt;  [95] "CHR_HSCHR15_1_CTG8"                    </span></span>
<span><span class="co">#&gt;  [96] "CHR_HSCHR15_2_CTG3"                    </span></span>
<span><span class="co">#&gt;  [97] "CHR_HSCHR15_2_CTG8"                    </span></span>
<span><span class="co">#&gt;  [98] "CHR_HSCHR15_3_CTG3"                    </span></span>
<span><span class="co">#&gt;  [99] "CHR_HSCHR15_3_CTG8"                    </span></span>
<span><span class="co">#&gt; [100] "CHR_HSCHR15_4_CTG8"                    </span></span>
<span><span class="co">#&gt; [101] "CHR_HSCHR15_5_CTG8"                    </span></span>
<span><span class="co">#&gt; [102] "CHR_HSCHR15_6_CTG8"                    </span></span>
<span><span class="co">#&gt; [103] "CHR_HSCHR16_1_CTG1"                    </span></span>
<span><span class="co">#&gt; [104] "CHR_HSCHR16_1_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [105] "CHR_HSCHR16_2_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [106] "CHR_HSCHR16_3_CTG1"                    </span></span>
<span><span class="co">#&gt; [107] "CHR_HSCHR16_4_CTG1"                    </span></span>
<span><span class="co">#&gt; [108] "CHR_HSCHR16_4_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [109] "CHR_HSCHR16_5_CTG1"                    </span></span>
<span><span class="co">#&gt; [110] "CHR_HSCHR16_CTG2"                      </span></span>
<span><span class="co">#&gt; [111] "CHR_HSCHR17_10_CTG4"                   </span></span>
<span><span class="co">#&gt; [112] "CHR_HSCHR17_1_CTG1"                    </span></span>
<span><span class="co">#&gt; [113] "CHR_HSCHR17_1_CTG2"                    </span></span>
<span><span class="co">#&gt; [114] "CHR_HSCHR17_1_CTG4"                    </span></span>
<span><span class="co">#&gt; [115] "CHR_HSCHR17_1_CTG5"                    </span></span>
<span><span class="co">#&gt; [116] "CHR_HSCHR17_1_CTG9"                    </span></span>
<span><span class="co">#&gt; [117] "CHR_HSCHR17_2_CTG1"                    </span></span>
<span><span class="co">#&gt; [118] "CHR_HSCHR17_2_CTG2"                    </span></span>
<span><span class="co">#&gt; [119] "CHR_HSCHR17_2_CTG4"                    </span></span>
<span><span class="co">#&gt; [120] "CHR_HSCHR17_2_CTG5"                    </span></span>
<span><span class="co">#&gt; [121] "CHR_HSCHR17_3_CTG2"                    </span></span>
<span><span class="co">#&gt; [122] "CHR_HSCHR17_3_CTG4"                    </span></span>
<span><span class="co">#&gt; [123] "CHR_HSCHR17_4_CTG4"                    </span></span>
<span><span class="co">#&gt; [124] "CHR_HSCHR17_5_CTG4"                    </span></span>
<span><span class="co">#&gt; [125] "CHR_HSCHR17_6_CTG4"                    </span></span>
<span><span class="co">#&gt; [126] "CHR_HSCHR17_7_CTG4"                    </span></span>
<span><span class="co">#&gt; [127] "CHR_HSCHR17_8_CTG4"                    </span></span>
<span><span class="co">#&gt; [128] "CHR_HSCHR17_9_CTG4"                    </span></span>
<span><span class="co">#&gt; [129] "CHR_HSCHR18_1_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [130] "CHR_HSCHR18_1_CTG2_1"                  </span></span>
<span><span class="co">#&gt; [131] "CHR_HSCHR18_2_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [132] "CHR_HSCHR18_2_CTG2"                    </span></span>
<span><span class="co">#&gt; [133] "CHR_HSCHR18_2_CTG2_1"                  </span></span>
<span><span class="co">#&gt; [134] "CHR_HSCHR18_3_CTG2_1"                  </span></span>
<span><span class="co">#&gt; [135] "CHR_HSCHR18_5_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [136] "CHR_HSCHR18_ALT21_CTG2_1"              </span></span>
<span><span class="co">#&gt; [137] "CHR_HSCHR18_ALT2_CTG2_1"               </span></span>
<span><span class="co">#&gt; [138] "CHR_HSCHR19KIR_ABC08_A1_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [139] "CHR_HSCHR19KIR_ABC08_AB_HAP_C_P_CTG3_1"</span></span>
<span><span class="co">#&gt; [140] "CHR_HSCHR19KIR_ABC08_AB_HAP_T_P_CTG3_1"</span></span>
<span><span class="co">#&gt; [141] "CHR_HSCHR19KIR_FH05_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [142] "CHR_HSCHR19KIR_FH05_B_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [143] "CHR_HSCHR19KIR_FH06_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [144] "CHR_HSCHR19KIR_FH06_BA1_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [145] "CHR_HSCHR19KIR_FH08_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [146] "CHR_HSCHR19KIR_FH08_BAX_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [147] "CHR_HSCHR19KIR_FH13_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [148] "CHR_HSCHR19KIR_FH13_BA2_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [149] "CHR_HSCHR19KIR_FH15_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [150] "CHR_HSCHR19KIR_FH15_B_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [151] "CHR_HSCHR19KIR_G085_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [152] "CHR_HSCHR19KIR_G085_BA1_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [153] "CHR_HSCHR19KIR_G248_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [154] "CHR_HSCHR19KIR_G248_BA2_HAP_CTG3_1"    </span></span>
<span><span class="co">#&gt; [155] "CHR_HSCHR19KIR_GRC212_AB_HAP_CTG3_1"   </span></span>
<span><span class="co">#&gt; [156] "CHR_HSCHR19KIR_GRC212_BA1_HAP_CTG3_1"  </span></span>
<span><span class="co">#&gt; [157] "CHR_HSCHR19KIR_LUCE_A_HAP_CTG3_1"      </span></span>
<span><span class="co">#&gt; [158] "CHR_HSCHR19KIR_LUCE_BDEL_HAP_CTG3_1"   </span></span>
<span><span class="co">#&gt; [159] "CHR_HSCHR19KIR_RP5_B_HAP_CTG3_1"       </span></span>
<span><span class="co">#&gt; [160] "CHR_HSCHR19KIR_RSH_A_HAP_CTG3_1"       </span></span>
<span><span class="co">#&gt; [161] "CHR_HSCHR19KIR_RSH_BA2_HAP_CTG3_1"     </span></span>
<span><span class="co">#&gt; [162] "CHR_HSCHR19KIR_T7526_A_HAP_CTG3_1"     </span></span>
<span><span class="co">#&gt; [163] "CHR_HSCHR19KIR_T7526_BDEL_HAP_CTG3_1"  </span></span>
<span><span class="co">#&gt; [164] "CHR_HSCHR19LRC_COX1_CTG3_1"            </span></span>
<span><span class="co">#&gt; [165] "CHR_HSCHR19LRC_COX2_CTG3_1"            </span></span>
<span><span class="co">#&gt; [166] "CHR_HSCHR19LRC_LRC_I_CTG3_1"           </span></span>
<span><span class="co">#&gt; [167] "CHR_HSCHR19LRC_LRC_J_CTG3_1"           </span></span>
<span><span class="co">#&gt; [168] "CHR_HSCHR19LRC_LRC_S_CTG3_1"           </span></span>
<span><span class="co">#&gt; [169] "CHR_HSCHR19LRC_LRC_T_CTG3_1"           </span></span>
<span><span class="co">#&gt; [170] "CHR_HSCHR19LRC_PGF1_CTG3_1"            </span></span>
<span><span class="co">#&gt; [171] "CHR_HSCHR19LRC_PGF2_CTG3_1"            </span></span>
<span><span class="co">#&gt; [172] "CHR_HSCHR19_1_CTG2"                    </span></span>
<span><span class="co">#&gt; [173] "CHR_HSCHR19_1_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [174] "CHR_HSCHR19_2_CTG2"                    </span></span>
<span><span class="co">#&gt; [175] "CHR_HSCHR19_2_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [176] "CHR_HSCHR19_3_CTG2"                    </span></span>
<span><span class="co">#&gt; [177] "CHR_HSCHR19_3_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [178] "CHR_HSCHR19_4_CTG2"                    </span></span>
<span><span class="co">#&gt; [179] "CHR_HSCHR19_4_CTG3_1"                  </span></span>
<span><span class="co">#&gt; [180] "CHR_HSCHR19_5_CTG2"                    </span></span>
<span><span class="co">#&gt; [181] "CHR_HSCHR1_1_CTG11"                    </span></span>
<span><span class="co">#&gt; [182] "CHR_HSCHR1_1_CTG3"                     </span></span>
<span><span class="co">#&gt; [183] "CHR_HSCHR1_1_CTG31"                    </span></span>
<span><span class="co">#&gt; [184] "CHR_HSCHR1_1_CTG32_1"                  </span></span>
<span><span class="co">#&gt; [185] "CHR_HSCHR1_2_CTG3"                     </span></span>
<span><span class="co">#&gt; [186] "CHR_HSCHR1_2_CTG31"                    </span></span>
<span><span class="co">#&gt; [187] "CHR_HSCHR1_2_CTG32_1"                  </span></span>
<span><span class="co">#&gt; [188] "CHR_HSCHR1_3_CTG3"                     </span></span>
<span><span class="co">#&gt; [189] "CHR_HSCHR1_3_CTG31"                    </span></span>
<span><span class="co">#&gt; [190] "CHR_HSCHR1_3_CTG32_1"                  </span></span>
<span><span class="co">#&gt; [191] "CHR_HSCHR1_4_CTG3"                     </span></span>
<span><span class="co">#&gt; [192] "CHR_HSCHR1_4_CTG31"                    </span></span>
<span><span class="co">#&gt; [193] "CHR_HSCHR1_5_CTG3"                     </span></span>
<span><span class="co">#&gt; [194] "CHR_HSCHR1_5_CTG32_1"                  </span></span>
<span><span class="co">#&gt; [195] "CHR_HSCHR1_ALT2_1_CTG32_1"             </span></span>
<span><span class="co">#&gt; [196] "CHR_HSCHR20_1_CTG1"                    </span></span>
<span><span class="co">#&gt; [197] "CHR_HSCHR20_1_CTG2"                    </span></span>
<span><span class="co">#&gt; [198] "CHR_HSCHR20_1_CTG3"                    </span></span>
<span><span class="co">#&gt; [199] "CHR_HSCHR20_1_CTG4"                    </span></span>
<span><span class="co">#&gt; [200] "CHR_HSCHR21_2_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [201] "CHR_HSCHR21_3_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [202] "CHR_HSCHR21_4_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [203] "CHR_HSCHR21_5_CTG2"                    </span></span>
<span><span class="co">#&gt; [204] "CHR_HSCHR21_6_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [205] "CHR_HSCHR21_8_CTG1_1"                  </span></span>
<span><span class="co">#&gt; [206] "CHR_HSCHR22_1_CTG1"                    </span></span>
<span><span class="co">#&gt; [207] "CHR_HSCHR22_1_CTG2"                    </span></span>
<span><span class="co">#&gt; [208] "CHR_HSCHR22_1_CTG3"                    </span></span>
<span><span class="co">#&gt; [209] "CHR_HSCHR22_1_CTG4"                    </span></span>
<span><span class="co">#&gt; [210] "CHR_HSCHR22_1_CTG5"                    </span></span>
<span><span class="co">#&gt; [211] "CHR_HSCHR22_1_CTG6"                    </span></span>
<span><span class="co">#&gt; [212] "CHR_HSCHR22_1_CTG7"                    </span></span>
<span><span class="co">#&gt; [213] "CHR_HSCHR22_2_CTG1"                    </span></span>
<span><span class="co">#&gt; [214] "CHR_HSCHR22_3_CTG1"                    </span></span>
<span><span class="co">#&gt; [215] "CHR_HSCHR22_4_CTG1"                    </span></span>
<span><span class="co">#&gt; [216] "CHR_HSCHR22_5_CTG1"                    </span></span>
<span><span class="co">#&gt; [217] "CHR_HSCHR22_6_CTG1"                    </span></span>
<span><span class="co">#&gt; [218] "CHR_HSCHR22_7_CTG1"                    </span></span>
<span><span class="co">#&gt; [219] "CHR_HSCHR22_8_CTG1"                    </span></span>
<span><span class="co">#&gt; [220] "CHR_HSCHR2_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [221] "CHR_HSCHR2_1_CTG15"                    </span></span>
<span><span class="co">#&gt; [222] "CHR_HSCHR2_1_CTG5"                     </span></span>
<span><span class="co">#&gt; [223] "CHR_HSCHR2_1_CTG7"                     </span></span>
<span><span class="co">#&gt; [224] "CHR_HSCHR2_1_CTG7_2"                   </span></span>
<span><span class="co">#&gt; [225] "CHR_HSCHR2_2_CTG1"                     </span></span>
<span><span class="co">#&gt; [226] "CHR_HSCHR2_2_CTG15"                    </span></span>
<span><span class="co">#&gt; [227] "CHR_HSCHR2_2_CTG7"                     </span></span>
<span><span class="co">#&gt; [228] "CHR_HSCHR2_2_CTG7_2"                   </span></span>
<span><span class="co">#&gt; [229] "CHR_HSCHR2_3_CTG1"                     </span></span>
<span><span class="co">#&gt; [230] "CHR_HSCHR2_3_CTG15"                    </span></span>
<span><span class="co">#&gt; [231] "CHR_HSCHR2_3_CTG7_2"                   </span></span>
<span><span class="co">#&gt; [232] "CHR_HSCHR2_4_CTG1"                     </span></span>
<span><span class="co">#&gt; [233] "CHR_HSCHR2_6_CTG7_2"                   </span></span>
<span><span class="co">#&gt; [234] "CHR_HSCHR3_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [235] "CHR_HSCHR3_1_CTG2_1"                   </span></span>
<span><span class="co">#&gt; [236] "CHR_HSCHR3_1_CTG3"                     </span></span>
<span><span class="co">#&gt; [237] "CHR_HSCHR3_2_CTG2_1"                   </span></span>
<span><span class="co">#&gt; [238] "CHR_HSCHR3_2_CTG3"                     </span></span>
<span><span class="co">#&gt; [239] "CHR_HSCHR3_3_CTG1"                     </span></span>
<span><span class="co">#&gt; [240] "CHR_HSCHR3_3_CTG3"                     </span></span>
<span><span class="co">#&gt; [241] "CHR_HSCHR3_4_CTG2_1"                   </span></span>
<span><span class="co">#&gt; [242] "CHR_HSCHR3_4_CTG3"                     </span></span>
<span><span class="co">#&gt; [243] "CHR_HSCHR3_5_CTG2_1"                   </span></span>
<span><span class="co">#&gt; [244] "CHR_HSCHR3_5_CTG3"                     </span></span>
<span><span class="co">#&gt; [245] "CHR_HSCHR3_6_CTG3"                     </span></span>
<span><span class="co">#&gt; [246] "CHR_HSCHR3_7_CTG3"                     </span></span>
<span><span class="co">#&gt; [247] "CHR_HSCHR3_8_CTG3"                     </span></span>
<span><span class="co">#&gt; [248] "CHR_HSCHR3_9_CTG3"                     </span></span>
<span><span class="co">#&gt; [249] "CHR_HSCHR4_11_CTG12"                   </span></span>
<span><span class="co">#&gt; [250] "CHR_HSCHR4_1_CTG12"                    </span></span>
<span><span class="co">#&gt; [251] "CHR_HSCHR4_1_CTG4"                     </span></span>
<span><span class="co">#&gt; [252] "CHR_HSCHR4_1_CTG6"                     </span></span>
<span><span class="co">#&gt; [253] "CHR_HSCHR4_1_CTG9"                     </span></span>
<span><span class="co">#&gt; [254] "CHR_HSCHR4_2_CTG12"                    </span></span>
<span><span class="co">#&gt; [255] "CHR_HSCHR4_2_CTG4"                     </span></span>
<span><span class="co">#&gt; [256] "CHR_HSCHR4_3_CTG12"                    </span></span>
<span><span class="co">#&gt; [257] "CHR_HSCHR4_4_CTG12"                    </span></span>
<span><span class="co">#&gt; [258] "CHR_HSCHR4_5_CTG12"                    </span></span>
<span><span class="co">#&gt; [259] "CHR_HSCHR4_6_CTG12"                    </span></span>
<span><span class="co">#&gt; [260] "CHR_HSCHR4_7_CTG12"                    </span></span>
<span><span class="co">#&gt; [261] "CHR_HSCHR4_8_CTG12"                    </span></span>
<span><span class="co">#&gt; [262] "CHR_HSCHR4_9_CTG12"                    </span></span>
<span><span class="co">#&gt; [263] "CHR_HSCHR5_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [264] "CHR_HSCHR5_1_CTG1_1"                   </span></span>
<span><span class="co">#&gt; [265] "CHR_HSCHR5_1_CTG5"                     </span></span>
<span><span class="co">#&gt; [266] "CHR_HSCHR5_2_CTG1"                     </span></span>
<span><span class="co">#&gt; [267] "CHR_HSCHR5_2_CTG1_1"                   </span></span>
<span><span class="co">#&gt; [268] "CHR_HSCHR5_2_CTG5"                     </span></span>
<span><span class="co">#&gt; [269] "CHR_HSCHR5_3_CTG1"                     </span></span>
<span><span class="co">#&gt; [270] "CHR_HSCHR5_3_CTG5"                     </span></span>
<span><span class="co">#&gt; [271] "CHR_HSCHR5_4_CTG1"                     </span></span>
<span><span class="co">#&gt; [272] "CHR_HSCHR5_4_CTG1_1"                   </span></span>
<span><span class="co">#&gt; [273] "CHR_HSCHR5_5_CTG1"                     </span></span>
<span><span class="co">#&gt; [274] "CHR_HSCHR5_6_CTG1"                     </span></span>
<span><span class="co">#&gt; [275] "CHR_HSCHR5_7_CTG1"                     </span></span>
<span><span class="co">#&gt; [276] "CHR_HSCHR6_1_CTG10"                    </span></span>
<span><span class="co">#&gt; [277] "CHR_HSCHR6_1_CTG2"                     </span></span>
<span><span class="co">#&gt; [278] "CHR_HSCHR6_1_CTG3"                     </span></span>
<span><span class="co">#&gt; [279] "CHR_HSCHR6_1_CTG4"                     </span></span>
<span><span class="co">#&gt; [280] "CHR_HSCHR6_1_CTG5"                     </span></span>
<span><span class="co">#&gt; [281] "CHR_HSCHR6_1_CTG6"                     </span></span>
<span><span class="co">#&gt; [282] "CHR_HSCHR6_1_CTG7"                     </span></span>
<span><span class="co">#&gt; [283] "CHR_HSCHR6_1_CTG8"                     </span></span>
<span><span class="co">#&gt; [284] "CHR_HSCHR6_1_CTG9"                     </span></span>
<span><span class="co">#&gt; [285] "CHR_HSCHR6_8_CTG1"                     </span></span>
<span><span class="co">#&gt; [286] "CHR_HSCHR6_MHC_APD_CTG1"               </span></span>
<span><span class="co">#&gt; [287] "CHR_HSCHR6_MHC_COX_CTG1"               </span></span>
<span><span class="co">#&gt; [288] "CHR_HSCHR6_MHC_DBB_CTG1"               </span></span>
<span><span class="co">#&gt; [289] "CHR_HSCHR6_MHC_MANN_CTG1"              </span></span>
<span><span class="co">#&gt; [290] "CHR_HSCHR6_MHC_MCF_CTG1"               </span></span>
<span><span class="co">#&gt; [291] "CHR_HSCHR6_MHC_QBL_CTG1"               </span></span>
<span><span class="co">#&gt; [292] "CHR_HSCHR6_MHC_SSTO_CTG1"              </span></span>
<span><span class="co">#&gt; [293] "CHR_HSCHR7_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [294] "CHR_HSCHR7_1_CTG4_4"                   </span></span>
<span><span class="co">#&gt; [295] "CHR_HSCHR7_1_CTG6"                     </span></span>
<span><span class="co">#&gt; [296] "CHR_HSCHR7_1_CTG7"                     </span></span>
<span><span class="co">#&gt; [297] "CHR_HSCHR7_2_CTG1"                     </span></span>
<span><span class="co">#&gt; [298] "CHR_HSCHR7_2_CTG4_4"                   </span></span>
<span><span class="co">#&gt; [299] "CHR_HSCHR7_2_CTG6"                     </span></span>
<span><span class="co">#&gt; [300] "CHR_HSCHR7_2_CTG7"                     </span></span>
<span><span class="co">#&gt; [301] "CHR_HSCHR7_3_CTG6"                     </span></span>
<span><span class="co">#&gt; [302] "CHR_HSCHR8_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [303] "CHR_HSCHR8_1_CTG6"                     </span></span>
<span><span class="co">#&gt; [304] "CHR_HSCHR8_1_CTG7"                     </span></span>
<span><span class="co">#&gt; [305] "CHR_HSCHR8_2_CTG1"                     </span></span>
<span><span class="co">#&gt; [306] "CHR_HSCHR8_2_CTG7"                     </span></span>
<span><span class="co">#&gt; [307] "CHR_HSCHR8_3_CTG1"                     </span></span>
<span><span class="co">#&gt; [308] "CHR_HSCHR8_3_CTG7"                     </span></span>
<span><span class="co">#&gt; [309] "CHR_HSCHR8_4_CTG1"                     </span></span>
<span><span class="co">#&gt; [310] "CHR_HSCHR8_4_CTG7"                     </span></span>
<span><span class="co">#&gt; [311] "CHR_HSCHR8_5_CTG1"                     </span></span>
<span><span class="co">#&gt; [312] "CHR_HSCHR8_5_CTG7"                     </span></span>
<span><span class="co">#&gt; [313] "CHR_HSCHR8_6_CTG1"                     </span></span>
<span><span class="co">#&gt; [314] "CHR_HSCHR8_7_CTG1"                     </span></span>
<span><span class="co">#&gt; [315] "CHR_HSCHR8_8_CTG1"                     </span></span>
<span><span class="co">#&gt; [316] "CHR_HSCHR8_9_CTG1"                     </span></span>
<span><span class="co">#&gt; [317] "CHR_HSCHR9_1_CTG1"                     </span></span>
<span><span class="co">#&gt; [318] "CHR_HSCHR9_1_CTG2"                     </span></span>
<span><span class="co">#&gt; [319] "CHR_HSCHR9_1_CTG3"                     </span></span>
<span><span class="co">#&gt; [320] "CHR_HSCHR9_1_CTG4"                     </span></span>
<span><span class="co">#&gt; [321] "CHR_HSCHR9_1_CTG5"                     </span></span>
<span><span class="co">#&gt; [322] "CHR_HSCHR9_1_CTG6"                     </span></span>
<span><span class="co">#&gt; [323] "CHR_HSCHRX_1_CTG3"                     </span></span>
<span><span class="co">#&gt; [324] "CHR_HSCHRX_2_CTG12"                    </span></span>
<span><span class="co">#&gt; [325] "CHR_HSCHRX_2_CTG3"                     </span></span>
<span><span class="co">#&gt; [326] "GL000009.2"                            </span></span>
<span><span class="co">#&gt; [327] "GL000194.1"                            </span></span>
<span><span class="co">#&gt; [328] "GL000195.1"                            </span></span>
<span><span class="co">#&gt; [329] "GL000205.2"                            </span></span>
<span><span class="co">#&gt; [330] "GL000213.1"                            </span></span>
<span><span class="co">#&gt; [331] "GL000216.2"                            </span></span>
<span><span class="co">#&gt; [332] "GL000218.1"                            </span></span>
<span><span class="co">#&gt; [333] "GL000219.1"                            </span></span>
<span><span class="co">#&gt; [334] "GL000220.1"                            </span></span>
<span><span class="co">#&gt; [335] "GL000225.1"                            </span></span>
<span><span class="co">#&gt; [336] "KI270442.1"                            </span></span>
<span><span class="co">#&gt; [337] "KI270711.1"                            </span></span>
<span><span class="co">#&gt; [338] "KI270713.1"                            </span></span>
<span><span class="co">#&gt; [339] "KI270721.1"                            </span></span>
<span><span class="co">#&gt; [340] "KI270726.1"                            </span></span>
<span><span class="co">#&gt; [341] "KI270727.1"                            </span></span>
<span><span class="co">#&gt; [342] "KI270728.1"                            </span></span>
<span><span class="co">#&gt; [343] "KI270731.1"                            </span></span>
<span><span class="co">#&gt; [344] "KI270733.1"                            </span></span>
<span><span class="co">#&gt; [345] "KI270734.1"                            </span></span>
<span><span class="co">#&gt; [346] "KI270744.1"                            </span></span>
<span><span class="co">#&gt; [347] "KI270750.1"                            </span></span>
<span><span class="co">#&gt; [348] "LRG_183"                               </span></span>
<span><span class="co">#&gt; [349] "LRG_187"                               </span></span>
<span><span class="co">#&gt; [350] "LRG_239"                               </span></span>
<span><span class="co">#&gt; [351] "LRG_311"                               </span></span>
<span><span class="co">#&gt; [352] "LRG_721"                               </span></span>
<span><span class="co">#&gt; [353] "LRG_741"                               </span></span>
<span><span class="co">#&gt; [354] "LRG_93"                                </span></span>
<span><span class="co">#&gt; [355] "MT"                                    </span></span>
<span><span class="co">#&gt; [356] "X"                                     </span></span>
<span><span class="co">#&gt; [357] "Y"</span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">updateEnsDb</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; EnsDb for Ensembl:</span></span>
<span><span class="co">#&gt; |Backend: SQLite</span></span>
<span><span class="co">#&gt; |Db type: EnsDb</span></span>
<span><span class="co">#&gt; |Type of Gene ID: Ensembl Gene ID</span></span>
<span><span class="co">#&gt; |Supporting package: ensembldb</span></span>
<span><span class="co">#&gt; |Db created by: ensembldb package from Bioconductor</span></span>
<span><span class="co">#&gt; |script_version: 0.3.0</span></span>
<span><span class="co">#&gt; |Creation time: Thu May 18 16:32:27 2017</span></span>
<span><span class="co">#&gt; |ensembl_version: 86</span></span>
<span><span class="co">#&gt; |ensembl_host: localhost</span></span>
<span><span class="co">#&gt; |Organism: homo_sapiens</span></span>
<span><span class="co">#&gt; |taxonomy_id: 9606</span></span>
<span><span class="co">#&gt; |genome_build: GRCh38</span></span>
<span><span class="co">#&gt; |DBSCHEMAVERSION: 2.0</span></span>
<span><span class="co">#&gt; | No. of genes: 63970.</span></span>
<span><span class="co">#&gt; | No. of transcripts: 216741.</span></span>
<span><span class="co">#&gt; |Protein data available.</span></span>
<span></span>
<span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcripts.html" class="external-link">genes</a></span><span class="op">(</span><span class="va">x</span>, columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene_name"</span><span class="op">)</span>,</span>
<span>             filter<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">SeqNameFilter</span><span class="op">(</span><span class="st">"X"</span><span class="op">)</span>, <span class="fu">AnnotationFilter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationFilter/man/AnnotationFilter.html" class="external-link">GeneBiotypeFilter</a></span><span class="op">(</span><span class="st">"protein_coding"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 841 ranges and 3 metadata columns:</span></span>
<span><span class="co">#&gt;                   seqnames              ranges strand |   gene_name</span></span>
<span><span class="co">#&gt;                      &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></span>
<span><span class="co">#&gt;   ENSG00000182378        X       276322-303356      + |      PLCXD1</span></span>
<span><span class="co">#&gt;   ENSG00000178605        X       304529-318819      - |      GTPBP6</span></span>
<span><span class="co">#&gt;   ENSG00000167393        X       333963-386955      - |     PPP2R3B</span></span>
<span><span class="co">#&gt;   ENSG00000185960        X       624344-659411      + |        SHOX</span></span>
<span><span class="co">#&gt;   ENSG00000205755        X     1187549-1212750      - |       CRLF2</span></span>
<span><span class="co">#&gt;               ...      ...                 ...    ... .         ...</span></span>
<span><span class="co">#&gt;   ENSG00000277745        X 155459415-155460005      - |      H2AFB3</span></span>
<span><span class="co">#&gt;   ENSG00000185973        X 155490115-155669944      - |       TMLHE</span></span>
<span><span class="co">#&gt;   ENSG00000168939        X 155767812-155782459      + |       SPRY3</span></span>
<span><span class="co">#&gt;   ENSG00000124333        X 155881293-155943769      + |       VAMP7</span></span>
<span><span class="co">#&gt;   ENSG00000124334        X 155997581-156010817      + |        IL9R</span></span>
<span><span class="co">#&gt;                         gene_id  gene_biotype</span></span>
<span><span class="co">#&gt;                     &lt;character&gt;   &lt;character&gt;</span></span>
<span><span class="co">#&gt;   ENSG00000182378 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000178605 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000167393 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000185960 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000205755 ENSG000002... protein_co...</span></span>
<span><span class="co">#&gt;               ...           ...           ...</span></span>
<span><span class="co">#&gt;   ENSG00000277745 ENSG000002... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000185973 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000168939 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000124333 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   ENSG00000124334 ENSG000001... protein_co...</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 1 sequence from GRCh38 genome</span></span>
<span><span class="fu">ensembldb</span> <span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/transcripts.html" class="external-link">transcripts</a></span><span class="op">(</span><span class="va">x</span>, columns<span class="op">=</span><span class="fu">ensembldb</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">listColumns</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tx"</span><span class="op">)</span>,</span>
<span>                        filter <span class="op">=</span> <span class="fu">AnnotationFilter</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationFilter/man/AnnotationFilterList.html" class="external-link">AnnotationFilterList</a></span><span class="op">(</span><span class="op">)</span>, order.type <span class="op">=</span> <span class="st">"asc"</span>, return.type <span class="op">=</span> <span class="st">"GRanges"</span><span class="op">)</span></span>
<span><span class="co">#&gt; GRanges object with 216741 ranges and 6 metadata columns:</span></span>
<span><span class="co">#&gt;                   seqnames            ranges strand |         tx_id</span></span>
<span><span class="co">#&gt;                      &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |   &lt;character&gt;</span></span>
<span><span class="co">#&gt;   ENST00000456328        1       11869-14409      + | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000450305        1       12010-13670      + | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000488147        1       14404-29570      - | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000619216        1       17369-17436      - | ENST000006...</span></span>
<span><span class="co">#&gt;   ENST00000473358        1       29554-31097      + | ENST000004...</span></span>
<span><span class="co">#&gt;               ...      ...               ...    ... .           ...</span></span>
<span><span class="co">#&gt;   ENST00000420810        Y 26549425-26549743      + | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000456738        Y 26586642-26591601      - | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000435945        Y 26594851-26634652      - | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000435741        Y 26626520-26627159      - | ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000431853        Y 56855244-56855488      + | ENST000004...</span></span>
<span><span class="co">#&gt;                      tx_biotype tx_cds_seq_start tx_cds_seq_end       gene_id</span></span>
<span><span class="co">#&gt;                     &lt;character&gt;        &lt;integer&gt;      &lt;integer&gt;   &lt;character&gt;</span></span>
<span><span class="co">#&gt;   ENST00000456328 processed_...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000450305 transcribe...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000488147 unprocesse...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000619216         miRNA             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000473358       lincRNA             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;               ...           ...              ...            ...           ...</span></span>
<span><span class="co">#&gt;   ENST00000420810 processed_...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000456738 unprocesse...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000435945 unprocesse...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000435741 processed_...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;   ENST00000431853 processed_...             &lt;NA&gt;           &lt;NA&gt; ENSG000002...</span></span>
<span><span class="co">#&gt;                         tx_name</span></span>
<span><span class="co">#&gt;                     &lt;character&gt;</span></span>
<span><span class="co">#&gt;   ENST00000456328 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000450305 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000488147 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000619216 ENST000006...</span></span>
<span><span class="co">#&gt;   ENST00000473358 ENST000004...</span></span>
<span><span class="co">#&gt;               ...           ...</span></span>
<span><span class="co">#&gt;   ENST00000420810 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000456738 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000435945 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000435741 ENST000004...</span></span>
<span><span class="co">#&gt;   ENST00000431853 ENST000004...</span></span>
<span><span class="co">#&gt;   -------</span></span>
<span><span class="co">#&gt;   seqinfo: 357 sequences (1 circular) from GRCh38 genome</span></span>
<span></span>
<span><span class="va">txdbEnsemblGRCh38</span> <span class="op">&lt;-</span> <span class="fu">GenomicFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicFeatures/man/makeTxDbFromEnsembl.html" class="external-link">makeTxDbFromEnsembl</a></span><span class="op">(</span>organism<span class="op">=</span><span class="st">"Homo sapiens"</span>, release<span class="op">=</span><span class="fl">98</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in call_fun_in_txdbmaker("makeTxDbFromEnsembl", ...): makeTxDbFromEnsembl() has moved to the txdbmaker package. Please call</span></span>
<span><span class="co">#&gt;   txdbmaker::makeTxDbFromEnsembl() to get rid of this warning.</span></span>
<span><span class="co">#&gt; Fetch transcripts and genes from Ensembl ... OK</span></span>
<span><span class="co">#&gt;   (fetched 250194 transcripts from 67946 genes)</span></span>
<span><span class="co">#&gt; Fetch exons and CDS from Ensembl ... OK</span></span>
<span><span class="co">#&gt; Fetch chromosome names and lengths from Ensembl ...OK</span></span>
<span><span class="co">#&gt; Gather the metadata ... OK</span></span>
<span><span class="co">#&gt; Make the TxDb object ... OK</span></span>
<span><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">txdbEnsemblGRCh38</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">txdb</span>,<span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $transcripts</span></span>
<span><span class="co">#&gt;   tx_id         tx_name        tx_type        tx_chrom tx_strand tx_start</span></span>
<span><span class="co">#&gt; 1     1 ENST00000636745         lncRNA CHR_HG107_PATCH         +  1049876</span></span>
<span><span class="co">#&gt; 2     2 ENST00000636387         lncRNA CHR_HG107_PATCH         +  1052607</span></span>
<span><span class="co">#&gt; 3     3 ENST00000643422 protein_coding CHR_HG107_PATCH         +  1075018</span></span>
<span><span class="co">#&gt; 4     4 ENST00000645631 protein_coding CHR_HG107_PATCH         +  1075018</span></span>
<span><span class="co">#&gt; 5     5 ENST00000636567 protein_coding CHR_HG107_PATCH         +  1159911</span></span>
<span><span class="co">#&gt; 6     6 ENST00000636545 protein_coding CHR_HG107_PATCH         -  1012823</span></span>
<span><span class="co">#&gt;    tx_end</span></span>
<span><span class="co">#&gt; 1 1055745</span></span>
<span><span class="co">#&gt; 2 1055745</span></span>
<span><span class="co">#&gt; 3 1112365</span></span>
<span><span class="co">#&gt; 4 1112365</span></span>
<span><span class="co">#&gt; 5 1203106</span></span>
<span><span class="co">#&gt; 6 1036718</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $splicings</span></span>
<span><span class="co">#&gt;   tx_id exon_rank exon_id       exon_name      exon_chrom exon_strand</span></span>
<span><span class="co">#&gt; 1     1         1       1 ENSE00003797146 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt; 2     1         2       2 ENSE00003795151 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt; 3     1         3       4 ENSE00003793692 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt; 4     1         4       5 ENSE00003797325 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt; 5     2         1       3 ENSE00003798310 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt; 6     3         1       6 ENSE00003815958 CHR_HG107_PATCH           +</span></span>
<span><span class="co">#&gt;   exon_start exon_end cds_id        cds_name cds_start cds_end</span></span>
<span><span class="co">#&gt; 1    1049876  1049958     NA            &lt;NA&gt;        NA      NA</span></span>
<span><span class="co">#&gt; 2    1051619  1051839     NA            &lt;NA&gt;        NA      NA</span></span>
<span><span class="co">#&gt; 3    1054235  1054388     NA            &lt;NA&gt;        NA      NA</span></span>
<span><span class="co">#&gt; 4    1055110  1055745     NA            &lt;NA&gt;        NA      NA</span></span>
<span><span class="co">#&gt; 5    1052607  1055745     NA            &lt;NA&gt;        NA      NA</span></span>
<span><span class="co">#&gt; 6    1075018  1075093      1 ENSP00000494473   1075018 1075093</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $genes</span></span>
<span><span class="co">#&gt;   tx_id         gene_id</span></span>
<span><span class="co">#&gt; 1     1 ENSG00000283640</span></span>
<span><span class="co">#&gt; 2     2 ENSG00000283640</span></span>
<span><span class="co">#&gt; 3     3 ENSG00000284971</span></span>
<span><span class="co">#&gt; 4     4 ENSG00000284971</span></span>
<span><span class="co">#&gt; 5     5 ENSG00000283158</span></span>
<span><span class="co">#&gt; 6     6 ENSG00000283350</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $chrominfo</span></span>
<span><span class="co">#&gt;              chrom    length is_circular</span></span>
<span><span class="co">#&gt; 1  CHR_HG107_PATCH 135088590          NA</span></span>
<span><span class="co">#&gt; 2  CHR_HG109_PATCH  58617934          NA</span></span>
<span><span class="co">#&gt; 3  CHR_HG126_PATCH 198295908          NA</span></span>
<span><span class="co">#&gt; 4 CHR_HG1277_PATCH 133754853          NA</span></span>
<span><span class="co">#&gt; 5 CHR_HG1296_PATCH 190208697          NA</span></span>
<span><span class="co">#&gt; 6 CHR_HG1298_PATCH 190196285          NA</span></span>
<span></span>
<span><span class="va">txdb</span> <span class="op">&lt;-</span> <span class="va">TxDb.Hsapiens.UCSC.hg38.knownGene</span></span>
<span></span>
<span><span class="co"># liverExprs &lt;- quantifyExpressionsFromBWs(txdb = txdb,BWfiles=,experimentalDesign=)</span></span></code></pre></div>
</div>
<div class="section level2" number="11">
<h2 id="spectrum-data-analysis">
<span class="header-section-number">11</span> Spectrum data analysis<a class="anchor" aria-label="anchor" href="#spectrum-data-analysis"></a>
</h2>
<p>This section collects notes on peptide/protein analysis, especially with respect to spectrum data.</p>
<div class="section level3" number="11.1">
<h3 id="peptide-sequence">
<span class="header-section-number">11.1</span> Peptide sequence<a class="anchor" aria-label="anchor" href="#peptide-sequence"></a>
</h3>
<p>Here is an example for PROC_HUMAN, which is handled by the <code>Biostrings</code> package,</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fasta_file_path</span> <span class="op">&lt;-</span> <span class="st">'https://rest.uniprot.org/uniprotkb/P04070.fasta'</span></span>
<span><span class="va">fasta_sequences</span> <span class="op">&lt;-</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readAAStringSet</a></span><span class="op">(</span><span class="va">fasta_file_path</span>, format <span class="op">=</span> <span class="st">"fasta"</span><span class="op">)</span></span>
<span><span class="va">AA_sequence</span> <span class="op">&lt;-</span> <span class="va">fasta_sequences</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sequence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString</a></span><span class="op">(</span><span class="va">AA_sequence</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="va">iso_442688365</span> <span class="op">&lt;-</span> <span class="st">'TDGEGALSEPSATVTIEELAAPPPPVLMHHGESSQVLHPGNK'</span></span>
<span><span class="va">match_position</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">regexpr</a></span><span class="op">(</span><span class="va">iso_442688365</span>, <span class="va">AA_sequence</span><span class="op">)</span></span>
<span><span class="va">match_position</span></span>
<span><span class="va">mp</span> <span class="op">&lt;-</span> <span class="fu">matchPattern</span><span class="op">(</span><span class="va">iso_442688365</span>,<span class="va">AA_sequence</span><span class="op">)</span></span>
<span><span class="va">mp</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"~/pQTLtools/tests/PROC.rda"</span><span class="op">)</span></span>
<span><span class="fu">pQTLtools</span><span class="fu">::</span><span class="fu"><a href="../reference/peptideAssociationPlot.html">peptideAssociationPlot</a></span><span class="op">(</span><span class="va">protein</span>,<span class="va">cistrans</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(Modified.Peptide.Sequence)`</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:a1bg"></span>
<img src="bioconductor/a1bg-1.png" alt="peptide association plot" width="960" style="display:block; margin: auto"><p class="caption">
Figure 11.1: peptide association plot
</p>
</div>
</div>
<div class="section level3" number="11.2">
<h3 id="spectrum-data-analysis-1">
<span class="header-section-number">11.2</span> Spectrum data analysis<a class="anchor" aria-label="anchor" href="#spectrum-data-analysis-1"></a>
</h3>
<div class="section level4" number="11.2.1">
<h4 id="setup">
<span class="header-section-number">11.2.1</span> Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h4>
<p>The .raw files can be handled by <code>rawrr</code> package nevertheless it requires necessary files,</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fgcz/rawrr/" class="external-link">rawrr</a></span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="fu">rawrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rawrr/man/dot-checkDllInMonoPath.html" class="external-link">.checkDllInMonoPath</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="fu">rawrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rawrr/man/installRawFileReaderDLLs.html" class="external-link">installRawFileReaderDLLs</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isFALSE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu">rawrr</span><span class="fu">:::</span><span class="fu">.rawrrAssembly</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="fu">rawrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rawrr/man/installRawrrExe.html" class="external-link">installRawrrExe</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4" number="11.2.2">
<h4 id="list-of-raw-files">
<span class="header-section-number">11.2.2</span> List of.raw files<a class="anchor" aria-label="anchor" href="#list-of-raw-files"></a>
</h4>
<p>Based on a real project, the following is an example of listing/generating multiple .raw from .zip files</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ZWK .raw data</span></span>
<span><span class="va">spectra_ZWK</span> <span class="op">&lt;-</span> <span class="st">"~/Caprion/pre_qc_data/spectral_library_ZWK"</span></span>
<span><span class="va">raw_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">spectra_ZWK</span>, pattern <span class="op">=</span> <span class="st">"\\.raw$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## collectively</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fgcz/MsBackendRawFileReader" class="external-link">MsBackendRawFileReader</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ZWK</span> <span class="op">&lt;-</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize</a></span><span class="op">(</span><span class="fu">MsBackendRawFileReader</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MsBackendRawFileReader/man/MsBackendRawFileReader.html" class="external-link">MsBackendRawFileReader</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       files <span class="op">=</span> <span class="va">raw_files</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ZWK</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ZWK</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="va">ZWK</span><span class="op">)</span></span>
<span><span class="fu">spectraData</span><span class="op">(</span><span class="va">ZWK</span><span class="op">)</span></span>
<span><span class="va">ZWK</span></span>
<span><span class="va">ZWKvars</span> <span class="op">&lt;-</span> <span class="va">ZWK</span> <span class="op">|&gt;</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu">spectraVariables</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ZWKdata</span> <span class="op">&lt;-</span> <span class="va">ZWK</span> <span class="op">|&gt;</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu">spectraData</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ZWKdata</span><span class="op">)</span></span>
<span><span class="co"># rows with &gt;=1 non-NA value in the columns with prefix "precursor"</span></span>
<span><span class="va">precursor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">ZWKdata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"precursor"</span>,<span class="va">ZWKvars</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ZWKdata_filtered</span> <span class="op">&lt;-</span> <span class="va">ZWKdata</span><span class="op">[</span><span class="va">precursor</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">ZWK</span>,file<span class="op">=</span><span class="st">"~/Caprion/analysis/work/ZWK.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ZYQ/UDP</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span>
<span><span class="va">spectra</span> <span class="op">&lt;-</span> <span class="st">"~/Caprion/pre_qc_data/spectra"</span></span>
<span><span class="va">zip_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">spectra</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">work_dir</span> <span class="op">&lt;-</span> <span class="st">"~/Caprion/analysis/work"</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">zip_file</span> <span class="kw">in</span> <span class="va">zip_files</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">zip_file</span>, exdir<span class="op">=</span><span class="va">work_dir</span><span class="op">)</span></span>
<span><span class="va">ZYQ_UDP</span> <span class="op">&lt;-</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/backendInitialize.html" class="external-link">backendInitialize</a></span><span class="op">(</span><span class="fu">MsBackendRawFileReader</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MsBackendRawFileReader/man/MsBackendRawFileReader.html" class="external-link">MsBackendRawFileReader</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>           files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="va">work_dir</span>,patt<span class="op">=</span><span class="st">"raw"</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ZYQ_UDP</span><span class="op">)</span></span>
<span><span class="va">ZYQ_UDP</span></span>
<span><span class="va">ZYQ_UDP</span> <span class="op">|&gt;</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu">spectraVariables</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">ZYQ_UDP</span>,file<span class="op">=</span><span class="st">"~/Caprion/analysis/work/ZYQ_UDP.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4" number="11.2.3">
<h4 id="usage">
<span class="header-section-number">11.2.3</span> Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<p>Various facilities are shown below.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># various files</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="st">"/rds/project/rds-zuZwCZMsS0w/Caprion_proteomics/analysis/crux"</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>,<span class="st">"szwk901104i19801xms1.mzML"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>,<span class="st">"szwk901104i19801xms1.mzXML"</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>,<span class="st">"szwk901104i19801xms1.mgf"</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>,<span class="st">"szwk901104i19801xms1.rda"</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">d</span>,<span class="st">"szwk901104i19801xms1.mzML.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mzML</span></span>
<span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mzR/man/openMSfile.html" class="external-link">openMSfile</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">header_info</span> <span class="op">&lt;-</span> <span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mzR/man/peaks.html" class="external-link">header</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">header_info</span><span class="op">$</span><span class="va">msLevel</span><span class="op">)</span></span>
<span><span class="va">peak_data</span> <span class="op">&lt;-</span> <span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">peaks</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">spectra</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">spec</span>,<span class="va">head</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"mzRpwiz"</span><span class="op">)</span></span>
<span><span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mzR/man/mzR-class.html" class="external-link">close</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mz</span> <span class="op">&lt;-</span> <span class="fu">mzR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mzR/man/openMSfile.html" class="external-link">openMSfile</a></span><span class="op">(</span><span class="va">z</span>, backend <span class="op">=</span> <span class="st">"pwiz"</span><span class="op">)</span></span>
<span><span class="va">mz</span></span>
<span><span class="fu">nChrom</span><span class="op">(</span><span class="va">mz</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">tic</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">chromatogram</a></span><span class="op">(</span><span class="va">mz</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span> <span class="co">## same as tic(x)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">chromatogram</a></span><span class="op">(</span><span class="va">mz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">peaks</a></span><span class="op">(</span><span class="va">mz</span>, scan<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MSnbase</span></span>
<span><span class="va">mzXML</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMSData.html" class="external-link">readMSData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">mgf</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/readMgfData.html" class="external-link">readMgfData</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">mzXML</span>,<span class="va">mgf</span>,file<span class="op">=</span><span class="va">r</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/extractSpectraData.html" class="external-link">extractSpectraData</a></span><span class="op">(</span><span class="va">mzXML</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/hasSpectraOrChromatograms.html" class="external-link">hasSpectra</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/hasSpectraOrChromatograms.html" class="external-link">hasChromatograms</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plot2d-methods.html" class="external-link">plot2d</a></span><span class="op">(</span><span class="va">mzXML</span>,z<span class="op">=</span><span class="st">"peaks.count"</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/plotDensity-methods.html" class="external-link">plotDensity</a></span><span class="op">(</span><span class="va">mzXML</span>,z<span class="op">=</span><span class="st">"precursor.mz"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/extractSpectraData.html" class="external-link">extractSpectraData</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class<span class="op">=</span><span class="st">"MSpectra"</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">rtime</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">precursorMz</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">precursorCharge</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">precScanNum</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">precursorIntensity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">acquisitionNum</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">scanIndex</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mzR/man/peaks.html" class="external-link">peaksCount</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">msLevel</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">tic</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">ionCount</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">collisionEnergy</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/Spectrum-class.html" class="external-link">fromFile</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">polarity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">smoothed</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">centroided</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">isCentroided</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/writeMgfData-methods.html" class="external-link">writeMgfData</a></span><span class="op">(</span><span class="va">mgf</span>, con <span class="op">=</span> <span class="st">"spectra.mgf"</span>, COM <span class="op">=</span> <span class="cn">NULL</span>, TITLE <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/removePeaks-methods.html" class="external-link">removePeaks</a></span><span class="op">(</span><span class="va">mgf</span>, <span class="va">t</span>, <span class="va">msLevel.</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">filterMsLevel</a></span><span class="op">(</span><span class="va">mgf</span>, msLevel<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu">as.ExpressionSet</span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This turned to be really slow!</span></span>
<span><span class="va">sp_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">intensity_i</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">mz_i</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">centroided_i</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">centroided</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"Spectrum1"</span>, intensity <span class="op">=</span> <span class="va">intensity_i</span>, mz <span class="op">=</span> <span class="va">mz_i</span>, centroided <span class="op">=</span> <span class="va">centroided_i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">sp_list</span><span class="op">)</span></span>
<span><span class="co"># only the first one is more manageable</span></span>
<span><span class="va">sp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"Spectrum1"</span>,intensity<span class="op">=</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,mz<span class="op">=</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,centroided<span class="op">=</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">centroided</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sp2</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pickPeaks-method.html" class="external-link">pickPeaks</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span></span>
<span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">sp2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span>,<span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">sp1</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"h"</span><span class="op">)</span></span>
<span><span class="co">## Without m/z refinement</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sp2</span><span class="op">)</span>, <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">sp2</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span></span>
<span><span class="co">## Using k = 1, closest signals</span></span>
<span><span class="va">sp3</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pickPeaks-method.html" class="external-link">pickPeaks</a></span><span class="op">(</span><span class="va">sp1</span>, refineMz <span class="op">=</span> <span class="st">"kNeighbors"</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sp3</span><span class="op">)</span>, <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">sp3</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span>, type <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span></span>
<span><span class="co">## Using descendPeak requiring at least 50% or the centroid's intensity</span></span>
<span><span class="va">sp4</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/pickPeaks-method.html" class="external-link">pickPeaks</a></span><span class="op">(</span><span class="va">sp1</span>, refineMz <span class="op">=</span> <span class="st">"descendPeak"</span>, signalPercentage <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">sp4</span><span class="op">)</span>, <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">sp4</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, type <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CAMERA</span></span>
<span><span class="va">xs</span>   <span class="op">&lt;-</span> <span class="fu">CAMERA</span><span class="fu">::</span><span class="fu">xcmsSet</span><span class="op">(</span><span class="va">f</span>, method<span class="op">=</span><span class="st">"centWave"</span>, ppm<span class="op">=</span><span class="fl">30</span>, peakwidth<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">an</span>   <span class="op">&lt;-</span> <span class="fu">CAMERA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/xsAnnotate.html" class="external-link">xsAnnotate</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span></span>
<span><span class="va">an</span>   <span class="op">&lt;-</span> <span class="fu">CAMERA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/groupFWHM-methods.html" class="external-link">groupFWHM</a></span><span class="op">(</span><span class="va">an</span><span class="op">)</span></span>
<span><span class="co">#For one group</span></span>
<span><span class="va">peaklist</span> <span class="op">&lt;-</span> <span class="fu">CAMERA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/getpspectra.html" class="external-link">getpspectra</a></span><span class="op">(</span><span class="va">an</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#For two groups</span></span>
<span><span class="va">peaklist</span> <span class="op">&lt;-</span> <span class="fu">CAMERA</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CAMERA/man/getpspectra.html" class="external-link">getpspectra</a></span><span class="op">(</span><span class="va">an</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Spectra</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/Spectra" class="external-link">Spectra</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/Spectra.html" class="external-link">Spectra</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sp</span><span class="op">$</span><span class="va">msLevel</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/plotMzDelta.html" class="external-link">computeMzDeltas</a></span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/plotMzDelta.html" class="external-link">plotMzDelta</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># protViz</span></span>
<span><span class="fu">protViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/protViz/man/fragmentIons.html" class="external-link">fragmentIon</a></span><span class="op">(</span><span class="st">"TFVLNFIK"</span><span class="op">)</span></span>
<span><span class="va">esd</span> <span class="op">&lt;-</span> <span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://lgatto.github.io/MSnbase/reference/extractSpectraData.html" class="external-link">extractSpectraData</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">esd</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">TITLE</span>,rtinseconds<span class="op">=</span><span class="va">RTINSECONDS</span>,pepmass<span class="op">=</span><span class="va">PEPMASS</span>,charge<span class="op">=</span><span class="va">CHARGE</span>,</span>
<span>                                    mZ<span class="op">=</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">mz</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,intensity<span class="op">=</span><span class="fu">MSnbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">intensity</a></span><span class="op">(</span><span class="va">mgf</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">protViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/protViz/man/peakplot.html" class="external-link">peakplot</a></span><span class="op">(</span><span class="st">"TAFDEAIAELDTLNEESYK"</span>, <span class="fu">ms</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">protViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/protViz/man/peakplot.html" class="external-link">peakplot</a></span><span class="op">(</span><span class="st">"TAFDEAIAELDTLSEESYK"</span>, <span class="fu">ms</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"~/Caprion/pilot/ZWK.rda"</span><span class="op">)</span></span>
<span><span class="va">peptides</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">mapping_ZWK</span>,<span class="va">Protein</span><span class="op">==</span><span class="st">"PROC_HUMAN"</span><span class="op">)</span><span class="op">[[</span><span class="st">"Modified.Peptide.Sequence"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pim</span> <span class="op">&lt;-</span> <span class="fu">protViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/protViz/man/parentIonMass.html" class="external-link">parentIonMass</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">)</span></span>
<span><span class="va">fi</span> <span class="op">&lt;-</span> <span class="fu">protViz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/protViz/man/fragmentIons.html" class="external-link">fragmentIon</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fi</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">'m/Z'</span>,</span>
<span>    ylab<span class="op">=</span><span class="st">''</span>,</span>
<span>    xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>,<span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>    type<span class="op">=</span><span class="st">'n'</span>,</span>
<span>    axes<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    sub<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"/"</span>, <span class="va">pim</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"Da"</span><span class="op">)</span><span class="op">)</span>;</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>,<span class="fl">1</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>,<span class="fl">1</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">pepSeq</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">''</span><span class="op">)</span>,las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">3</span>,<span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">''</span><span class="op">)</span>,las<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">peptides</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">pepSeq</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,pos<span class="op">=</span><span class="fl">3</span>,cex<span class="op">=</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"#aaaaaaaa"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">fi</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">y</span>, col<span class="op">=</span><span class="st">'blue'</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MSstats</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SRMRawData</span><span class="op">)</span></span>
<span><span class="va">QuantData</span> <span class="op">&lt;-</span> <span class="fu">MSstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MSstats/man/dataProcess.html" class="external-link">dataProcess</a></span><span class="op">(</span><span class="va">SRMRawData</span>, use_log_file <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">quant</span> <span class="op">&lt;-</span> <span class="fu">MSstats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MSstats/man/dataProcess.html" class="external-link">dataProcess</a></span><span class="op">(</span><span class="va">SRMRawData</span>,</span>
<span>                              normalization <span class="op">=</span> <span class="st">"equalizeMedians"</span>,</span>
<span>                              summaryMethod <span class="op">=</span> <span class="st">"TMP"</span>,</span>
<span>                              censoredInt <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>                              MBimpute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              maxQuantileforCensored <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>                              logTrans<span class="op">=</span><span class="fl">2</span>,</span>
<span>                              use_log_file<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                              numberOfCores<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">quant</span><span class="op">)</span></span></code></pre></div>
<p>MSstats<span class="citation"><sup><a href="#ref-kohler23" role="doc-biblioref">3</a></sup></span> takes output from other data-processing pipelines.</p>
</div>
</div>
</div>
<div class="section level2" number="12">
<h2 id="bionconductor-forum">
<span class="header-section-number">12</span> Bionconductor forum<a class="anchor" aria-label="anchor" href="#bionconductor-forum"></a>
</h2>
<p>Web: <a href="https://support.bioconductor.org/" class="external-link">https://support.bioconductor.org/</a></p>
</div>
<div class="section level2" number="13">
<h2 id="bioconductorcran-packages">
<span class="header-section-number">13</span> Bioconductor/CRAN packages<a class="anchor" aria-label="anchor" href="#bioconductorcran-packages"></a>
</h2>
<table class="table">
<colgroup>
<col width="40%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th>Package</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Bioconductor</strong></td>
<td></td>
</tr>
<tr class="even">
<td>AnnotationDbi</td>
<td>AnnotationDb objects and their progeny, methods etc.</td>
</tr>
<tr class="odd">
<td>Biobase</td>
<td>Base functions for Bioconductor</td>
</tr>
<tr class="even">
<td>Biostrings</td>
<td>Efficient manipulation of biological strings</td>
</tr>
<tr class="odd">
<td>CAMERA</td>
<td>Collection of annotation related methods</td>
</tr>
<tr class="even">
<td>clusterProfiler</td>
<td>Functional profiles for genes and gene clusters</td>
</tr>
<tr class="odd">
<td>ComplexHeatmap</td>
<td>Make complex heatmaps</td>
</tr>
<tr class="even">
<td>DESSeq2</td>
<td>Differential gene expression analysis based on the negative binomial distribution</td>
</tr>
<tr class="odd">
<td>edgeR</td>
<td>Empirical analysis of digital gene expression</td>
</tr>
<tr class="even">
<td>EnsDb.Hsapiens.v86</td>
<td>Exposes an annotation databases generated from Ensembl</td>
</tr>
<tr class="odd">
<td>ensembldb</td>
<td>Retrieve annotation data from an Ensembl based package</td>
</tr>
<tr class="even">
<td>FlowSorted.DLPFC.450k</td>
<td>Illumina HumanMethylation data on sorted frontal cortex cell populations</td>
</tr>
<tr class="odd">
<td>graphite</td>
<td>GRAPH Interaction from pathway topological environment</td>
</tr>
<tr class="even">
<td>IlluminaHumanMethylation450kmanifest</td>
<td>Annotation for Illumina’s 450k methylation arrays</td>
</tr>
<tr class="odd">
<td>INSPEcT</td>
<td>Quantification of the intronic and exonic gene features and the post-transcriptional regulation analysis</td>
</tr>
<tr class="even">
<td>MSnbase</td>
<td>Base Functions and Classes for Mass Spectrometry and Proteomics</td>
</tr>
<tr class="odd">
<td>MSstats</td>
<td>Protein Significance Analysis in DDA, SRM and DIA Proteomics</td>
</tr>
<tr class="even">
<td>mzR</td>
<td>parser for netCDF, mzXML and mzML and mzIdentML files</td>
</tr>
<tr class="odd">
<td>org.Hs.eg.db</td>
<td>Conversion of Entrez ID – gene symbols</td>
</tr>
<tr class="even">
<td>OUTRIDER</td>
<td>OUTlier in RNA-Seq fInDER</td>
</tr>
<tr class="odd">
<td>Pi</td>
<td>Priority index, leveraging genetic evidence to prioritise drug targets at the gene and pathway level</td>
</tr>
<tr class="even">
<td>quantro</td>
<td>A test for when to use quantile normalisation</td>
</tr>
<tr class="odd">
<td>rawrr</td>
<td>Direct Access to Orbitrap Data and Beyond</td>
</tr>
<tr class="even">
<td>recount3</td>
<td>Interface to uniformly processed RNA-seq data</td>
</tr>
<tr class="odd">
<td>Rgraphiz</td>
<td>Interfaces R with the AT&amp;T graphviz library for plotting R graph objects from the graph package</td>
</tr>
<tr class="even">
<td>Spectra</td>
<td>Spectra Infrastructure for Mass Spectrometry</td>
</tr>
<tr class="odd">
<td>sva</td>
<td>Surrogate Variable Analysis</td>
</tr>
<tr class="even">
<td>TxDb.Hsapiens.UCSC.hg38.knownGene</td>
<td>Annotation of the human genome</td>
</tr>
<tr class="odd">
<td><strong>CRAN</strong></td>
<td></td>
</tr>
<tr class="even">
<td>doParallel</td>
<td>Foreach Parallel Adaptor for the ‘parallel’ Package</td>
</tr>
<tr class="odd">
<td>GeneNet</td>
<td>Modeling and Inferring Gene Networks</td>
</tr>
<tr class="even">
<td>ggplot2</td>
<td>Data Visualisations Using the grammar of graphics</td>
</tr>
<tr class="odd">
<td>heatmaply</td>
<td>Interactive Cluster Heat Maps Using <code>plotly</code> and <code>ggplot2</code>
</td>
</tr>
<tr class="even">
<td>pheatmap</td>
<td>results visualisation</td>
</tr>
<tr class="odd">
<td>plyr</td>
<td>Splitting, applying and combining data</td>
</tr>
<tr class="even">
<td>protViz</td>
<td>Foreach Parallel Adaptor for the ‘parallel’ Package</td>
</tr>
<tr class="odd">
<td>RColorBrewer</td>
<td>ColorBrewer Palettes</td>
</tr>
<tr class="even">
<td>WGCNA</td>
<td>Weighted correlation network analysis</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-koster21" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Köster, J., Forster, J., Schmeier, S. &amp; Salazar, V. <span class="nocase">snakemake-workflows/rna-seq-star-deseq2: Version 1.2.0</span>. (2021) doi:<a href="https://doi.org/10.5281/zenodo.5245549" class="external-link">10.5281/zenodo.5245549</a>.</div>
</div>
<div id="ref-carlson16" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Carlson, M. R. J., Pagès, H., Arora, S., Obenchain, V. &amp; Morgan, M. Genomic annotation resources in <span>R/Bioconductor</span>. in <em>Statistical genomics: Methods and protocols</em> (eds. Mathé, E. &amp; Davis, S.) 67–69 (Springer New York, New York, NY, 2016). doi:<a href="https://doi.org/10.1007/978-1-4939-3578-9_4" class="external-link">10.1007/978-1-4939-3578-9_4</a>.</div>
</div>
<div id="ref-kohler23" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Kohler, D. <em>et al.</em> <a href="https://doi.org/10.1021/acs.jproteome.2c00834" class="external-link">MSstats version 4.0: Statistical analyses of quantitative mass spectrometry-based proteomic experiments with chromatography-based quantification at scale</a>. <em>Journal of Proteome Research</em> <strong>22</strong>, 1466–1482 (2023).</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Crafted by <a href="https://jinghuazhao.github.io" class="external-link">Jing Hua Zhao</a>. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>



  <script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";mermaid.initialize({});</script>
</body>
</html>
